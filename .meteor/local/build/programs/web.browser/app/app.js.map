{"version":3,"sources":["meteor://ðŸ’»app/client/partialTemplates/conversationsMenu.js","meteor://ðŸ’»app/client/partialTemplates/editLicenses.js","meteor://ðŸ’»app/client/partialTemplates/editProfile.js","meteor://ðŸ’»app/client/partialTemplates/followAnts.js","meteor://ðŸ’»app/client/partialTemplates/followUsers.js","meteor://ðŸ’»app/client/partialTemplates/mainPage.js","meteor://ðŸ’»app/client/partialTemplates/navBarTemplate.js","meteor://ðŸ’»app/client/partialTemplates/notifications.js","meteor://ðŸ’»app/client/partialTemplates/notificationsNew.js","meteor://ðŸ’»app/client/partialTemplates/removeProfile.js","meteor://ðŸ’»app/client/partialTemplates/sendRequest.js","meteor://ðŸ’»app/client/partialTemplates/showConver.js","meteor://ðŸ’»app/client/partialTemplates/showSocialNetwork.js","meteor://ðŸ’»app/client/partialTemplates/socialNetworkBox.js","meteor://ðŸ’»app/client/partialTemplates/tweetBox.js","meteor://ðŸ’»app/client/partialTemplates/tweetFeed.js","meteor://ðŸ’»app/client/partialTemplates/tweetFeedProfile.js","meteor://ðŸ’»app/client/partialTemplates/twiitCommentPage.js","meteor://ðŸ’»app/client/partialTemplates/twiitPage.js","meteor://ðŸ’»app/client/partialTemplates/twiitPageNew.js","meteor://ðŸ’»app/client/partialTemplates/userManagement.js","meteor://ðŸ’»app/client/partialTemplates/userProfile.js","meteor://ðŸ’»app/client/partialTemplates/videoTrans.js","meteor://ðŸ’»app/client/partialTemplates/whatsAppNotif.js","meteor://ðŸ’»app/client/partialTemplates/whatsAppRequestPage.js","meteor://ðŸ’»app/client/main.js","meteor://ðŸ’»app/lib/collections.js","meteor://ðŸ’»app/lib/router.js","meteor://ðŸ’»app/lib/userUtils.js"],"names":["Template","conversationsMenu","onCreated","Session","set","helpers","widthNav","$","window","width","get","Meteor","call","err","res","console","log","nameChat","usersInChat","split","chatUserName","indexOf","user","username","events","event","currentTarget","id","editLicenses","currentUserName","data","name","currDataUser","arrAux","showWhatsTo","usersFound","Array","i","aux","Object","userNameProfile","userId","push","length","selectUser","target","pos","splice","showWhats","editProfile","subscribe","currentDataUser","userAux","newData","description","document","getElementById","value","attr","_id","codeImg","imgId","location","file","files","reader","FileReader","onload","e","result","readAsDataURL","dataUser","userImg","dataUserFound","userWhats","userFb","userInsta","followAnts","foundFollowers","foundFollowings","mode","countOrientationCard","listFoundFollower","response","imgFoundProf","arrDataProfile","arrRecUsers","followUsers","onRendered","callPromise","recListUsers","searchUser","val","foundUser","append","posUser","listRecomm","remove","imgFound","imgFoundSession","mainPage","pathname","navBarTemplate","navigator","platform","click","resultNotif","UserUtils","findNumberNotif","resultNotifRequest","Notifications","find","recepNotif","read","typeOfNotif","resultNotifResponse","auxTotalCount","count","cont","req","forEach","item","resize","notifications","modeDisplay","size","notificationCount","notificationsNew","numNotif","removeProfile","userToRemove","modal","sendRequest","notif","actorNotif","timestamp","Date","showConver","recoverChat","isMine","dateToConvert","dateNew","dateCon","toLocaleString","elem","chatData","contentMessage","userRecepMsg","lengthMessage","userNameToFindChat","showSocialNetwork","socialNetworkBox","selectOptions","tooltip","numSocialNetworks","avaSelecOptions","selectOptionsArray","hide","btnTap","selectOption","text","arrOptions","numSele","html","btnToRem","propertyToRem","auxOptions","auxCount","show","valuesInput","valuesButton","foundInputNewSN","each","addClass","valu","num","datauserSN","messageMode","contentToAppend","objAux","valueBtn","placeholder","isClient","tweetBox","message","type","twiitId","numComment","findNumComment","tweet","recepUser","findUserFromTwiit","actorUser","charCount","charClass","disableButton","tweetFeed","Twitts","sort","findNumberFavPerTwiit","findOneNotification","createNotifToBrowser","currentUser","idUser","users","findOne","userTapFav","findFavsForTwiit","addFavToTwiit","removeClass","idUserTapFav","removeFavToTwiit","tweetFeedProfile","findTweets","twiitCommentPage","findTwiitFromNotif","twiitIdComment","twiitPage","twiitTimeStamp","notify","update","$set","twiitPageNew","arrWithId","arrWithCommNotif","arrWithFavsNotif","countArrFavs","countArrComm","foundNotifComm","findNotifForTypeNotif","foundNotifFavs","lengthFavs","lengthComm","idBtn","idAux","userManagement","passOk","emailOk","password","profile","fullname","email","pass2","Accounts","createUser","reason","userData","userName","emailUser","userDescription","preventDefault","loginWithPassword","loggingIn","userProfile","logout","idSN","open","userActName","arrWhats","imgUserProfile","css","currentFollowers","btnSocial","color","videoTrans","getMedia","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","URL","webkitURL","mozURL","msURL","video","localMediaStream","querySelector","src","createObjectURL","whatsAppNotif","whatsNotifCount","whatsAppRequestPage","arrWhatsAppReqNotif","countNumReqWhatsAppNotif","arrWhatsAppResNotif","countNumResWhatsAppNotif","dataFound","findWhatsAppNotifications","idWhatsNotif","idNotifRequestWhatsApp","stateResponse","userToShow","idNotifToClear","ReactiveVar","ready","keydown","ctrlKey","which","bind","Collection","Relationships","DataUser","Favs","Mongo","Images","ChatsMsg","Chats","Router","configure","loadingTemplate","notFoundTemplate","route","params","dataUserShowProfile","idTwiit","showData","findFollowings","currentFollowings","follower","fetch","map","following","findFollowers","findNotifications","isOwnTwiit","$or","notifId","twiitNumFav","numFav","resultToUpdate","favObject","idFav","resT","posIdUser","idTweet","typeNotif","Notification","permission","requestPermission","title","bodyNotif","extra","body","noti","onclick","onclose","setTimeout","close"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,SAASC,iBAAT,CAA2BC,SAA3B,CAAqC,YAAW;AAC9CC,UAAQC,GAAR,CAAY,cAAZ,EAA4B,IAA5B;AACD,CAFD;;AAIAJ,SAASC,iBAAT,CAA2BI,OAA3B,CAAmC;AACjC;AAAkB,8BAAU;AAC1B,UAAIC,WAAWC,EAAEC,MAAF,EAAUC,KAAV,EAAf;AACA;AACAH,kBAAY,CAAZ;AACA,aAAOA,WAAS,CAAT,GAAa,IAApB;AACD;;AALD;AAAA,KADiC;;AAQjC;AAAmB,+BAAU;AAC3B,aAAOH,QAAQO,GAAR,CAAY,cAAZ,CAAP;AACD;;AAFD;AAAA,KARiC;;AAYjC;AAAyB,oCAAU;AACjCC,aAAOC,IAAP,CAAY,oBAAZ,EAAkC,UAASC,GAAT,EAAcC,GAAd,EAAkB;AAClDC,gBAAQC,GAAR,CAAYF,GAAZ;AACA,YAAGD,GAAH,EAAO;AACLE,kBAAQC,GAAR,CAAYH,GAAZ;AACD;AACF,OALD;AAOD;;AARD;AAAA,KAZiC;;AAsBjC;AAAa,sBAASI,QAAT,EAAkB;AAC7B,UAAIC,cAAcD,SAASE,KAAT,CAAe,GAAf,CAAlB;AACA,UAAIC,eAAeF,YAAYA,YAAYG,OAAZ,CAAoBV,OAAOW,IAAP,GAAcC,QAAlC,CAAZ,CAAnB;AACA,aAAOH,YAAP;AACD;;AAJD;AAAA;AAtBiC,CAAnC;;AA6BApB,SAASC,iBAAT,CAA2BuB,MAA3B,CAAkC;AAChC;AAA2B,oCAAU;AACnCrB,cAAQC,GAAR,CAAY,cAAZ,EAA4B,KAA5B;AACD;;AAFD;AAAA,KADgC;AAIhC;AAA2B,oCAAU;AACnCD,cAAQC,GAAR,CAAY,cAAZ,EAA4B,IAA5B;AACD;;AAFD;AAAA,KAJgC;AAOhC;AAA4B,mCAASqB,KAAT,EAAe;AACzC;AACAd,aAAOC,IAAP,CAAY,WAAZ,EAAyBa,MAAMC,aAAN,CAAoBC,EAA7C,EAAiD,UAASd,GAAT,EAAcC,GAAd,EAAkB;AACjE,YAAGA,GAAH,EAAO;AACLH,iBAAOC,IAAP,CAAY,YAAZ,EAA0Ba,MAAMC,aAAN,CAAoBC,EAA9C;AACD;AACF,OAJD;AAKD;;AAPD;AAAA;AAPgC,CAAlC,2H;;;;;;;;;;;ACjCA3B,SAAS4B,YAAT,CAAsB1B,SAAtB,CAAgC,YAAU;AACzC2B,oBAAkB,KAAKC,IAAL,CAAUC,IAA5B;AACCC,iBAAe7B,QAAQO,GAAR,CAAY,UAAZ,CAAf;;AAEAuB,WAASD,aAAaE,WAAtB;AACA,MAAIC,aAAa,IAAIC,KAAJ,EAAjB;AACA,OAAI,IAAIC,CAAR,2CAAaJ,MAAb,GAAoB;AAClBtB,WAAOC,IAAP,CAAY,oBAAZ,EAAkCqB,OAAOI,CAAP,CAAlC,EAA6C,UAASxB,GAAT,EAAcC,GAAd,EAAmB;AAC9D,UAAIwB,MAAM,IAAIC,MAAJ,EAAV;AACAD,UAAIP,IAAJ,GAAWjB,IAAI0B,eAAf;AACAF,UAAIG,MAAJ,GAAa3B,IAAI2B,MAAjB;AACAN,iBAAWO,IAAX,CAAgBJ,GAAhB;AACAnC,cAAQC,GAAR,CAAY,YAAZ,EAA0B+B,UAA1B;AACD,KAND;AAOD;;AAED,MAAGF,OAAOU,MAAP,GAAgB,CAAnB,EAAqB;AACnBxC,YAAQC,GAAR,CAAY,iBAAZ,EAA+B,IAA/B;AACD,GAFD,MAEO;AACLD,YAAQC,GAAR,CAAY,iBAAZ,EAA+B,KAA/B;AACD;AACF,CArBD;;AAuBAJ,SAAS4B,YAAT,CAAsBJ,MAAtB,CAA6B;AAC3B;AAAsB,6BAASC,KAAT,EAAe;AACnCmB,mBAAanB,MAAMoB,MAAN,CAAalB,EAA1B;AACD;;AAFD;AAAA,KAD2B;;AAK5B;AAAqB,6BAASF,KAAT,EAAgB;AAClC,UAAIqB,MAAMb,OAAOZ,OAAP,CAAeuB,UAAf,CAAV;AACAX,aAAOc,MAAP,CAAcD,GAAd,EAAkB,CAAlB;;AAEA,UAAIhB,OAAO,IAAIS,MAAJ,EAAX;AACAT,WAAKW,MAAL,GAAcT,aAAaS,MAA3B;AACAX,WAAKkB,SAAL,GAAiBf,MAAjB;;AAEA9B,cAAQC,GAAR,CAAY,YAAZ,EAA0B6B,MAA1B;;AAEA,UAAGA,OAAOU,MAAP,GAAgB,CAAnB,EAAqB;AACnBxC,gBAAQC,GAAR,CAAY,iBAAZ,EAA+B,IAA/B;AACD,OAFD,MAEO;AACLD,gBAAQC,GAAR,CAAY,iBAAZ,EAA+B,KAA/B;AACD;;AAED;AACAO,aAAOC,IAAP,CAAY,mBAAZ,EAAiCkB,IAAjC;AACD;;AAlBF;AAAA;AAL4B,CAA7B;;AA0BA9B,SAAS4B,YAAT,CAAsBvB,OAAtB,CAA8B;AAC5B;AAAkB,8BAAU;AAC1B,aAAOF,QAAQO,GAAR,CAAY,iBAAZ,CAAP;AACD;;AAFD;AAAA,KAD4B;;AAK5B;AAAqB,gCAAU;AAC7B,aAAOP,QAAQO,GAAR,CAAY,YAAZ,CAAP;AACD;;AAFD;AAAA;AAL4B,CAA9B,2H;;;;;;;;;;;ACjDAV,SAASiD,WAAT,CAAqB/C,SAArB,CAA+B,YAAU;AACxCS,SAAOuC,SAAP,CAAiB,QAAjB;AACAvC,SAAOC,IAAP,CAAY,cAAZ,EAA4B,KAAKkB,IAAjC,EAAuC,UAASjB,GAAT,EAAcC,GAAd,EAAmB;AACzDX,YAAQC,GAAR,CAAY,UAAZ,EAAuBU,GAAvB;AACE,GAFH;AAGEqC,oBAAkBhD,QAAQO,GAAR,CAAY,UAAZ,CAAlB;AACF,CAND;;AAQAV,SAASiD,WAAT,CAAqBzB,MAArB,CAA4B;AAC3B;AAAsB,gCAAU;AAC/B4B,gBAAUjD,QAAQO,GAAR,CAAY,UAAZ,CAAV;AACA2C,gBAAU,IAAId,MAAJ,EAAV;AACAc,cAAQC,WAAR,GAAsBC,SAASC,cAAT,CAAwB,iBAAxB,EAA2CC,KAAjE;AACA,UAAGJ,QAAQC,WAAR,KAAwB,EAA3B,EAA8B;AAC7BD,gBAAQC,WAAR,GAAsB/C,EAAE,kBAAF,EAAsBmD,IAAtB,CAA2B,aAA3B,CAAtB;AACA;AACDL,cAAQZ,MAAR,GAAiBW,QAAQO,GAAzB;;AAEA;AACA;AACA,UAAIC,UAAUrD,EAAE,iBAAF,EAAqBmD,IAArB,CAA0B,KAA1B,CAAd;;AAEA/C,aAAOC,IAAP,CAAY,gBAAZ,EAA8BgD,OAA9B,EAAuC,UAAS/C,GAAT,EAAaC,GAAb,EAAiB;AACvDuC,gBAAQQ,KAAR,GAAgB/C,GAAhB;AACAC,gBAAQC,GAAR,CAAYqC,QAAQQ,KAApB;AACAlD,eAAOC,IAAP,CAAY,aAAZ,EAA2ByC,OAA3B;AACA7C,eAAOsD,QAAP,GAAkB,cAAcV,QAAQZ,eAAxC;AACA,OALD;;AAOA;;;;;;;;;;;;;;;;;;;;AAsBE;;AA1CH;AAAA,KAD2B;AA4CzB;AAAqB,+BAAU;;AAE9B;AACA,UAAIuB,OAAOxD,EAAE,YAAF,EAAgB,CAAhB,EAAmByD,KAAnB,CAAyB,CAAzB,CAAX;;AAEAC,eAAS,IAAIC,UAAJ,EAAT;AACAD,aAAOE,MAAP,GAAiB,UAASJ,IAAT,EAAc;AAC9B,eAAO,UAASK,CAAT,EAAW;AACjB7D,YAAE,iBAAF,EAAqBmD,IAArB,CAA0B,KAA1B,EAAiCU,EAAEvB,MAAF,CAASwB,MAA1C;AACA,SAFD;AAGA,OAJe,CAIbN,IAJa,CAAhB;;AAMAE,aAAOK,aAAP,CAAqBP,IAArB;AACA;;AAbD;AAAA;AA5CyB,CAA5B;;AA4DA/D,SAASiD,WAAT,CAAqB5C,OAArB,CAA6B;AAC5B;AAAiB,6BAAU;AAC1BkE,iBAAWpE,QAAQO,GAAR,CAAY,UAAZ,CAAX;AACA,aAAO6D,QAAP;AACA;;AAHD;AAAA,KAD4B;AAK5B;AAAgB,4BAAU;AACzB,UAAGA,SAASC,OAAZ,EAAoB;AACnB7D,eAAOC,IAAP,CAAY,aAAZ,EAA2B2D,SAASC,OAApC,EAA6C,UAAS3D,GAAT,EAAcC,GAAd,EAAmB;AAC/DP,YAAE,iBAAF,EAAqBmD,IAArB,CAA0B,KAA1B,EAAiC5C,GAAjC;AACE,SAFH;AAGA,OAJD,MAIO;AACNC,gBAAQC,GAAR,CAAY,aAAZ;AACAT,UAAE,iBAAF,EAAqBmD,IAArB,CAA0B,KAA1B,EAAiC,qBAAjC;AACA;AACD;;AATD;AAAA,KAL4B;AAe5B;AAAU,oBAASnC,QAAT,EAAkB;AACzBZ,aAAOC,IAAP,CAAY,eAAZ,EAA6BW,QAA7B,EAAuC,UAASV,GAAT,EAAcC,GAAd,EAAmB;AACxDX,gBAAQC,GAAR,CAAY,WAAZ,EAAwBU,GAAxB;AACD,OAFD;AAGA,aAAOX,QAAQO,GAAR,CAAY,WAAZ,CAAP;AACF;;AALD;AAAA,KAf4B;AAqB1B;AAAa,yBAAU;AACxBC,aAAOC,IAAP,CAAY,iBAAZ,EAA+B,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC5CX,gBAAQC,GAAR,CAAY,eAAZ,EAA4BU,GAA5B;AACF,OAFJ;AAGG,aAAOX,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AALD;AAAA,KArB0B;AA2B1B;AAAa,yBAAU;AACrBC,aAAOC,IAAP,CAAY,gBAAZ,EAA8B,UAASC,GAAT,EAAcC,GAAd,EAAmB;AAC9CX,gBAAQC,GAAR,CAAY,cAAZ,EAA2BU,GAA3B;AACF,OAFD;AAGA,aAAOX,QAAQO,GAAR,CAAY,cAAZ,CAAP;AACD;;AALD;AAAA,KA3B0B;AAiC1B;AAAe,wBAAS+D,aAAT,EAAuB;AACpC,UAAIA,cAAcC,SAAf,IAA8BD,cAAcE,MAA5C,IAAwDF,cAAcG,SAAzE,EAAoF;AAClF,eAAO,KAAP;AACD,OAFD,MAEO;AACL,eAAO,IAAP;AACD;AACF;;AAND;AAAA;AAjC0B,CAA7B,2H;;;;;;;;;;;ACpEA5E,SAAS6E,UAAT,CAAoB3E,SAApB,CAA8B,YAAW;AACvCC,UAAQC,GAAR,CAAY,qBAAZ,EAAmC,IAAnC;AACD,CAFD;;AAIAJ,SAAS6E,UAAT,CAAoBxE,OAApB,CAA4B;AAC1B;AAAkB,8BAAU;AAC1B,UAAIC,WAAWC,EAAEC,MAAF,EAAUC,KAAV,EAAf;AACA;AACAH,kBAAY,CAAZ;AACA,aAAOA,WAAS,CAAT,GAAa,IAApB;AACD;;AALD;AAAA,KAD0B;;AAQ1B;AAAoB,iCAAU;AAC5BK,aAAOC,IAAP,CAAY,cAAZ,EAA4B,KAAKU,IAAjC,EAAuC,UAAST,GAAT,EAAcC,GAAd,EAAmB;AACxDX,gBAAQC,GAAR,CAAY,WAAZ,EAAwBU,GAAxB;AACD,OAFD;;AAIAH,aAAOC,IAAP,CAAY,eAAZ,EAA6B,KAAKU,IAAlC,EAAwC,UAAST,GAAT,EAAcC,GAAd,EAAmB;AACzDX,gBAAQC,GAAR,CAAY,YAAZ,EAAyBU,GAAzB;AACD,OAFD;;AAIAgE,uBAAiB3E,QAAQO,GAAR,CAAY,WAAZ,CAAjB;AACAqE,wBAAkB5E,QAAQO,GAAR,CAAY,YAAZ,CAAlB;AACA,UAAGoE,cAAH,EAAkB;AAChB,YAAGA,eAAenC,MAAf,KAA0B,CAA7B,EAA+B;AAC7BxC,kBAAQC,GAAR,CAAY,aAAZ,EAA2B,IAA3B;AACD,SAFD,MAEO;AACLD,kBAAQC,GAAR,CAAY,aAAZ,EAA2B,KAA3B;AACD;AACF;;AAED,UAAG2E,eAAH,EAAmB;AACjB,YAAGA,gBAAgBpC,MAAhB,KAA2B,CAA9B,EAAgC;AAC9BxC,kBAAQC,GAAR,CAAY,cAAZ,EAA4B,IAA5B;AACD,SAFD,MAEO;AACLD,kBAAQC,GAAR,CAAY,cAAZ,EAA4B,KAA5B;AACD;AACF;;AAEDD,cAAQC,GAAR,CAAY,eAAZ,EAA6B,KAAK4E,IAAlC;AACAC,6BAAuB,CAAvB;AACD;;AA7BD;AAAA,KAR0B;;AAuC1B;AAAe,2BAAU;AACvB,aAAO9E,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AAFD;AAAA,KAvC0B;;AA2C1B;AAAe,2BAAU;AACvB,aAAOP,QAAQO,GAAR,CAAY,aAAZ,CAAP;AACD;;AAFD;AAAA,KA3C0B;;AA+C1B;AAAgB,4BAAU;AACxB,aAAOP,QAAQO,GAAR,CAAY,cAAZ,CAAP;AACD;;AAFD;AAAA,KA/C0B;;AAmD1B;AAAoB,gCAAU;AAC5B,aAAOP,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AAFD;AAAA,KAnD0B;;AAuD1B;AAAkB,4BAASa,QAAT,EAAkB;AAClC2D,0BAAoB,EAApB;;AAEAvE,aAAOC,IAAP,CAAY,cAAZ,EAA4BW,QAA5B,EAAsC,UAASV,GAAT,EAAasE,QAAb,EAAsB;AAC1D,YAAGA,QAAH,EAAY;AACVC,yBAAe,EAAf;AACAzE,iBAAOC,IAAP,CAAY,aAAZ,EAA2BuE,SAASX,OAApC,EAA6C,UAAS3D,GAAT,EAAcC,GAAd,EAAkB;AAC7DsE,2BAAetE,GAAf;AACAqE,qBAASC,YAAT,GAAwBA,YAAxB;AACAF,8BAAkBxC,IAAlB,CAAuByC,QAAvB;AACAhF,oBAAQC,GAAR,CAAY,cAAZ,EAA4B8E,iBAA5B;AACD,WALD;AAMD;AACF,OAVD;AAWA,aAAO/E,QAAQO,GAAR,CAAY,cAAZ,CAAP;AACD;;AAfD;AAAA,KAvD0B;;AAwE1B;AAAiB,6BAAU;AACzB,aAAOoE,cAAP;AACD;;AAFD;AAAA,KAxE0B;;AA4E1B;AAAkB,8BAAU;AAC1B,aAAOC,eAAP;AACD;;AAFD;AAAA,KA5E0B;;AAgF1B;AAAmB,+BAAU;AAC3BE;AACA,UAAGA,uBAAuB,CAAvB,KAA6B,CAAhC,EAAkC;AAChC,eAAO,KAAP;AACD,OAFD,MAEO;AACL,eAAO,IAAP;AACD;AACF;;AAPD;AAAA;AAhF0B,CAA5B;;AA0FAjF,SAAS6E,UAAT,CAAoBrD,MAApB,CAA2B;AACzB;AAA6B,sCAAU;AACrCrB,cAAQC,GAAR,CAAY,eAAZ,EAA6B,KAA7B;AACA6E,6BAAuB,CAAvB;AACD;;AAHD;AAAA,KADyB;AAKzB;AAA4B,qCAAU;AACpC9E,cAAQC,GAAR,CAAY,eAAZ,EAA6B,IAA7B;AACA6E,6BAAuB,CAAvB;AACD;;AAHD;AAAA;AALyB,CAA3B,2H;;;;;;;;;;;;AC9FA,IAAII,iBAAiB,EAArB;AACA,IAAIC,cAAc,EAAlB;;AAEAtF,SAASuF,WAAT,CAAqBC,UAArB,CAAgC,YAAY;AACzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iDACuB7E,OAAO8E,WAAP,CAAmB,gBAAnB,CADvB;;AAAA;AACCC,4BADD;;;AAGC,qBAASrD,CAAT,GAAa,CAAb,EAAgBA,IAAIqD,aAAa/C,MAAjC,EAAyCN,GAAzC,EAA8C;AAC5C,sBAAGqD,aAAarD,CAAb,EAAgBd,QAAhB,IAA4BpB,QAAQO,GAAR,CAAY,aAAZ,CAA/B,EAA0D;AACxD4E,gCAAY5C,IAAZ,CAAiBgD,aAAarD,CAAb,CAAjB;AACD;AACF;;AAEQA,iBATV,GASc,CATd;;AAAA;AAAA,sBASiBA,IAAIiD,YAAY3C,MATjC;AAAA;AAAA;AAAA;;AAAA;AAAA,iDAUyBhC,OAAO8E,WAAP,CAAmB,cAAnB,EAAmCH,YAAYjD,CAAZ,EAAed,QAAlD,CAVzB;;AAAA;AAUGkD,6BAVH;;AAWGY,+BAAe3C,IAAf,CAAoB+B,aAApB;;AAXH;AASyCpC,mBATzC;AAAA;AAAA;;AAAA;;AAcC;AACAqD,6BAAa3C,MAAb,CAAoB,CAApB,EAAuB,CAAvB;;AAEA,oBAAI2C,aAAa/C,MAAb,KAAwB,CAA5B,EAA+B;AAC7BxC,0BAAQC,GAAR,CAAY,qBAAZ,EAAmC,KAAnC;AACD,iBAFD,MAEO;AACLD,0BAAQC,GAAR,CAAY,qBAAZ,EAAmC,IAAnC;AACD;;AAEDD,wBAAQC,GAAR,CAAY,kBAAZ,EAAgCsF,YAAhC;AACAvF,wBAAQC,GAAR,CAAY,oBAAZ,EAAkCiF,cAAlC;;AAxBD;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,QAAD;AA0BD,CA3BD;;AA6BArF,SAASuF,WAAT,CAAqB/D,MAArB,CAA4B;AAC1B;AAAoB,4BAASC,KAAT,EAAgB;AAClC,UAAIkE,aAAapF,EAAE,aAAF,EAAiBqF,GAAjB,EAAjB;AACA,UAAIC,YAAYlF,OAAOC,IAAP,CAAY,UAAZ,EAAwB+E,UAAxB,EAAoC,UAAS9E,GAAT,EAAcC,GAAd,EAAmB;AACnE,YAAIA,GAAJ,EAAS;AACPH,iBAAOC,IAAP,CAAY,cAAZ,EAA4BE,IAAIS,QAAhC,EAA0C,UAASV,GAAT,EAAaC,GAAb,EAAiB;AACzD,gBAAGA,GAAH,EAAO;AACLX,sBAAQC,GAAR,CAAY,WAAZ,EAAyBU,GAAzB;AACAH,qBAAOC,IAAP,CAAY,aAAZ,EAA2BE,IAAI0D,OAA/B,EAAwC,UAAS3D,GAAT,EAAcC,GAAd,EAAkB;AACxDX,wBAAQC,GAAR,CAAY,UAAZ,EAAwBU,GAAxB;AACD,eAFD;AAGD;AACF,WAPD;AAQD,SATD,MASO;AACLP,YAAE,WAAF,EAAeuF,MAAf,CAAsB,yCAClB,yCADJ;AAED;AACJ,OAde,CAAhB;AAeA,aAAO,KAAP;AACD;;AAlBD;AAAA,KAD0B;;AAqB1B;AAAiB,2BAAW;AAC1B;AACA;AACAnF,aAAOC,IAAP,CAAY,YAAZ,EAA0BT,QAAQO,GAAR,CAAY,WAAZ,EAAyBa,QAAnD;AACD;;AAJD;AAAA,KArB0B;;AA2B1B;AAAoB,8BAAW;AAC7BwE,gBAAU,CAAC,CAAX;AACAC,mBAAa7F,QAAQO,GAAR,CAAY,kBAAZ,CAAb;;AAEAC,aAAOC,IAAP,CAAY,YAAZ,EAA0B,KAAK4B,eAA/B;AACA;AACA;AACA,UAAGwD,UAAH,EAAc;AACZ,aAAI3D,IAAI,CAAR,EAAWA,IAAI2D,WAAWrD,MAA1B,EAAkCN,GAAlC,EAAsC;AACpC,cAAG2D,WAAW3D,CAAX,EAAcd,QAAd,KAA2B,KAAKiB,eAAnC,EAAmD;AACjDuD,sBAAU1D,CAAV;AACD;AACF;AACF;;AAED,UAAG0D,WAAW,CAAC,CAAf,EAAiB;AACfC,mBAAWjD,MAAX,CAAkBgD,OAAlB,EAA2B,CAA3B;AACD;;AAED,UAAIC,WAAWrD,MAAX,KAAsB,CAA1B,EAA6B;AAC3BxC,gBAAQC,GAAR,CAAY,qBAAZ,EAAmC,KAAnC;AACD,OAFD,MAEO;AACLD,gBAAQC,GAAR,CAAY,qBAAZ,EAAmC,IAAnC;AACD;;AAEDD,cAAQC,GAAR,CAAY,kBAAZ,EAAgC4F,UAAhC;AACA7F,cAAQC,GAAR,CAAY,oBAAZ,EAAkC4F,UAAlC;AACD;;AA3BD;AAAA,KA3B0B;;AAwD1B;AAAsB,gCAAU;AAC9B,UAAGzF,EAAE,aAAF,EAAiBqF,GAAjB,GAAuBjD,MAAvB,KAAkC,CAArC,EAAuC;AACrCxC,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,EAAzB;AACAG,UAAE,cAAF,EAAkB0F,MAAlB;AACD;AACF;;AALD;AAAA;;AAxD0B,CAA5B;;AAiEAjG,SAASuF,WAAT,CAAqBlF,OAArB,CAA6B;AAC3B;AAAa,yBAAW;AACtB,aAAOF,QAAQO,GAAR,CAAY,WAAZ,CAAP;AACD;;AAFD;AAAA,KAD2B;;AAK3B;AAAoB,gCAAW;AAC7B,aAAOP,QAAQO,GAAR,CAAY,oBAAZ,CAAP;AACD;;AAFD;AAAA,KAL2B;;AAS3B;AAAe,2BAAU;AACvB,aAAOP,QAAQO,GAAR,CAAY,qBAAZ,CAAP;AACD;;AAFD;AAAA,KAT2B;AAY3B;AAAa,sBAASY,IAAT,EAAc;AACzB,UAAGA,SAASnB,QAAQO,GAAR,CAAY,aAAZ,CAAZ,EAAuC;AACrC,eAAO,KAAP;AACD,OAFD,MAEO;AACL,eAAO,IAAP;AACD;AACF;;AAND;AAAA,KAZ2B;;AAoB3B;AAAkB,2BAASmD,KAAT,EAAe;AAC/B,UAAIqC,WAAW,SAAf;AACA,UAAIC,kBAAkBhG,QAAQO,GAAR,CAAY,UAAZ,CAAtB;AACA;;AAEA,UAAGmD,UAAU,EAAb,EAAgB;AACd,eAAO,qBAAP;AACD,OAFD,MAEO,IAAGsC,eAAH,EAAmB;AACxB,eAAOA,eAAP;AACD,OAFM,MAEA;AACLxF,eAAOC,IAAP,CAAY,aAAZ,EAA2BiD,KAA3B,EAAkC,UAAShD,GAAT,EAAcC,GAAd,EAAkB;AAClDX,kBAAQC,GAAR,CAAY,UAAZ,EAAwBU,GAAxB;AACD,SAFD;AAGA,eAAOX,QAAQO,GAAR,CAAY,UAAZ,CAAP,CAA+B;AAChC;AACF;;AAfD;AAAA;AApB2B,CAA7B,2H;;;;;;;;;;;ACjGAV,SAASoG,QAAT,CAAkBlG,SAAlB,CAA4B,YAAU;AACrCC,SAAQC,GAAR,CAAY,eAAZ,EAA6BI,OAAOsD,QAAP,CAAgBuC,QAA7C;AACA,CAFD;;AAIArG,SAASoG,QAAT,CAAkB/F,OAAlB,CAA0B;AACzB;AAAY,sBAAU;AACrB,OAAGF,QAAQO,GAAR,CAAY,eAAZ,MAAiC,GAApC,EAAwC;AACvC,WAAO,IAAP;AACA;AACD;;AAJD;AAAA;AADyB,CAA1B,0H;;;;;;;;;;;ACJAV,SAASsG,cAAT,CAAwBpG,SAAxB,CAAmC,YAAW;AAC7CC,SAAQC,GAAR,CAAY,aAAZ,EAA2BG,EAAEC,MAAF,EAAUC,KAAV,EAA3B;AACAN,SAAQC,GAAR,CAAY,gBAAZ,EAA8B,KAA9B;AACAD,SAAQC,GAAR,CAAY,aAAZ,EAA2BO,OAAOW,IAAP,GAAcC,QAAzC;;AAEA;AACAR,SAAQC,GAAR,CAAYuF,UAAUC,QAAtB;;AAEA;;;;;;AAOA,CAfD;;AAiBAxG,SAASsG,cAAT,CAAwB9E,MAAxB,CAA+B;AAC9B;AAA8B,qCAAU;AACvC;AACAjB,KAAE,gBAAF,EAAoBkG,KAApB;AACAtG,WAAQC,GAAR,CAAY,eAAZ,EAA6B,cAA7B;AACA;;AAJD;AAAA,IAD8B;AAM9B;AAAqB,4BAAU;AAC9BD,WAAQC,GAAR,CAAY,gBAAZ,EAA8B,IAA9B;AACA;;AAFD;AAAA,IAN8B;AAS9B;AAAqB,4BAAU;AAC9BD,WAAQC,GAAR,CAAY,gBAAZ,EAA8B,KAA9B;AACA;;AAFD;AAAA,IAT8B;AAY9B;AAAuB,8BAAU;AAC7BD,WAAQC,GAAR,CAAY,aAAZ,EAA2B,KAA3B;AACD;;AAFH;AAAA,IAZ8B;AAe5B;AAAuB,8BAAU;AAC/BD,WAAQC,GAAR,CAAY,aAAZ,EAA2B,KAA3B;AACD;;AAFD;AAAA,IAf4B,EAiB1B;;;;;;;AAOF;AAA2B,mCAAU;AACpCG,KAAE,gBAAF,EAAoBkG,KAApB;AACAtG,WAAQC,GAAR,CAAY,eAAZ,EAA6B,cAAcO,OAAOW,IAAP,GAAcC,QAAzD;AACA;;AAHD;AAAA,IAxB4B;AA4B5B;AAAwB,gCAAU;AACjChB,KAAE,gBAAF,EAAoBkG,KAApB;AACAtG,WAAQC,GAAR,CAAY,eAAZ,EAA6B,oBAAoBO,OAAOW,IAAP,GAAcC,QAA/D;AACA;;AAHD;AAAA;AA5B4B,CAA/B;;AAkCAvB,SAASsG,cAAT,CAAwBjG,OAAxB,CAAgC;AAC/B;AAAqB,+BAAW;AAC5B,OAAIqG,cAAcC,UAAUC,eAAV,CAA0BjG,OAAOW,IAAP,GAAcC,QAAxC,CAAlB;AACA,UAAOmF,WAAP;AACH;;AAHD;AAAA,IAD+B;AAK/B;AAAoB,6BAAU;AAC7B;AACA;AACAG,wBAAqBC,cAAcC,IAAd,CAAmB,EAACC,YAAYrG,OAAOW,IAAP,GAAcC,QAA3B,EAAqC0F,MAAM,KAA3C,EAAkDC,aAAa,eAA/D,EAAnB,CAArB;AACAC,yBAAsBL,cAAcC,IAAd,CAAmB,EAACC,YAAYrG,OAAOW,IAAP,GAAcC,QAA3B,EAAqC0F,MAAM,KAA3C,EAAkDC,aAAa,uBAA/D,EAAnB,CAAtB;AACAE,mBAAgB,CAAhB;;AAEA,OAAGP,mBAAmBQ,KAAnB,KAA6B,CAAhC,EAAkC;AACjCD,oBAAgBP,mBAAmBQ,KAAnB,EAAhB;AACA,QAAGF,oBAAoBE,KAApB,KAA8B,CAAjC,EAAmC;AAClCD,sBAAiBD,oBAAoBE,KAApB,EAAjB;AACA;AACD,IALD,MAKO;AACN,QAAGF,oBAAoBE,KAApB,KAA8B,CAAjC,EAAmC;AAClCD,qBAAgBD,oBAAoBE,KAApB,EAAhB;AACA;AACD;AACD;AACA;AACA;AACA;;AAEA;AACA,OAAGD,gBAAgB,CAAnB,EAAqB;AACpB,WAAOA,aAAP;AACA;AACD;;AA1BD;AAAA,IAL+B;AAgC/B;AAAgB,yBAAU;AACtB,OAAIE,OAAO,CAAX;AACA,OAAIC,MAAM,EAAV;AACA,OAAIzG,MAAM,EAAV;;AAEA+F,sBAAmBW,OAAnB,CAA2B,UAASC,IAAT,EAAc;AACtCF,QAAI7E,IAAJ,CAAS+E,KAAK9D,GAAd;AACA2D;AACF,IAHD;;AAKAH,uBAAoBK,OAApB,CAA4B,UAASC,IAAT,EAAc;AACvC3G,QAAI4B,IAAJ,CAAS+E,KAAK9D,GAAd;AACA2D;AACF,IAHD;;AAKA,OAAGA,OAAO,CAAV,EAAY;AACVnH,YAAQC,GAAR,CAAY,iBAAZ,EAA+B,IAA/B;AACAD,YAAQC,GAAR,CAAY,cAAZ,EAA4BmH,GAA5B;AACApH,YAAQC,GAAR,CAAY,eAAZ,EAA6BU,GAA7B;AACA,WAAO,IAAP;AACD,IALD,MAKO;AACNX,YAAQC,GAAR,CAAY,iBAAZ,EAA+B,KAA/B;AACA,WAAO,KAAP;AACA;AACJ;;AAxBD;AAAA,IAhC+B;AAyD/B;AAA2B,qCAAW;AACpC,UAAOD,QAAQO,GAAR,CAAY,gBAAZ,CAAP;AACD;;AAFD;AAAA,IAzD+B;AA4D/B;AAAgB,0BAAU;AACzBC,UAAOC,IAAP,CAAY,cAAZ,EAA4BD,OAAOW,IAAP,GAAcC,QAA1C,EAAoD,UAASV,GAAT,EAAcC,GAAd,EAAmB;AACtE,QAAGA,IAAI0D,OAAP,EAAe;AACd7D,YAAOC,IAAP,CAAY,aAAZ,EAA2BE,IAAI0D,OAA/B,EAAwC,UAAS3D,GAAT,EAAcC,GAAd,EAAmB;AAC1DP,QAAE,aAAF,EAAiBmD,IAAjB,CAAsB,KAAtB,EAA6B5C,GAA7B;AACE,MAFH;AAGA,KAJD,MAIO;AACNP,OAAE,aAAF,EAAiBmD,IAAjB,CAAsB,KAAtB,EAA6B,qBAA7B;AACA;AAEC,IATH;AAUA;;AAXD;AAAA,IA5D+B;AAwE/B;AAAe,yBAAU;AACxB,OAAIpC,OAAO,IAAIiB,MAAJ,EAAX;AACAjB,QAAKS,IAAL,GAAY5B,QAAQO,GAAR,CAAY,aAAZ,CAAZ;AACA,UAAOY,IAAP;AACA;;AAJD;AAAA;AAxE+B,CAAhC;AA8EA;AACAf,EAAEC,MAAF,EAAUkH,MAAV,CAAiB,YAAU;AAC1B3G,SAAQC,GAAR,CAAY,qBAAZ;AACAb,SAAQC,GAAR,CAAY,aAAZ,EAA2BG,EAAEC,MAAF,EAAUC,KAAV,EAA3B;AACA,CAHD,4H;;;;;;;;;;;AClIAT,SAAS2H,aAAT,CAAuBzH,SAAvB,CAAiC,YAAW;AAC1C;AACA;AACAS,SAAOuC,SAAP,CAAiB,eAAjB,EAAkCvC,OAAOW,IAAP,GAAcC,QAAhD;AACD,CAJD;;AAMAvB,SAAS2H,aAAT,CAAuBtH,OAAvB,CAA+B;AAC7BuH;AAAa,2BAAW;AACtB,UAAIC,OAAO1H,QAAQO,GAAR,CAAY,aAAZ,CAAX;AACA,UAAGmH,OAAO,GAAV,EAAc;AACZ,eAAO,IAAP;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF;;AAPD;AAAA,KAD6B;AAS7BF;AAAe,6BAAW;AACxB,aAAOb,cAAcC,IAAd,CAAmB,EAACC,YAAYrG,OAAOW,IAAP,GAAcC,QAA3B,EAAqC0F,MAAM,KAA3C,EAAnB,CAAP;AACD;;AAFD;AAAA,KAT6B;AAY7Ba;AAAmB,iCAAU;AAC3B;;;;AAIA,aAAOnB,UAAUC,eAAV,CAA0BjG,OAAOW,IAAP,GAAcC,QAAxC,CAAP;AACD;;AAND;AAAA,KAZ6B;AAmB7B;AAA2B,uCAAW;AACpC,aAAOpB,QAAQO,GAAR,CAAY,gBAAZ,CAAP;AACD;;AAFD;AAAA;AAnB6B,CAA/B;;AAwBA;;;;;;;;;;;;;;;;;;;;;;;;;;AC9BAV,SAAS+H,gBAAT,CAA0B7H,SAA1B,CAAoC,YAAW;AAC7C;AACA;AACAS,SAAOuC,SAAP,CAAiB,eAAjB,EAAkCvC,OAAOW,IAAP,GAAcC,QAAhD;AACD,CAJD;;AAMAvB,SAAS+H,gBAAT,CAA0B1H,OAA1B,CAAkC;AAChCuH;AAAa,2BAAW;AACtB,UAAIC,OAAO1H,QAAQO,GAAR,CAAY,aAAZ,CAAX;AACA,UAAGmH,OAAO,GAAV,EAAc;AACZ,eAAO,IAAP;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF;;AAPD;AAAA,KADgC;AAShCF;AAAe,6BAAW;AACxB;AACA5G,cAAQC,GAAR,CAAYL,OAAOW,IAAP,GAAcC,QAA1B;AACA,aAAOuF,cAAcC,IAAd,CAAmB,EAACC,YAAYrG,OAAOW,IAAP,GAAcC,QAA3B,EAAqC0F,MAAM,KAA3C,EAAnB,CAAP;AACD;;AAJD;AAAA,KATgC;AAchCa;AAAmB,iCAAU;AAC3B;;;;AAIAE,iBAAWrB,UAAUC,eAAV,CAA0BjG,OAAOW,IAAP,GAAcC,QAAxC,CAAX;;AAEA,aAAOyG,QAAP;AACD;;AARD;AAAA,KAdgC;AAuBhC;AAA2B,uCAAW;AACpC,aAAO7H,QAAQO,GAAR,CAAY,gBAAZ,CAAP;AACD;;AAFD;AAAA,KAvBgC;AA0BhC;AAAe,2BAAU;AACvB,aAAOC,OAAOW,IAAP,GAAcC,QAArB;AACD;;AAFD;AAAA;AA1BgC,CAAlC;;AA+BAvB,SAAS+H,gBAAT,CAA0BvG,MAA1B,CAAiC;;AAE/B;AAAuB,gCAAU;AAC/B,UAAGwG,WAAW,CAAd,EAAgB;;AAEdxH,eAAOsD,QAAP,GAAkB,oBAAoBnD,OAAOW,IAAP,GAAcC,QAApD;AACD;AACF;;AALD;AAAA;;AAF+B,CAAjC,2H;;;;;;;;;;;ACrCAvB,SAASiI,aAAT,CAAuBzG,MAAvB,CAA8B;AAC7B;AAAiB,+BAAW;AACzB,gBAAI0G,eAAe,IAAI3F,MAAJ,EAAnB;AACA,gBAAID,MAAMnC,QAAQO,GAAR,CAAY,UAAZ,CAAV;;AAEAwH,yBAAavG,EAAb,GAAkBW,IAAIG,MAAtB;AACAyF,yBAAanG,IAAb,GAAoBO,IAAIE,eAAxB;;AAEAzB,oBAAQC,GAAR,CAAYkH,YAAZ;;AAEAvH,mBAAOC,IAAP,CAAY,gBAAZ,EAA8BsH,YAA9B;;AAEA1H,mBAAOsD,QAAP,GAAkB,GAAlB;AACF;;AAZD;AAAA,OAD6B;AAc5B;AAAmB,iCAAU;AAC3B;AACAvD,cAAE,uBAAF,EAA2B4H,KAA3B,CAAiC,MAAjC;AACD;;AAHD;AAAA;AAd4B,CAA9B,0H;;;;;;;;;;;ACAAnI,SAASoI,WAAT,CAAqB5C,UAArB,CAAgC,YAAU,CAEzC,CAFD;;AAIAxF,SAASoI,WAAT,CAAqB5G,MAArB,CAA4B;AACzB;AAAe,yBAAU;;AAExB,UAAI6G,QAAQ,IAAI9F,MAAJ,EAAZ;;AAEA8F,YAAMrB,UAAN,GAAmB7G,QAAQO,GAAR,CAAY,eAAZ,CAAnB,CAJwB,CAIyB;AACjD2H,YAAMC,UAAN,GAAmB3H,OAAOW,IAAP,GAAcC,QAAjC,CALwB,CAKmB;AAC3C8G,YAAME,SAAN,GAAkB,IAAIC,IAAJ,EAAlB;AACAH,YAAMnB,WAAN,GAAoB,eAApB;;AAEAvG,aAAOC,IAAP,CAAY,4BAAZ,EAA0CyH,KAA1C;AACA9H,QAAE,2BAAF,EAA+B4H,KAA/B,CAAqC,MAArC;AACA;;AAEA5H,QAAE,0BAAF,EAA8B4H,KAA9B,CAAoC,MAApC;AACA;;AAdD;AAAA,KADyB;AAgBzB;AAAiB,2BAAU;AAC1B5H,QAAE,2BAAF,EAA+B4H,KAA/B,CAAqC,MAArC;AACA;;AAFD;AAAA;AAhByB,CAA5B;;AAqBAnI,SAASoI,WAAT,CAAqB/H,OAArB,CAA6B;AAC1B;AAAqB,iCAAU;AAC7B,aAAOF,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AAFD;AAAA;AAD0B,CAA7B,2H;;;;;;;;;;;ACzBAV,SAASyI,UAAT,CAAoBvI,SAApB,CAA8B,YAAW;AACvCS,SAAOuC,SAAP,CAAiB,OAAjB;AACA/C,UAAQC,GAAR,CAAY,mBAAZ,EAAiC,IAAjC;AACAD,UAAQC,GAAR,CAAY,mBAAZ,EAAiC,KAAK0B,IAAL,CAAUC,IAA3C;AACD,CAJD;;AAMA/B,SAASyI,UAAT,CAAoBpI,OAApB,CAA4B;AAC1B;AAAmB,8BAAU;AAC3BqI;AACA,aAAOvI,QAAQO,GAAR,CAAY,WAAZ,CAAP;AACD;;AAHD;AAAA,KAD0B;;AAM1B;AAAgB,2BAAW;AACzB,aAAOP,QAAQO,GAAR,CAAY,mBAAZ,CAAP;AACD;;AAFD;AAAA,KAN0B;;AAU1B;AAAkB,6BAAU;AAC1B,UAAIY,OAAO,IAAIiB,MAAJ,EAAX;AACAjB,WAAKS,IAAL,GAAY5B,QAAQO,GAAR,CAAY,mBAAZ,CAAZ;AACA,aAAOY,IAAP;AACD;;AAJD;AAAA,KAV0B;;AAgB1B;AAAkB,2BAASqH,MAAT,EAAgB;AAChC,UAAGA,WAAWxI,QAAQO,GAAR,CAAY,aAAZ,CAAd,EAAyC;AACvC,eAAO,eAAP;AACD,OAFD,MAEO;AACL,eAAO,gBAAP;AACD;AACF;;AAND;AAAA,KAhB0B;;AAwB1B;AAAmB,6BAASkI,aAAT,EAAwB;AACzC,UAAIC,UAAU,IAAIL,IAAJ,CAASI,aAAT,CAAd;AACA,UAAIE,UAAUD,QAAQE,cAAR,EAAd;;AAEA,UAAIC,OAAOF,QAAQ3H,KAAR,CAAc,GAAd,CAAX;;AAEA,aAAO6H,KAAK,CAAL,CAAP;AACD;;AAPD;AAAA;AAxB0B,CAA5B;;AAkCAhJ,SAASyI,UAAT,CAAoBjH,MAApB,CAA2B;AACzB;AAA0B,mCAAU;AAClC,UAAIyH,WAAW,IAAI1G,MAAJ,EAAf;AACA,UAAI2G,iBAAiB3I,EAAE,eAAF,EAAmBqF,GAAnB,EAArB;AACA,UAAIuD,eAAehJ,QAAQO,GAAR,CAAY,mBAAZ,CAAnB;;AAEAuI,eAASC,cAAT,GAA0BA,cAA1B;AACAD,eAASE,YAAT,GAAwBA,YAAxB;AACA,UAAGhJ,QAAQO,GAAR,CAAY,WAAZ,CAAH,EAA4B;AAC1BC,eAAOC,IAAP,CAAY,eAAZ,EAA6BqI,QAA7B;AACD,OAFD,MAEO;AACLA,iBAAShI,QAAT,GAAoBd,QAAQO,GAAR,CAAY,UAAZ,CAApB;AACAC,eAAOC,IAAP,CAAY,WAAZ,EAAyBqI,QAAzB;AACD;AACD;AACA;;AAEA;AACAP;AACA;AACAnI,QAAE,eAAF,EAAmBqF,GAAnB,CAAuB,EAAvB;AACD;;AApBD;AAAA,KADyB;;AAuBzB;AAAwB,iCAAU;AAChC,UAAIwD,gBAAgB7I,EAAE,eAAF,EAAmBqF,GAAnB,GAAyBjD,MAA7C;AACA,UAAGyG,gBAAgB,CAAnB,EAAqB;AACnBjJ,gBAAQC,GAAR,CAAY,mBAAZ,EAAiC,KAAjC;AACD,OAFD,MAEO,IAAGgJ,kBAAkB,CAArB,EAAuB;AAC5BjJ,gBAAQC,GAAR,CAAY,mBAAZ,EAAiC,IAAjC;AACD;AACF;;AAPD;AAAA,KAvByB;;AAgCzB;AAAwB,iCAAU;AAChCO,aAAOC,IAAP,CAAY,YAAZ,EAA0BT,QAAQO,GAAR,CAAY,mBAAZ,CAA1B;AACD;;AAFD;AAAA;AAhCyB,CAA3B;;AAqCA,SAASgI,WAAT,GAAsB;AACpB,MAAIW,qBAAqBlJ,QAAQO,GAAR,CAAY,mBAAZ,CAAzB;;AAEAC,SAAOC,IAAP,CAAY,kBAAZ,EAAgCyI,kBAAhC,EAAoD,UAASxI,GAAT,EAAcC,GAAd,EAAkB;AACpE,QAAGA,GAAH,EAAO;AACLX,cAAQC,GAAR,CAAY,WAAZ,EAAyBU,GAAzB;AACA,UAAGA,IAAI6B,MAAJ,KAAe,CAAlB,EAAoB;AAClBxC,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,IAAzB;AACD,OAFD,MAEO;AACLD,gBAAQC,GAAR,CAAY,UAAZ,EAAwBU,IAAI,CAAJ,EAAOG,QAA/B;AACAd,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,KAAzB;AACD;AACF;;AAED,QAAGS,GAAH,EAAO;AACLE,cAAQC,GAAR,CAAYH,GAAZ;AACD;AACF,GAdD;AAeD,4H;;;;;;;;;;;AC/FDb,SAASsJ,iBAAT,CAA2B9D,UAA3B,CAAsC,YAAU,CAE/C,CAFD;;AAIAxF,SAASsJ,iBAAT,CAA2B9H,MAA3B,CAAkC;AAC/B;AAAe,yBAAU,CAExB;;AAFD;AAAA,KAD+B;AAI/B;AAAiB,2BAAU,CAE1B;;AAFD;AAAA;AAJ+B,CAAlC;;AASAxB,SAASsJ,iBAAT,CAA2BjJ,OAA3B,CAAmC;AAChC;AAAqB,iCAAU;AAC7B,aAAOF,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AAFD;AAAA,KADgC;AAIhC;AAAyB,oCAAU;AACpC,aAAOP,QAAQO,GAAR,CAAY,sBAAZ,CAAP;AACA;;AAFC;AAAA;AAJgC,CAAnC;;AAUA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,4H;;;;;;;;;;;AC/BAV,SAASuJ,gBAAT,CAA0B/D,UAA1B,CAAqC,YAAU;AAC7CgE,kBAAgBrJ,QAAQO,GAAR,CAAY,YAAZ,CAAhB;AACAyC,oBAAkBhD,QAAQO,GAAR,CAAY,UAAZ,CAAlB;AACAP,UAAQC,GAAR,CAAY,eAAZ,EAA6B,IAA7B;AACAD,UAAQC,GAAR,CAAY,cAAZ,EAA4B,KAA5B;AACAG,IAAE,yBAAF,EAA6BkJ,OAA7B;AACD,CAND;;AAQAzJ,SAASuJ,gBAAT,CAA0B/H,MAA1B,CAAiC;AAC9B;AAAmB,6BAAU;AAC5B,UAAIkI,oBAAoBvJ,QAAQO,GAAR,CAAY,qBAAZ,CAAxB;;AAEA,UAAGgJ,oBAAoB,CAAvB,EAAyB;;AAErB,YAAIC,kBAAkB,EAAtB;AACA,YAAIC,qBAAqBzJ,QAAQO,GAAR,CAAY,YAAZ,CAAzB;;AAEA,aAAK,IAAI2B,IAAI,CAAb,EAAgBA,IAAIuH,mBAAmBjH,MAAvC,EAA+CN,GAA/C,EAAoD;AAClDsH,6BAAmB,qBAAqBC,mBAAmBvH,CAAnB,CAArB,GAA6C,WAAhE;AACD;;AAEJ9B,UAAE,kBAAF,EAAsBuF,MAAtB,CAA6B,4CAA4C4D,iBAA5C,GAAgE,iCAAhE,GAC1B,+BAD0B,GAE1B,cAF0B,GAETA,iBAFS,GAEW,2JAFX,GAG1B,6BAH0B,GAI1B,WAJ0B,GAK1B,sBAL0B,GAKDA,iBALC,GAKmB,0BALnB,GAM1BC,eAN0B,GAO1B,OAP0B,GAQ1B,QAR0B,GAS1B,2BAT0B,GASID,iBATJ,GASwB,mGATxB,GAU1B,2BAV0B,GAUIA,iBAVJ,GAUwB,oFAVxB,GAWtB,YAXsB,GAWPA,iBAXO,GAWa,8CAXb,GAYtB,WAZsB,GAatB,QAbP;AAcCA;AACEvJ,gBAAQC,GAAR,CAAY,qBAAZ,EAAmCsJ,iBAAnC;AACD;;AAED,UAAGA,sBAAsB,CAAzB,EAA2B;AACzBnJ,UAAE,WAAF,EAAesJ,IAAf;AACA1J,gBAAQC,GAAR,CAAY,cAAZ,EAA4B,KAA5B;AACD;AACH;;AAlCD;AAAA,KAD8B;AAoC9B;AAAsB,8BAASqB,KAAT,EAAe;AACpCtB,cAAQC,GAAR,CAAY,QAAZ,EAAsBqB,MAAMoB,MAAN,CAAalB,EAAnC;AACA;;AAFD;AAAA,KApC8B;AAuC9B;AAA6B,kCAASF,KAAT,EAAe;AAC3C,UAAIqI,SAAS3J,QAAQO,GAAR,CAAY,QAAZ,CAAb;AACA,UAAIqJ,eAAetI,MAAMoB,MAAN,CAAamH,IAAhC;AACE;AACA;AACA;AACA,UAAIC,aAAa9J,QAAQO,GAAR,CAAY,YAAZ,CAAjB;;AAEA,UAAIwJ,UAAUD,WAAW5I,OAAX,CAAmB0I,YAAnB,CAAd;AACA,UAAGG,WAAW,CAAd,EAAgB;AACdD,mBAAWlH,MAAX,CAAkBmH,OAAlB,EAA2B,CAA3B;AACD;;AAED;AACA;AACA,UAAGH,iBAAiB,UAApB,EAA+B;AAC7BxJ,UAAE,WAAWuJ,MAAb,EAAqBpG,IAArB,CAA0B,MAA1B,EAAkC,QAAlC;AACD;;AAED;AACAnD,QAAE,MAAKuJ,MAAP,EAAeK,IAAf,CAAoBJ,YAApB;;AAEAxJ,QAAE,kBAAiBuJ,MAAnB,EAA2B7D,MAA3B;;AAEA9F,cAAQC,GAAR,CAAY,YAAZ,EAA0B6J,UAA1B;AACF;;AAzBD;AAAA,KAvC8B;AAiE7B;AAAqB,4BAASxI,KAAT,EAAe;;AAElC;AACA,UAAIsI,eAAetI,MAAMoB,MAAN,CAAalB,EAAhC;AACA;AACA,UAAIyI,WAAW7J,EAAE,MAAMwJ,YAAR,EAAsBC,IAAtB,EAAf;AACA,UAAI3G,UAAU,IAAId,MAAJ,EAAd;;AAEA,UAAG6H,YAAY,QAAf,EAAwB;AACtB/G,gBAAQZ,MAAR,GAAiBtC,QAAQO,GAAR,CAAY,UAAZ,EAAwBiD,GAAzC;AACAN,gBAAQgH,aAAR,GAAwBD,QAAxB;;AAEAzJ,eAAOC,IAAP,CAAY,0BAAZ,EAAwCyC,OAAxC;AACD;;AAED;AACA;AACA9C,QAAE,gBAAgBwJ,YAAlB,EAAgC9D,MAAhC;AACA9F,cAAQC,GAAR,CAAY,cAAZ,EAA4B,IAA5B;;AAEA;AACA,UAAIkK,aAAanK,QAAQO,GAAR,CAAY,YAAZ,CAAjB;;AAEA,UAAG0J,YAAY,QAAf,EAAwB;AACtB,YAAGE,WAAWjJ,OAAX,CAAmBgC,QAAQgH,aAA3B,MAA8C,CAAC,CAAlD,EAAoD;AAClDC,qBAAW5H,IAAX,CAAgBW,QAAQgH,aAAxB;AACAlK,kBAAQC,GAAR,CAAY,YAAZ,EAA0BkK,UAA1B;AACD;AACF;;AAED;AACA,UAAIC,WAAWpK,QAAQO,GAAR,CAAY,qBAAZ,CAAf;AACA6J;AACApK,cAAQC,GAAR,CAAY,qBAAZ,EAAmCmK,QAAnC;;AAEA;;AAEA,WAAK,IAAIlI,IAAI,CAAb,EAAgBA,IAAIkI,QAApB,EAA8BlI,GAA9B,EAAmC;AACjC9B,UAAE,cAAF,EAAkBmD,IAAlB,CAAuB,IAAvB,EAA6B,eAAerB,CAA5C;;AAEA9B,UAAE,eAAF,EAAmBmD,IAAnB,CAAwB,IAAxB,EAA8BrB,CAA9B;;AAEA9B,UAAE,gBAAF,EAAoBmD,IAApB,CAAyB,IAAzB,EAA+B,iBAAiBrB,CAAhD;;AAEA9B,UAAE,UAAF,EAAcmD,IAAd,CAAmB,IAAnB,EAAyB,UAAUrB,CAAnC;;AAEA9B,UAAE,mBAAF,EAAuBmD,IAAvB,CAA4B,IAA5B,EAAkCrB,CAAlC;;AAEA9B,UAAE,aAAF,EAAiBmD,IAAjB,CAAsB,IAAtB,EAA4B,kBAAmBrB,CAA/C;AACD;;AAED,UAAGkI,WAAW,CAAd,EAAgB;AACdpK,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,IAAzB;AACAG,UAAE,WAAF,EAAeiK,IAAf;AACD;AACF;;AAvDD;AAAA,KAjE6B;AAyH9B;AAAmB,6BAAU;AAC5B;AACA;AACA;AACE,UAAIC,cAAc,EAAlB;AACF,UAAIC,eAAe,EAAnB;AACE,UAAIC,kBAAkB,KAAtB;;AAEA;AACA;AACA,UAAGxK,QAAQO,GAAR,CAAY,WAAZ,MAA6B,IAAhC,EAAqC;AACnC;AACA;;AAEA;AACAH,UAAE,UAAF,EAAcqK,IAAd,CAAmB,YAAW;AAC5B,cAAGrK,EAAE,IAAF,EAAQqF,GAAR,MAAiB,EAApB,EAAuB;AACrB6E,wBAAY/H,IAAZ,CAAiBnC,EAAE,IAAF,EAAQqF,GAAR,EAAjB;AACD;AACF,SAJD;;AAOA;AACArF,UAAE,aAAF,EAAiBqK,IAAjB,CAAsB,YAAU;AAC9B,cAAGrK,EAAE,IAAF,EAAQqF,GAAR,MAAiB,EAApB,EAAuB;AACrB6E,wBAAY/H,IAAZ,CAAiBnC,EAAE,IAAF,EAAQqF,GAAR,EAAjB;AACAzF,oBAAQC,GAAR,CAAY,eAAZ,EAA6B,IAA7B;AACD,WAHD,MAGO;AACLD,oBAAQC,GAAR,CAAY,eAAZ,EAA6B,KAA7B;AACD;AACDuK,4BAAkB,IAAlB;AACD,SARD;;AAWA,YAAGF,YAAY9H,MAAZ,KAAuB,CAA1B,EAA4B;AAC1B;AACA;AACApC,YAAE,UAAF,EAAcqK,IAAd,CAAmB,YAAW;AAC5B,gBAAGrK,EAAE,IAAF,EAAQqF,GAAR,OAAkB,EAArB,EAAwB;AACtB7E,sBAAQC,GAAR,CAAY,YAAZ;AACAT,gBAAE,IAAF,EAAQsK,QAAR,CAAiB,YAAjB;AACAtK,gBAAE,gBAAF,EAAoBmD,IAApB,CAAyB,QAAzB,EAAmC,KAAnC;AACD;AACF,WAND;AAOD;;AAED,YAAGiH,eAAH,EAAmB;AACjBF,sBAAY1H,MAAZ,CAAmB0H,YAAY9H,MAAZ,GAAqB,CAAxC,EAA2C,CAA3C;AACAgI,4BAAkB,KAAlB;AACD;AAEF,OAzCD,MAyCO;AACL;AACA;AACApK,UAAE,UAAF,EAAcqK,IAAd,CAAmB,YAAW;AAC5B,cAAGrK,EAAE,IAAF,EAAQqF,GAAR,OAAkB,EAArB,EAAwB;AACtB6E,wBAAY/H,IAAZ,CAAiBnC,EAAE,IAAF,EAAQmD,IAAR,CAAa,aAAb,CAAjB;AACD,WAFD,MAEO;AACL+G,wBAAY/H,IAAZ,CAAiBnC,EAAE,IAAF,EAAQqF,GAAR,EAAjB;AACD;AACF,SAND;;AAQAzF,gBAAQC,GAAR,CAAY,eAAZ,EAA6B,IAA7B;AACD;;AAED;AACAG,QAAE,eAAF,EAAmBqK,IAAnB,CAAwB,YAAW;AACjCF,qBAAahI,IAAb,CAAkBnC,EAAE,IAAF,EAAQyJ,IAAR,EAAlB;AACD,OAFD;;AAIA,UAAG7J,QAAQO,GAAR,CAAY,eAAZ,CAAH,EAAgC;AAC9B;AACA,YAAG+J,eAAeC,YAAlB,EAA+B;AAC7B;AACA;AACA,cAAIrH,UAAU,IAAId,MAAJ,EAAd;AACAc,kBAAQZ,MAAR,GAAiBtC,QAAQO,GAAR,CAAY,UAAZ,EAAwBiD,GAAzC;;AAEA,eAAMtB,IAAI,CAAV,EAAaA,IAAIqI,aAAa/H,MAA9B,EAAsCN,GAAtC,EAA2C;AACzC,gBAAIyI,OAAOJ,aAAarI,CAAb,CAAX;AACA,gBAAI0I,MAAML,aAAarJ,OAAb,CAAqByJ,IAArB,CAAV;;AAEA,gBAAGC,OAAO,CAAV,EAAY;AACV,kBAAG,eAAeD,IAAlB,EAAwB;AACtBzH,wBAAQqB,SAAR,GAAoB+F,YAAYM,GAAZ,CAApB;AACD,eAFD,MAEO,IAAG,eAAeD,IAAlB,EAAuB;AAC5BzH,wBAAQsB,MAAR,GAAiB8F,YAAYM,GAAZ,CAAjB;AACD,eAFM,MAEA,IAAG,gBAAgBD,IAAnB,EAAyB;AAC9BzH,wBAAQuB,SAAR,GAAoB6F,YAAYM,GAAZ,CAApB;AACD;AACF;AACF;AACD;AACApK,iBAAOC,IAAP,CAAY,2BAAZ,EAAyCyC,OAAzC;AACD;;AAGD;AACA9C,UAAE,0BAAF,EAA8B4H,KAA9B,CAAoC,MAApC;AACD;;AAED;AACA;AACA,UAAGhI,QAAQO,GAAR,CAAY,cAAZ,CAAH,EAA+B;AAC7BP,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,KAAzB;AACAD,gBAAQC,GAAR,CAAY,cAAZ,EAA4B,KAA5B;AACD;AACH;;AA3GD;AAAA;AAzH8B,CAAjC;;AAuOAJ,SAASuJ,gBAAT,CAA0BlJ,OAA1B,CAAkC;AAChC;AAAgB,4BAAU;AACxB,UAAIgE,SAAS,IAAI9B,MAAJ,EAAb;;AAEA,UAAIY,kBAAkBhD,QAAQO,GAAR,CAAY,UAAZ,CAAtB;;AAEA,UAAI8I,gBAAgB,CAAC,UAAD,EAAa,WAAb,EAA0B,UAA1B,CAApB;AACA,UAAIE,oBAAoB,CAAxB;;AAEA,UAAIsB,aAAa,EAAjB;;AAEA,UAAG7H,gBAAgBuB,SAAnB,EAA6B;AAC3B,YAAIwF,UAAUV,cAAcnI,OAAd,CAAsB,UAAtB,CAAd;AACAmI,sBAAczG,MAAd,CAAqBmH,OAArB,EAA8B,CAA9B;AACAR,6BAAqB,CAArB;AACAsB,mBAAWtI,IAAX,CAAgBS,gBAAgBuB,SAAhC;AACD;;AAED,UAAGvB,gBAAgBwB,MAAnB,EAA0B;AACxB,YAAIuF,UAAUV,cAAcnI,OAAd,CAAsB,UAAtB,CAAd;AACAmI,sBAAczG,MAAd,CAAqBmH,OAArB,EAA8B,CAA9B;AACAR,6BAAqB,CAArB;AACAsB,mBAAWtI,IAAX,CAAgBS,gBAAgBwB,MAAhC;AACD;;AAED,UAAGxB,gBAAgByB,SAAnB,EAA6B;AAC3B,YAAIsF,UAAUV,cAAcnI,OAAd,CAAsB,WAAtB,CAAd;AACAmI,sBAAczG,MAAd,CAAqBmH,OAArB,EAA8B,CAA9B;AACAR,6BAAqB,CAArB;AACAsB,mBAAWtI,IAAX,CAAgBS,gBAAgByB,SAAhC;AACD;;AAEDzE,cAAQC,GAAR,CAAY,eAAZ,EAA6B4K,UAA7B;;AAEA7K,cAAQC,GAAR,CAAY,qBAAZ,EAAmCsJ,iBAAnC;;AAEAvJ,cAAQC,GAAR,CAAY,YAAZ,EAA0BoJ,aAA1B;;AAGA,UAAGA,cAAc7G,MAAd,GAAuB,CAAvB,IAA4B6G,cAAc7G,MAAd,IAAwB,CAAvD,EAAyD;AACvD0B,eAAO4G,WAAP,GAAqB,oCAArB;AACA9K,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,IAAzB;AACD,OAHD,MAGO,IAAGoJ,cAAc7G,MAAd,KAAyB,CAA5B,EAA8B;AACnC;AACA,YAAIL,MAAM,CAAC,UAAD,EAAa,UAAb,EAAyB,WAAzB,CAAV;AACA,YAAI4I,kBAAkB,EAAtB;AACA,aAAK,IAAI7I,IAAI,CAAb,EAAgBA,IAAIqH,iBAApB,EAAuCrH,GAAvC,EAA4C;AAC1C,cAAI8I,SAAS,IAAI5I,MAAJ,EAAb;AACA4I,iBAAOxJ,EAAP,GAAYU,CAAZ;AACA8I,iBAAOC,QAAP,GAAkB9I,IAAID,CAAJ,CAAlB;AACA8I,iBAAOE,WAAP,GAAqBL,WAAW3I,CAAX,CAArB;;AAEA6I,0BAAgBxI,IAAhB,CAAqByI,MAArB;AACD;AACD9G,eAAO4G,WAAP,GAAqB,qBAArB;AACA9K,gBAAQC,GAAR,CAAY,YAAZ,EAA0B8K,eAA1B;AACA/K,gBAAQC,GAAR,CAAY,WAAZ,EAAyB,KAAzB;AACD;;AAED,aAAOiE,MAAP;AACD;;AA3DD;AAAA,KADgC;;AA8DhC;AAAmB,+BAAU;AAC3B,aAAOlE,QAAQO,GAAR,CAAY,YAAZ,CAAP;AACD;;AAFD;AAAA,KA9DgC;;AAkEjC;AAAe,0BAAU;AACtB,UAAGP,QAAQO,GAAR,CAAY,YAAZ,EAA0BiC,MAA1B,GAAmC,CAAtC,EAAwC;AACtC,eAAO,IAAP;AACD,OAFD,MAEO,IAAGxC,QAAQO,GAAR,CAAY,WAAZ,CAAH,EAA4B;AACjC,eAAO,IAAP;AACD,OAFM,MAEA;AACL,eAAO,KAAP;AACD;AACF;;AARF;AAAA;AAlEiC,CAAlC,4H;;;;;;;;;;;AC/OA;AACA,IAAGC,OAAO2K,QAAV,EAAmB;;AAElBtL,UAASuL,QAAT,CAAkB/F,UAAlB,CAA6B,YAAU;AACrCrF,UAAQC,GAAR,CAAY,UAAZ,EAAwB,CAAxB;AACD,EAFD;;AAIAJ,UAASuL,QAAT,CAAkB/J,MAAlB,CAAyB;AACtB;AAAmB,6BAAU;AAC3BrB,YAAQC,GAAR,CAAY,UAAZ,EAAwBG,EAAE,YAAF,EAAgBqF,GAAhB,GAAsBjD,MAA9C;AACD;;AAFD;AAAA,KADsB;AAItB;AAAgB,0BAAW;AAC5B,QAAI6I,UAAUjL,EAAE,YAAF,EAAgBqF,GAAhB,EAAd;AACA,QAAI6F,OAAOtL,QAAQO,GAAR,CAAY,aAAZ,CAAX;;AAEA,QAAG+K,IAAH,EAAQ;AACP,SAAIC,UAAUvL,QAAQO,GAAR,CAAY,gBAAZ,CAAd;AACA,SAAIiL,aAAahF,UAAUiF,cAAV,CAAyBF,OAAzB,CAAjB;AACAC;AACA;;AAEDpL,MAAE,YAAF,EAAgBqF,GAAhB,CAAoB,EAApB;AACAzF,YAAQC,GAAR,CAAY,UAAZ,EAAwB,CAAxB;;AAEA,QAAIyL,QAAQ,IAAItJ,MAAJ,EAAZ;AACAsJ,UAAML,OAAN,GAAgBA,OAAhB;AACAK,UAAMJ,IAAN,GAAaA,IAAb;;AAEA,QAAGC,WAAW,IAAd,EAAmB;AAClBG,WAAMH,OAAN,GAAgBA,OAAhB;AACAG,WAAMF,UAAN,GAAmBA,UAAnB;AACAE,WAAM3E,WAAN,GAAoB,SAApB;AACA;AACA2E,WAAMC,SAAN,GAAkBnF,UAAUoF,iBAAV,CAA4BL,OAA5B,CAAlB;AACA,KAND,MAMO;AACNG,WAAM3E,WAAN,GAAoB,OAApB;AACA;AACA2E,WAAMC,SAAN,GAAkBnL,OAAOW,IAAP,GAAcC,QAAhC;AACA;;AAEDsK,UAAMG,SAAN,GAAkBrL,OAAOW,IAAP,GAAcC,QAAhC;;AAEAZ,WAAOC,IAAP,CAAY,aAAZ,EAA2BiL,KAA3B;AACG;;AAhCF;AAAA;AAJsB,EAAzB;;AAwCA7L,UAASuL,QAAT,CAAkBlL,OAAlB,CAA0B;AACxB4L;AAAW,wBAAW;AACpB,WAAO,MAAM9L,QAAQO,GAAR,CAAY,UAAZ,CAAb;AACD;;AAFD;AAAA,KADwB;;AAKxBwL;AAAW,wBAAW;AACpB,QAAI/L,QAAQO,GAAR,CAAY,UAAZ,IAA0B,GAA9B,EAAmC;AACjC,YAAO,cAAP;AACD,KAFD,MAEO;AACL,YAAO,WAAP;AACD;AACF;;AAND;AAAA,KALwB;;AAaxByL;AAAe,4BAAW;AACxB,QAAIhM,QAAQO,GAAR,CAAY,UAAZ,KAA2B,CAA3B,IACAP,QAAQO,GAAR,CAAY,UAAZ,IAA0B,GAD1B,IAEA,CAACC,OAAOW,IAAP,EAFL,EAEoB;AAClB,YAAO,UAAP;AACD;AACF;;AAND;AAAA;AAbwB,EAA1B;AAqBA,4H;;;;;;;;;;;ACpEDtB,SAASoM,SAAT,CAAmBlM,SAAnB,CAA6B,YAAW;AACvC,OAAKgD,SAAL,CAAe,QAAf;AACC,OAAKA,SAAL,CAAe,MAAf;AACD,CAHD;;AAKAlD,SAASoM,SAAT,CAAmB/L,OAAnB,CAA2B;AACzB;AAAgB,4BAAW;AACzB,UAAIwL,QAASQ,OAAOtF,IAAP,CAAY,EAAZ,EAAgB,EAACuF,MAAM,EAAC/D,WAAW,CAAC,CAAb,EAAP,EAAhB,CAAb;AACA,aAAOsD,KAAP;AACD;;AAHD;AAAA,KADyB;AAKzB;AAAmB,+BAAW;AAC5B,UAAIhD,UAAU,IAAIL,IAAJ,CAAS,KAAKD,SAAd,CAAd;AACA,UAAIO,UAAUD,QAAQE,cAAR,EAAd;;AAEA,UAAIC,OAAOF,QAAQ3H,KAAR,CAAc,GAAd,CAAX;;AAEA,aAAO6H,KAAK,CAAL,CAAP;AACD;;AAPD;AAAA,KALyB;AAazB;AAAc,0BAAU;AACtB,UAAI+B,MAAMpE,UAAUiF,cAAV,CAAyB,KAAKjI,GAA9B,CAAV;AACA,UAAGoH,MAAM,CAAT,EAAW;AACT,eAAO,IAAP;AACD,OAFD,MAEO,OAAO,KAAP;AACR;;AALD;AAAA,KAbyB;AAmBzB;AAAc,0BAAU;AACtB,aAAO,KAAKpH,GAAZ;AACD;;AAFD;AAAA,KAnByB;AAsBzB;AAAY,wBAAU;AACpB,UAAIoH,MAAMpE,UAAU4F,qBAAV,CAAgC,KAAK5I,GAArC,CAAV;AACA,UAAGoH,MAAM,CAAT,EAAW;AACT,eAAO,UAAP;AACD,OAFD,MAEO,OAAO,YAAP;AACR;;AALD;AAAA,KAtByB;AA4BzB;AAAa,yBAAU;AACrB,UAAIxJ,WAAWZ,OAAOW,IAAP,GAAcC,QAA7B;;AAEA,UAAIyG,WAAWrB,UAAUC,eAAV,CAA0BrF,QAA1B,CAAf;AACA;AACA,UAAGyG,aAAa,CAAhB,EAAkB;AAChB;AACA,YAAIK,QAAQ1B,UAAU6F,mBAAV,CAA8BjL,QAA9B,CAAZ;;AAEAoF,kBAAU8F,oBAAV,CAA+BpE,MAAMnB,WAArC,EAAkDmB,MAAMC,UAAxD;AACD,OALD,MAKO,IAAGN,WAAW,CAAd,EAAgB;AACrBrB,kBAAU8F,oBAAV,CAA+B,WAA/B,EAA4ClL,QAA5C;AACD;AACF;;AAbD;AAAA;AA5ByB,CAA3B;;AA4CAvB,SAASoM,SAAT,CAAmB5K,MAAnB,CAA0B;AACxB;AAAiB,2BAAU;AACzB,UAAIkL,cAAcvM,QAAQO,GAAR,CAAY,aAAZ,CAAlB;AACA,UAAIiM,SAAShM,OAAOiM,KAAP,CAAaC,OAAb,CAAqB,EAAEtL,UAAUmL,WAAZ,EAArB,EAAgD/I,GAA7D;;AAEA5C,cAAQC,GAAR,CAAY,KAAK2C,GAAjB;AACA;AACA,UAAImJ,aAAanG,UAAUoG,gBAAV,CAA2B,KAAKpJ,GAAhC,CAAjB;;AAEA;AACA,UAAG,CAACmJ,UAAJ,EAAe;AACb;AACAnG,kBAAUqG,aAAV,CAAwB,KAAKrJ,GAA7B,EAAkCgJ,MAAlC;AACApM,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,UAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,YAA7B;AACD,OALD,MAKO;AACL,YAAIhL,SAAS6K,WAAWI,YAAxB;AACD;;AAED;AACA,UAAGjL,OAAOZ,OAAP,CAAesL,MAAf,MAA2B,CAAC,CAA/B,EAAiC;AAC/BhG,kBAAUqG,aAAV,CAAwB,KAAKrJ,GAA7B,EAAkCgJ,MAAlC;;AAEA,YAAItE,QAAQ,IAAI9F,MAAJ,EAAZ;AACA8F,cAAM1E,GAAN,GAAY,KAAKA,GAAjB;AACA0E,cAAMnB,WAAN,GAAoB,KAApB;AACAmB,cAAMC,UAAN,GAAmBoE,WAAnB;AACArE,cAAMrB,UAAN,GAAmBL,UAAUoF,iBAAV,CAA4B,KAAKpI,GAAjC,CAAnB;;AAEAhD,eAAOC,IAAP,CAAY,yBAAZ,EAAuCyH,KAAvC;;AAEA9H,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,UAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,YAA7B;AACD,OAbD,MAaO;AACL;AACA;AACA;AACAtG,kBAAUwG,gBAAV,CAA2B,KAAKxJ,GAAhC,EAAqCgJ,MAArC;AACApM,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,YAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,UAA7B;AACD;AACF;;AAxCD;AAAA,KADwB;AA0CxB;AAAmB,4BAAU;AAC3B,UAAItB,aAAahF,UAAUiF,cAAV,CAAyB,KAAKjI,GAA9B,CAAjB;AACA;AACA;AACA,UAAGgI,eAAe,CAAlB,EAAoB;AAChBpL,UAAE,kBAAF,EAAsB4H,KAAtB;AACAhI,gBAAQC,GAAR,CAAY,aAAZ,EAA2B,IAA3B;AACAD,gBAAQC,GAAR,CAAY,gBAAZ,EAA8B,KAAKuD,GAAnC;AACH;AACF;;AATD;AAAA;AA1CwB,CAA1B,2H;;;;;;;;;;;ACjDA3D,SAASoN,gBAAT,CAA0BlN,SAA1B,CAAoC,YAAW;AAC9C,OAAKgD,SAAL,CAAe,eAAf;AACC,OAAKA,SAAL,CAAe,MAAf;AACD,CAHD;;AAKAlD,SAASoN,gBAAT,CAA0B/M,OAA1B,CAAkC;AAChC;AAAuB,mCAAW;AAChC;;;;;;AAMA,aAAOsG,UAAU0G,UAAV,CAAqB,KAAKtL,IAA1B,CAAP;AACD;;AARD;AAAA,KADgC;AAUhC;AAAmB,+BAAW;AAC5B,UAAI8G,UAAU,IAAIL,IAAJ,CAAS,KAAKD,SAAd,CAAd;AACA,UAAIO,UAAUD,QAAQE,cAAR,EAAd;;AAEA,UAAIC,OAAOF,QAAQ3H,KAAR,CAAc,GAAd,CAAX;;AAEA,aAAO6H,KAAK,CAAL,CAAP;AACD;;AAPD;AAAA,KAVgC;AAkBhC;AAAc,0BAAU;AACtB,UAAI+B,MAAMpE,UAAUiF,cAAV,CAAyB,KAAKjI,GAA9B,CAAV;AACA,UAAGoH,MAAM,CAAT,EAAW;AACT,eAAO,IAAP;AACD,OAFD,MAEO,OAAO,KAAP;AACR;;AALD;AAAA,KAlBgC;AAwBhC;AAAc,0BAAU;AACtB,aAAO,KAAKpH,GAAZ;AACD;;AAFD;AAAA,KAxBgC;AA2BhC;AAAY,wBAAU;AACpB,UAAIoH,MAAMpE,UAAU4F,qBAAV,CAAgC,KAAK5I,GAArC,CAAV;AACA,UAAGoH,MAAM,CAAT,EAAW;AACT,eAAO,UAAP;AACD,OAFD,MAEO,OAAO,YAAP;AACR;;AALD;AAAA;AA3BgC,CAAlC;;AAmCA/K,SAASoN,gBAAT,CAA0B5L,MAA1B,CAAiC;AAC/B;AAAiB,2BAAU;AACzB,UAAIkL,cAAcvM,QAAQO,GAAR,CAAY,aAAZ,CAAlB;AACA,UAAIiM,SAAShM,OAAOiM,KAAP,CAAaC,OAAb,CAAqB,EAAEtL,UAAUmL,WAAZ,EAArB,EAAgD/I,GAA7D;AACA;AACA,UAAImJ,aAAanG,UAAUoG,gBAAV,CAA2B,KAAKpJ,GAAhC,CAAjB;AACA,UAAI1B,SAAS6K,WAAWI,YAAxB;;AAEA;AACA,UAAGjL,OAAOZ,OAAP,CAAesL,MAAf,MAA2B,CAAC,CAA/B,EAAiC;AAC/BhG,kBAAUqG,aAAV,CAAwB,KAAKrJ,GAA7B,EAAkCgJ,MAAlC;;AAEA,YAAItE,QAAQ,IAAI9F,MAAJ,EAAZ;AACA8F,cAAM1E,GAAN,GAAY,KAAKA,GAAjB;AACA0E,cAAMnB,WAAN,GAAoB,KAApB;AACAmB,cAAMC,UAAN,GAAmBoE,WAAnB;AACArE,cAAMrB,UAAN,GAAmBL,UAAUoF,iBAAV,CAA4B,KAAKpI,GAAjC,CAAnB;;AAEA5C,gBAAQC,GAAR,CAAYqH,KAAZ;;AAEA1H,eAAOC,IAAP,CAAY,yBAAZ,EAAuCyH,KAAvC;;AAEA9H,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,UAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,YAA7B;AACD,OAfD,MAeO;AACL;AACA;AACA;AACAtG,kBAAUwG,gBAAV,CAA2B,KAAKxJ,GAAhC,EAAqCgJ,MAArC;AACApM,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,YAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,UAA7B;AACD;AACF;;AA/BD;AAAA,KAD+B,EAAjC,qH;;;;;;;;;;;ACxCAjN,SAASsN,gBAAT,CAA0BpN,SAA1B,CAAoC,YAAW;AAC9C,OAAKgD,SAAL,CAAe,mBAAf;AACE,OAAKA,SAAL,CAAe,MAAf;AACF,CAHD;;AAKAlD,SAASsN,gBAAT,CAA0BjN,OAA1B,CAAkC;AACjC;AACC;AAAiB,4BAAU;AAC1B;AACA;AACA;AACA,UAAG,KAAK2E,IAAR,EAAa;AACZrD,aAAKgF,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAL;AACA,eAAO0I,OAAOtF,IAAP,CAAapF,EAAb,EAAiB,EAAC2K,MAAM,EAAC/D,WAAW,CAAC,CAAb,EAAP,EAAjB,CAAP;AACA,OAHD,MAGO;AACN,eAAO8D,OAAOtF,IAAP,CAAa,KAAKpD,GAAlB,EAAuB,EAAC2I,MAAM,EAAC/D,WAAW,CAAC,CAAb,EAAP,EAAvB,CAAP;AACA;AACD;;AAVD;AAAA,KAFgC;AAahC;AAA2B,uCAAW;AACrC,UAAG,KAAKvD,IAAR,EAAa;AACZrD,aAAKgF,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAL;AACA,eAAO0I,OAAOtF,IAAP,CAAY,EAACyG,gBAAiB7L,EAAlB,EAAZ,EAAmC,EAAC2K,MAAM,EAAC/D,WAAW,CAAC,CAAb,EAAP,EAAnC,CAAP;AACA,OAHD,MAGO;AACN,eAAO8D,OAAOtF,IAAP,CAAY,EAACyG,gBAAiB,KAAK7J,GAAvB,EAAZ,EAAyC,EAAC2I,MAAM,EAAC/D,WAAW,CAAC,CAAb,EAAP,EAAzC,CAAP;AACA;AACD;;AAPD;AAAA,KAbgC;AAqBhC;AAAmB,+BAAW;AAC5B,UAAIM,UAAU,IAAIL,IAAJ,CAAS,KAAKD,SAAd,CAAd;AACA,UAAIO,UAAUD,QAAQE,cAAR,EAAd;;AAEA,UAAIC,OAAOF,QAAQ3H,KAAR,CAAc,GAAd,CAAX;;AAEA,aAAO6H,KAAK,CAAL,CAAP;AACD;;AAPD;AAAA,KArBgC;AA6BhC;AAAc,0BAAU;AACtB,aAAO,KAAKrF,GAAZ;AACD;;AAFD;AAAA,KA7BgC;AAgChC;AAAY,wBAAU;AACpB,UAAIoH,MAAMpE,UAAU4F,qBAAV,CAAgC,KAAK5I,GAArC,CAAV;AACA,UAAGoH,MAAM,CAAT,EAAW;AACT,eAAO,UAAP;AACD,OAFD,MAEO,OAAO,YAAP;AACR;;AALD;AAAA;AAhCgC,CAAlC;;AAwCA/K,SAASsN,gBAAT,CAA0B9L,MAA1B,CAAiC;AAC/B;AAAiB,2BAAU;AACzB,UAAIkL,cAAcvM,QAAQO,GAAR,CAAY,aAAZ,CAAlB;AACA,UAAIiM,SAAShM,OAAOiM,KAAP,CAAaC,OAAb,CAAqB,EAAEtL,UAAUmL,WAAZ,EAArB,EAAgD/I,GAA7D;AACA;AACA,UAAImJ,aAAanG,UAAUoG,gBAAV,CAA2B,KAAKpJ,GAAhC,CAAjB;AACA,UAAI1B,SAAS6K,WAAWI,YAAxB;AACJ;AACI,UAAGjL,OAAOZ,OAAP,CAAesL,MAAf,MAA2B,CAAC,CAA/B,EAAiC;AAC/BhG,kBAAUqG,aAAV,CAAwB,KAAKrJ,GAA7B,EAAkCgJ,MAAlC;;AAEA,YAAItE,QAAQ,IAAI9F,MAAJ,EAAZ;AACA8F,cAAM1E,GAAN,GAAY,KAAKA,GAAjB;AACA0E,cAAMnB,WAAN,GAAoB,KAApB;AACAmB,cAAMC,UAAN,GAAmBoE,WAAnB;AACArE,cAAMrB,UAAN,GAAmBL,UAAUoF,iBAAV,CAA4B,KAAKpI,GAAjC,CAAnB;;AAEA5C,gBAAQC,GAAR,CAAYqH,KAAZ;;AAEA1H,eAAOC,IAAP,CAAY,yBAAZ,EAAuCyH,KAAvC;;AAEA9H,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,UAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,YAA7B;AACD,OAfD,MAeO;AACL;AACA;AACA;AACAtG,kBAAUwG,gBAAV,CAA2B,KAAKxJ,GAAhC,EAAqCgJ,MAArC;AACApM,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,YAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,UAA7B;AACD;AACF;;AA9BD;AAAA,KAD+B;AAgC/B;AAAmB,4BAAU;AAC9B1M,QAAE,kBAAF,EAAsB4H,KAAtB;AACAhI,cAAQC,GAAR,CAAY,gBAAZ,EAA8B,KAAKuD,GAAnC;AACAxD,cAAQC,GAAR,CAAY,aAAZ,EAA2B,IAA3B;AACE;;AAJD;AAAA;AAhC+B,CAAjC,2H;;;;;;;;;;;AC7CAJ,SAASyN,SAAT,CAAmBpN,OAAnB,CAA2B;AACzB;AAAmB,+BAAW;AAC7B,UAAIwI,UAAU,IAAIL,IAAJ,CAAS,KAAKkF,cAAd,CAAd;AACA,UAAI5E,UAAUD,QAAQE,cAAR,EAAd;AACC,aAAOD,OAAP;AACD;;AAJD;AAAA,KADyB;;AAOzB;AAAgB,4BAAW;AACzB/H,cAAQC,GAAR,CAAY,KAAK2C,GAAjB;AACA,UAAIgK,SAAU7G,cAAcC,IAAd,CAAmB,EAACpD,KAAK,KAAKA,GAAX,EAAnB,CAAd;AACA,aAAOgK,MAAP;AACD;;AAJD;AAAA,KAPyB;;AAazB;AAAoB,+BAAU;AAC5B,UAAI5C,MAAOjE,cAAcC,IAAd,CAAmB,EAACpD,KAAK,KAAKA,GAAX,EAAnB,EAAoC0D,KAApC,EAAX;AACA,UAAG0D,QAAQ,CAAX,EAAa;AACX,eAAO,KAAP;AACD,OAFD,MAEO;AACL,eAAO,IAAP;AACD;AACF;;AAPD;AAAA;AAbyB,CAA3B;;AAuBA/K,SAASyN,SAAT,CAAmBjM,MAAnB,CAA0B;AACxB;AAAgB,2BAAW;AACzBT,cAAQC,GAAR,CAAY,KAAK2C,GAAjB;AACAmD,oBAAc8G,MAAd,CAAqB,KAAKjK,GAA1B,EAA+B,EAACkK,MAAM,EAAC5G,MAAM,IAAP,EAAP,EAA/B;AACAlG,cAAQC,GAAR,CAAY,QAAZ;AACAR,aAAOsD,QAAP,GAAkB,GAAlB;AACD;;AALD;AAAA;AADwB,CAA1B,2H;;;;;;;;;;;ACvBA9D,SAAS8N,YAAT,CAAsB5N,SAAtB,CAAgC,YAAW;AACzC,OAAKgD,SAAL,CAAe,mBAAf;AACA,OAAKA,SAAL,CAAe,MAAf;AACA,OAAKA,SAAL,CAAe,kBAAf;AACA6K,cAAY,EAAZ;AACAC,qBAAmB,EAAnB;AACAC,qBAAmB,EAAnB;AACAC,iBAAe,CAAf;AACAC,iBAAe,CAAf;;AAEAC,mBAAiBzH,UAAU0H,qBAAV,CAAgC,KAAKvM,IAAL,CAAUC,IAA1C,EAAgD,SAAhD,CAAjB;;AAEAuM,mBAAiB3H,UAAU0H,qBAAV,CAAgC,KAAKvM,IAAL,CAAUC,IAA1C,EAAgD,KAAhD,CAAjB;;AAEA5B,UAAQC,GAAR,CAAY,qBAAZ,EAAmC,IAAnC;AACD,CAfD;;AAiBAJ,SAAS8N,YAAT,CAAsBzN,OAAtB,CAA8B;AAC5B;AAAkB,8BAAU;AAC1B,UAAIC,WAAWC,EAAEC,MAAF,EAAUC,KAAV,EAAf;AACA;AACAH,kBAAY,CAAZ;AACA,aAAOA,WAAS,CAAT,GAAa,IAApB;AACD;;AALD;AAAA,KAD4B;;AAQ5B;AAAmB,+BAAW;AAC5B,UAAIuI,UAAU,IAAIL,IAAJ,CAAS,KAAKkF,cAAd,CAAd;AACA,UAAI5E,UAAUD,QAAQE,cAAR,EAAd;;AAEA,UAAIC,OAAOF,QAAQ3H,KAAR,CAAc,GAAd,CAAX;AACA,aAAO6H,KAAK,CAAL,CAAP;AACD;;AAND;AAAA,KAR4B;;AAgB5B;AAAgB,4BAAW;AACzBmF,qBAAeC,eAAe/G,KAAf,EAAf;AACAlH,cAAQC,GAAR,CAAY,eAAZ,EAA6B+N,YAA7B;AACA,aAAOC,cAAP;AACD;;AAJD;AAAA,KAhB4B;;AAsB5B;AAAY,wBAAW;AACrBF,qBAAeI,eAAejH,KAAf,EAAf;AACAlH,cAAQC,GAAR,CAAY,eAAZ,EAA6B8N,YAA7B;AACA,aAAOI,cAAP;AACD;;AAJD;AAAA,KAtB4B;;AA4B5B;AAAoB,+BAAU;AAC5B,UAAItG,WAAYrB,UAAUC,eAAV,CAA0B,KAAK7E,IAA/B,CAAhB;AACA,UAAGiG,aAAa,CAAhB,EAAkB;AAChB,eAAO,KAAP;AACD,OAFD,MAEO;AACL,eAAO,IAAP;AACD;AACF;;AAPD;AAAA,KA5B4B;;AAqC5B;AAAgB,2BAAU;AACxB+F,gBAAUrL,IAAV,CAAe,KAAKiB,GAApB;AACA,UAAG,KAAKuD,WAAL,KAAqB,SAAxB,EAAkC;AAChC,YAAG8G,iBAAiBrL,MAAjB,GAA0BwL,YAA7B,EAA0C;AACxCH,2BAAiBtL,IAAjB,CAAsB,KAAKiB,GAA3B;AACD;AACF,OAJD,MAIO,IAAG,KAAKuD,WAAL,KAAqB,KAAxB,EAA8B;AACnC,YAAG+G,iBAAiBtL,MAAjB,GAA0BuL,YAA7B,EAA0C;AACxCD,2BAAiBvL,IAAjB,CAAsB,KAAKiB,GAA3B;AACD;AACF;AACF;;AAXD;AAAA,KArC4B;;AAkD5B;AAA0B,qCAAU;;AAElC,UAAI4K,aAAapO,QAAQO,GAAR,CAAY,eAAZ,CAAjB;AACA,UAAI8N,aAAarO,QAAQO,GAAR,CAAY,eAAZ,CAAjB;;AAEA,UAAG6N,aAAaC,UAAhB,EAA2B;AACzB;AACA;AACArO,gBAAQC,GAAR,CAAY,oBAAZ,EAAkC,KAAlC;AACD,OAJD,MAIO,IAAGmO,aAAaC,UAAhB,EAA2B;AAChC;AACA;AACArO,gBAAQC,GAAR,CAAY,oBAAZ,EAAkC,IAAlC;AACD,OAJM,MAIA,IAAGmO,eAAeC,UAAlB,EAA6B;AAClC;AACArO,gBAAQC,GAAR,CAAY,oBAAZ,EAAkC,KAAlC;AACD;AACF;;AAjBD;AAAA,KAlD4B;;AAqE5B;AAAmB,8BAAU;AAC3B,aAAOuG,UAAU4F,qBAAV,CAAgC,KAAKb,OAArC,CAAP;AACD;;AAFD;AAAA,KArE4B;AAwE5B;AAAmB,8BAAU;AAC3B;AACA;AACA,UAAIA,UAAU/E,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAd;;AAEA,UAAIoH,MAAMpE,UAAUiF,cAAV,CAAyBF,OAAzB,CAAV;AACA,UAAGX,MAAM,CAAT,EAAW;AACT,eAAO,IAAP;AACD,OAFD,MAEO,OAAO,KAAP;AACR;;AATD;AAAA,KAxE4B;AAkF5B;AAAc,0BAAU;AACtB,UAAIA,MAAMpE,UAAUiF,cAAV,CAAyBjF,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAzB,CAAV;AACA,aAAOoH,GAAP;AACD;;AAHD;AAAA,KAlF4B;AAsF5B;AAAc,0BAAU;AACtB,aAAO,KAAKpH,GAAZ;AACD;;AAFD;AAAA,KAtF4B;AAyF5B;AAAY,wBAAU;AACpB,UAAI+H,UAAU/E,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAd;AACA,UAAIoH,MAAMpE,UAAU4F,qBAAV,CAAgCb,OAAhC,CAAV;AACA,UAAGX,MAAM,CAAT,EAAW;AACT,eAAO,UAAP;AACD,OAFD,MAEO,OAAO,YAAP;AACR;;AAND;AAAA,KAzF4B;AAgG5B;AAAe,2BAAU;AACvB,UAAIW,UAAU/E,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAd;AACA,UAAIoH,MAAMpE,UAAU4F,qBAAV,CAAgCb,OAAhC,CAAV;AACA,UAAGX,MAAM,CAAT,EAAW;AACT,eAAO,IAAP;AACD,OAFD,MAEO,OAAO,KAAP;AACR;;AAND;AAAA,KAhG4B;AAuG5B;AAAU,sBAAU;AAClB,UAAIW,UAAU/E,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAd;AACA,UAAIoH,MAAMpE,UAAU4F,qBAAV,CAAgCb,OAAhC,CAAV;AACA,aAAOX,GAAP;AACD;;AAJD;AAAA,KAvG4B;AA4G5B;AAAe,2BAAU;AACvB,aAAO5K,QAAQO,GAAR,CAAY,oBAAZ,CAAP;AACD;;AAFD;AAAA,KA5G4B;AA+G5B;AAAe,2BAAU;AACvB,UAAGP,QAAQO,GAAR,CAAY,eAAZ,MAAiC,CAApC,EAAsC;AACpC,eAAO,IAAP;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF;;AAND;AAAA,KA/G4B;AAsH5B;AAAe,2BAAU;AACvB,UAAGP,QAAQO,GAAR,CAAY,eAAZ,MAAiC,CAApC,EAAsC;AACpC,eAAO,IAAP;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF;;AAND;AAAA,KAtH4B;AA6H5B;AAAkB,8BAAU;AAC1B,aAAOP,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AAFD;AAAA,KA7H4B;AAgI5B;AAAkB,8BAAU;AAC1B,aAAOP,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AAFD;AAAA;AAhI4B,CAA9B;;AAqIAV,SAAS8N,YAAT,CAAsBtM,MAAtB,CAA6B;AAC3B;AAA0B,kCAASC,KAAT,EAAgB;AACxCV,cAAQC,GAAR,CAAYgN,iBAAiBrL,MAA7B;AACA5B,cAAQC,GAAR,CAAYiN,iBAAiBtL,MAA7B;;AAEA5B,cAAQC,GAAR,CAAY+M,SAAZ;;AAEA,UAAIU,QAAQhN,MAAMoB,MAAN,CAAalB,EAAzB;;AAEA,UAAG8M,UAAU,kBAAb,EAAgC;AAC9B,aAAK,IAAInM,GAAT,2CAAgB0L,gBAAhB,GAAiC;AAC/B,cAAIrM,KAAKqM,iBAAiB1L,GAAjB,CAAT;AACAwE,wBAAc8G,MAAd,CAAqBjM,EAArB,EAAyB,EAACkM,MAAM,EAAC5G,MAAM,IAAP,EAAP,EAAzB;AACA+G,2BAAiBjL,MAAjB,CAAwBT,GAAxB,EAA4B,CAA5B;AACD;AACF,OAND,MAMO,IAAGmM,UAAU,kBAAb,EAAgC;AACrC,aAAK,IAAInM,GAAT,2CAAgB2L,gBAAhB,GAAiC;AAC/B,cAAItM,KAAKsM,iBAAiB3L,GAAjB,CAAT;AACAwE,wBAAc8G,MAAd,CAAqBjM,EAArB,EAAyB,EAACkM,MAAM,EAAC5G,MAAM,IAAP,EAAP,EAAzB;AACAgH,2BAAiBlL,MAAjB,CAAwBT,GAAxB,EAA4B,CAA5B;AACD;AACF;;AAEDnC,cAAQC,GAAR,CAAY,eAAZ,EAA6B6N,iBAAiBtL,MAA9C;AACAxC,cAAQC,GAAR,CAAY,eAAZ,EAA6B4N,iBAAiBrL,MAA9C;;AAEA,UAAGqL,iBAAiBrL,MAAjB,KAA4B,CAA5B,IAAiCsL,iBAAiBtL,MAAjB,KAA4B,CAAhE,EAAkE;AAChEnC,eAAOsD,QAAP,GAAkB,GAAlB;AACD;AACF;;AA5BD;AAAA,KAD2B;AA8B3B;AAAiB,2BAAU;AACzB,UAAI4I,cAAcvM,QAAQO,GAAR,CAAY,aAAZ,CAAlB;AACA,UAAIiM,SAAShM,OAAOiM,KAAP,CAAaC,OAAb,CAAqB,EAAEtL,UAAUmL,WAAZ,EAArB,EAAgD/I,GAA7D;;AAEA;AACA,UAAI+K,QAAQ/H,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAZ;AACA,UAAImJ,aAAanG,UAAUoG,gBAAV,CAA2B2B,KAA3B,CAAjB;AACA,UAAIzM,SAAS6K,WAAWI,YAAxB;;AAEA;AACA,UAAGjL,OAAOZ,OAAP,CAAesL,MAAf,MAA2B,CAAC,CAA/B,EAAiC;AAC/BhG,kBAAUqG,aAAV,CAAwB0B,KAAxB,EAA+B/B,MAA/B;;AAEA,YAAItE,QAAQ,IAAI9F,MAAJ,EAAZ;AACA8F,cAAM1E,GAAN,GAAY+K,KAAZ;AACArG,cAAMnB,WAAN,GAAoB,KAApB;AACAmB,cAAMC,UAAN,GAAmBoE,WAAnB;AACArE,cAAMrB,UAAN,GAAmBL,UAAUoF,iBAAV,CAA4B2C,KAA5B,CAAnB;;AAEA3N,gBAAQC,GAAR,CAAYqH,KAAZ;;AAEA1H,eAAOC,IAAP,CAAY,yBAAZ,EAAuCyH,KAAvC;;AAEA9H,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,UAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,YAA7B;AACD,OAfD,MAeO;AACL;AACA;AACA;AACAtG,kBAAUwG,gBAAV,CAA2BuB,KAA3B,EAAkC/B,MAAlC;AACApM,UAAE,MAAK,KAAKoD,GAAZ,EAAiBkH,QAAjB,CAA0B,YAA1B;AACAtK,UAAE,MAAK,KAAKoD,GAAZ,EAAiBsJ,WAAjB,CAA6B,UAA7B;AACD;AACF;;AAjCD;AAAA,KA9B2B;AAgE3B;AAAmB,4BAAU;AAC3B,UAAItB,aAAahF,UAAUiF,cAAV,CAAyBjF,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAAzB,CAAjB;AACA;AACA;AACA,UAAGgI,eAAe,CAAlB,EAAoB;AAChBpL,UAAE,kBAAF,EAAsB4H,KAAtB;AACAhI,gBAAQC,GAAR,CAAY,aAAZ,EAA2B,IAA3B;AACAD,gBAAQC,GAAR,CAAY,gBAAZ,EAA8BuG,UAAU4G,kBAAV,CAA6B,KAAK5J,GAAlC,CAA9B;AACH;AACF;;AATD;AAAA,KAhE2B;AA0E3B;AAA4B,qCAAU;AACpCxD,cAAQC,GAAR,CAAY,oBAAZ,EAAkC,KAAlC;AACD;;AAFD;AAAA,KA1E2B;AA6E3B;AAA4B,qCAAU;AACpCD,cAAQC,GAAR,CAAY,oBAAZ,EAAkC,IAAlC;AACD;;AAFD;AAAA;AA7E2B,CAA7B,4H;;;;;;;;;;;ACtJAJ,SAAS2O,cAAT,CAAwBnJ,UAAxB,CAAmC,YAAU;AAC3CrF,UAAQC,GAAR,CAAY,YAAZ,EAA0B,IAA1B;AACD,CAFD;;AAIAJ,SAAS2O,cAAT,CAAwBnN,MAAxB,CAA+B;AAC7B;AAAiB,yBAASC,KAAT,EAAgB;AAC/B,UAAImN,SAAS,KAAb;AACA,UAAIC,UAAU,KAAd;;AAEA;AACAtO,QAAE,cAAF,EAAkBqK,IAAlB,CAAuB,YAAU;AAC/BrK,UAAE,IAAF,EAAQ0F,MAAR;AACD,OAFD;AAGA1F,QAAE,eAAF,EAAmBqK,IAAnB,CAAwB,YAAU;AAChCrK,UAAE,IAAF,EAAQ0M,WAAR,CAAoB,cAApB;AACD,OAFD;;AAIA,UAAI3L,OAAO;AACTC,kBAAUhB,EAAE,oBAAF,EAAwBqF,GAAxB,EADD;AAETkJ,kBAAUvO,EAAE,iBAAF,EAAqBqF,GAArB,EAFD;AAGTmJ,iBAAS;AACPC,oBAAUzO,EAAE,iBAAF,EAAqBqF,GAArB,EADH;AAEPqJ,iBAAQ1O,EAAE,cAAF,EAAkBqF,GAAlB;AAFD;AAHA,OAAX;;AASA;AACA,UAAGtE,KAAKyN,OAAL,CAAaE,KAAb,CAAmB5N,OAAnB,CAA2B,GAA3B,MAAoC,CAAC,CAAxC,EAA0C;AACxCd,UAAE,kBAAF,EAAsBuF,MAAtB,CAA6B,gEAA7B;AACAvF,UAAE,cAAF,EAAkBsK,QAAlB,CAA2B,cAA3B;AACAgE,kBAAU,KAAV;AACD,OAJD,MAIO;AACLA,kBAAU,IAAV;AACD;;AAED;AACA,UAAIK,QAAQ/O,QAAQO,GAAR,CAAY,eAAZ,CAAZ;;AAEA,UAAGY,KAAKwN,QAAL,IAAiBI,KAApB,EAA0B;AACxB3O,UAAE,kBAAF,EAAsBuF,MAAtB,CAA6B,uEAA7B;AACAvF,UAAE,iBAAF,EAAqBsK,QAArB,CAA8B,cAA9B;AACAtK,UAAE,kBAAF,EAAsBsK,QAAtB,CAA+B,cAA/B;AACA+D,iBAAS,KAAT;AACD,OALD,MAKO;AACLA,iBAAS,IAAT;AACD;;AAED,UAAGA,UAAUC,OAAb,EAAqB;AACnBM,iBAASC,UAAT,CAAoB9N,IAApB,EAA0B,UAAUT,GAAV,EAAe;AACvC;AACA,cAAGA,IAAIwO,MAAJ,KAAe,0BAAlB,EAA6C;AAC3C9O,cAAE,oBAAF,EAAwBsK,QAAxB,CAAiC,cAAjC;AACAtK,cAAE,kBAAF,EAAsBuF,MAAtB,CAA6B,2EAA7B;AACD;AACF,SAND;;AAQA;AACA,YAAIwJ,WAAW,IAAI/M,MAAJ,EAAf;AACA+M,iBAASC,QAAT,GAAoBjO,KAAKyN,OAAL,CAAaC,QAAjC;AACAM,iBAAS9M,eAAT,GAA2BlB,KAAKC,QAAhC;AACA+N,iBAASE,SAAT,GAAqBlO,KAAK2N,KAA1B;AACAK,iBAAS9K,OAAT,GAAmB,EAAnB;AACA8K,iBAASG,eAAT,GAA2B,EAA3B;;AAEA9O,eAAOC,IAAP,CAAY,gBAAZ,EAA8B0O,QAA9B;AACD;AACF;;AA7DD;AAAA,KAD6B;;AAgE7B;AAAgB,wBAAS7N,KAAT,EAAgB;AAC9BA,YAAMiO,cAAN;AACAnP,QAAE,eAAF,EAAmByJ,IAAnB,CAAwB,EAAxB;AACA,UAAIzI,WAAWhB,EAAE,mBAAF,EAAuBqF,GAAvB,EAAf;AACA,UAAIkJ,WAAWvO,EAAE,gBAAF,EAAoBqF,GAApB,EAAf;;AAEAjF,aAAOgP,iBAAP,CAAyBpO,QAAzB,EAAmCuN,QAAnC,EAA6C,UAASjO,GAAT,EAAc;AACzD,YAAGA,GAAH,EAAO;AACL,cAAGA,IAAIwO,MAAJ,KAAe,gBAAlB,EAAmC;AACjC9O,cAAE,mBAAF,EAAuBsK,QAAvB,CAAgC,cAAhC;AACAtK,cAAE,eAAF,EAAmBuF,MAAnB,CAA0B,uBAA1B;AACD,WAHD,MAGO;AACLvF,cAAE,gBAAF,EAAoBsK,QAApB,CAA6B,cAA7B;AACAtK,cAAE,eAAF,EAAmBuF,MAAnB,CAA0B,+BAA1B;AACD;AACDvF,YAAE,oBAAF,EAAwB4H,KAAxB,CAA8B,MAA9B;AACD;AAEF,OAZD;AAaAyH,kBAAY,IAAZ;AACD;;AApBD;AAAA,KAhE6B;;AAsF7B;AAA6B,uCAAW;AACtCzP,cAAQC,GAAR,CAAY,iBAAZ,EAA+B,IAA/B;AACD;;AAFD;AAAA,KAtF6B;;AA0F7B;AAAwB,kCAAU;AAChCD,cAAQC,GAAR,CAAY,YAAZ,EAA0B,IAA1B;AACD;;AAFD;AAAA,KA1F6B;;AA8F7B;AAA2B,qCAAU;AACnCD,cAAQC,GAAR,CAAY,YAAZ,EAA0B,KAA1B;AACD;;AAFD;AAAA,KA9F6B;AAiG7B;AAA2B,mCAASqB,KAAT,EAAe;AACxCtB,cAAQC,GAAR,CAAY,eAAZ,EAA6BG,EAAE,kBAAF,EAAsBqF,GAAtB,EAA7B;AACD;;AAFD;AAAA,KAjG6B;AAoG7B;AAA6B,oCAASnE,KAAT,EAAe;AAC1ClB,QAAE,mBAAF,EAAuB0M,WAAvB,CAAmC,cAAnC;AACD;;AAFD;AAAA,KApG6B;AAuG7B;AAA0B,iCAASxL,KAAT,EAAe;AACvClB,QAAE,gBAAF,EAAoB0M,WAApB,CAAgC,cAAhC;AACD;;AAFD;AAAA;AAvG6B,CAA/B;;AA4GAjN,SAAS2O,cAAT,CAAwBtO,OAAxB,CAAgC;AAC9B;AAAa,yBAAU;AACrB,aAAOF,QAAQO,GAAR,CAAY,YAAZ,CAAP;AACD;;AAFD;AAAA;AAD8B,CAAhC,4H;;;;;;;;;;;AChHAV,SAAS6P,WAAT,CAAqB3P,SAArB,CAA+B,YAAU;AACxC2B,oBAAkB,KAAKC,IAAL,CAAUC,IAA5B;AACC5B,UAAQC,GAAR,CAAY,eAAZ,EAA6B,cAAYyB,eAAzC;AACD,CAHD;;AAKA7B,SAAS6P,WAAT,CAAqBrO,MAArB,CAA4B;AAC3B;AAAiB,2BAAW;AACxBb,aAAOmP,MAAP;AACAtP,aAAOsD,QAAP,GAAkB,GAAlB;AACD;;AAHH;AAAA,KAD2B;AAKxB;AAA4B,sCAAU;AACpCvD,QAAE,sBAAF,EAA0B4H,KAA1B,CAAgC,MAAhC;AACD;;AAFD;AAAA,KALwB;AAQzB;AAAoB,4BAAS1G,KAAT,EAAe;;AAElC,UAAIsO,OAAOtO,MAAMoB,MAAN,CAAalB,EAAxB;AACA,UAAGoO,SAAS,UAAZ,EAAuB;AACtBvP,eAAOwP,IAAP,CAAY,4CAA4C7P,QAAQO,GAAR,CAAY,UAAZ,EAAwBiE,MAAhF;AACA,OAFD,MAEO,IAAGoL,SAAS,WAAZ,EAAwB;AAC9BvP,eAAOwP,IAAP,CAAY,+BAA+B7P,QAAQO,GAAR,CAAY,UAAZ,EAAwBkE,SAAvD,GAAmE,GAA/E;AACA,OAFM,MAEA,IAAGmL,SAAS,UAAZ,EAAuB;AAC7B5P,gBAAQC,GAAR,CAAY,eAAZ,EAA6ByB,eAA7B;;AAEA,YAAIoO,cAActP,OAAOW,IAAP,GAAcC,QAAhC;;AAEA,YAAI2O,WAAW3L,SAASrC,WAAxB;AACAvB,eAAOC,IAAP,CAAY,cAAZ,EAA4BqP,WAA5B,EAAyC,UAASpP,GAAT,EAAaC,GAAb,EAAiB;AACxD,cAAGoP,SAASvN,MAAT,GAAkB,CAArB,EAAuB;AACpB,gBAAGuN,SAAS7O,OAAT,CAAiBP,IAAI2B,MAArB,KAAgC,CAAnC,EAAqC;AAC/B1B,sBAAQC,GAAR,CAAY,SAAZ;AACL;AACKT,gBAAE,yBAAF,EAA6BmD,IAA7B,CAAkC,OAAlC,EAA2Ca,SAASG,SAApD;AACLnE,gBAAE,yBAAF,EAA6BkJ,OAA7B,CAAqC,MAArC;AACE,aALH,MAKS;AACDlJ,gBAAE,yBAAF,EAA6BkJ,OAA7B,CAAqC,MAArC;AACD;AACL,WATL,MASW,IAAG,CAACtJ,QAAQO,GAAR,CAAY,sBAAZ,CAAJ,EAAwC;AAC/C;AACAH,cAAE,2BAAF,EAA+B4H,KAA/B,CAAqC,MAArC;AACA,WAHO,MAGD;AACD5H,cAAE,yBAAF,EAA6BkJ,OAA7B,CAAqC,MAArC;AACD;AACT,SAhBD;AAiBA;AACD;;AA/BD;AAAA,KARyB;AAwCzB;AAAyB,mCAAU;AAClCjJ,aAAOsD,QAAP,GAAkB,iBAAiBjC,eAAnC;AACA;;AAFD;AAAA,KAxCyB;AA2CzB;AAAwB,kCAAU;AACjCrB,aAAOsD,QAAP,GAAkB,iBAAiBjC,eAAnC;AACA;;AAFD;AAAA,KA3CyB;AA8CxB;AAAsB,gCAAU;AAC9BtB,QAAE,uBAAF,EAA2B4H,KAA3B,CAAiC,MAAjC;AACD;;AAFD;AAAA,KA9CwB;AAiDxB;AAAqB,+BAAU;AAC7BxH,aAAOC,IAAP,CAAY,cAAZ,EAA4BiB,eAA5B;AACA1B,cAAQC,GAAR,CAAY,gBAAZ,EAA8B,KAA9B;AACAG,QAAE,uBAAF,EAA2B4H,KAA3B,CAAiC,MAAjC;AACD;;AAJD;AAAA,KAjDwB;AAsDxB;AAAuB,iCAAU;AAC/B5H,QAAE,uBAAF,EAA2B4H,KAA3B,CAAiC,MAAjC;AACD;;AAFD;AAAA,KAtDwB;AAyDxB;AAAoB,8BAAU;AAC5BhI,cAAQC,GAAR,CAAY,gBAAZ,EAA8B,IAA9B;AACAO,aAAOC,IAAP,CAAY,YAAZ,EAA0BiB,eAA1B;AACD;;AAHD;AAAA,KAzDwB;AA6DxB;AAAyB,mCAAU;AACjC,UAAIsO,iBAAiB5P,EAAE,iBAAF,EAAqBmD,IAArB,CAA0B,KAA1B,CAArB;AACAnD,QAAE,SAASsB,eAAX,EAA4B6B,IAA5B,CAAiC,KAAjC,EAAwCyM,cAAxC;AACA5P,QAAE,0BAAF,EAA8B4H,KAA9B,CAAoC,MAApC;AACA5H,QAAE,iBAAF,EAAqB6P,GAArB,CAAyB,SAAzB,EAAoC,GAApC;AACD;;AALD;AAAA,KA7DwB;AAmExB;AAAkC,4CAAU;AAC1C7P,QAAE,0BAAF,EAA8B4H,KAA9B,CAAoC,MAApC;AACD;;AAFD;AAAA;AAnEwB,CAA5B;;AAwEAnI,SAAS6P,WAAT,CAAqBxP,OAArB,CAA6B;AAC5B;AAAiB,6BAAU;AAC1BM,aAAOC,IAAP,CAAY,cAAZ,EAA4BiB,eAA5B,EAA6C,UAAShB,GAAT,EAAcC,GAAd,EAAmB;AAC7DX,gBAAQC,GAAR,CAAY,UAAZ,EAAuBU,GAAvB;AACD,OAFF;;AAICyD,iBAAWpE,QAAQO,GAAR,CAAY,UAAZ,CAAX;;AAEA,aAAO6D,QAAP;AACD;;AARD;AAAA,KAD4B;AAU5B;AAAgB,4BAAU;AACzB,UAAGA,SAASC,OAAT,IAAoB,EAAvB,EAA0B;AACzB7D,eAAOC,IAAP,CAAY,aAAZ,EAA2B2D,SAASC,OAApC,EAA6C,UAAS3D,GAAT,EAAcC,GAAd,EAAmB;AAC/DP,YAAE,iBAAF,EAAqBmD,IAArB,CAA0B,KAA1B,EAAiC5C,GAAjC;AACE,SAFH;AAGA,OAJD,MAIO;AACNC,gBAAQC,GAAR,CAAY,gBAAZ;AACA;AACA,eAAO,qBAAP;AACA;AACD;;AAVD;AAAA,KAV4B;AAqB5B;AAAU,sBAAU;AACnB,aAAO2F,UAAU0G,UAAV,CAAqBxL,eAArB,EAAsCwF,KAAtC,EAAP;AACA;;AAFD;AAAA,KArB4B;AAwB5B;AAAa,yBAAU;AACrB1G,aAAOC,IAAP,CAAY,eAAZ,EAA6BiB,eAA7B,EAA8C,UAAShB,GAAT,EAAcC,GAAd,EAAmB;AAChEX,gBAAQC,GAAR,CAAY,eAAZ,EAA4BU,IAAI6B,MAAhC;AACA,OAFD;AAGA,aAAOxC,QAAQO,GAAR,CAAY,eAAZ,CAAP;AACD;;AALD;AAAA,KAxB4B;AA8B5B;AAAa,yBAAU;AACpBC,aAAOC,IAAP,CAAY,cAAZ,EAA4BiB,eAA5B,EAA6C,UAAShB,GAAT,EAAcC,GAAd,EAAmB;AAC9DX,gBAAQC,GAAR,CAAY,cAAZ,EAA2BU,GAA3B;AACDX,gBAAQC,GAAR,CAAY,cAAZ,EAA2BU,IAAI6B,MAA/B;AACA,OAHD;;AAKA,UAAI0N,mBAAmBlQ,QAAQO,GAAR,CAAY,cAAZ,CAAvB;AACA,UAAIgM,cAAcvM,QAAQO,GAAR,CAAY,aAAZ,CAAlB;;AAEA,UAAG2P,gBAAH,EAAoB;AAClB,YAAItK,UAAUsK,iBAAiBhP,OAAjB,CAAyBqL,WAAzB,CAAd;;AAEA,YAAG3G,WAAW,CAAC,CAAf,EAAiB;AACf5F,kBAAQC,GAAR,CAAY,gBAAZ,EAA8B,IAA9B;AACD,SAFD,MAEO;AACLD,kBAAQC,GAAR,CAAY,gBAAZ,EAA8B,KAA9B;AACD;AACF;;AAEF,aAAOD,QAAQO,GAAR,CAAY,cAAZ,CAAP;AACD;;AApBD;AAAA,KA9B4B;AAmD5B;AAAuB,mCAAU;;AAEhC,UAAI4P,YAAY,EAAhB;;AAEA,UAAG/L,SAASI,MAAZ,EAAmB;AAClB,YAAItB,UAAU,IAAId,MAAJ,EAAd;AACAc,gBAAQkN,KAAR,GAAgB,SAAhB;AACAlN,2BAAgB,gBAAhB;AACAA,gBAAQ1B,EAAR,GAAa,UAAb;AACA2O,kBAAU5N,IAAV,CAAeW,OAAf;AACA;;AAED,UAAGkB,SAASK,SAAZ,EAAsB;AACrB,YAAIvB,UAAU,IAAId,MAAJ,EAAd;AACAc,gBAAQkN,KAAR,GAAgB,SAAhB;AACAlN,2BAAgB,iBAAhB;AACAA,gBAAQ1B,EAAR,GAAa,WAAb;AACA2O,kBAAU5N,IAAV,CAAeW,OAAf;AACA;;AAED,UAAGkB,SAASG,SAAZ,EAAsB;AACrB,YAAIrB,UAAU,IAAId,MAAJ,EAAd;AACAc,gBAAQkN,KAAR,GAAgB,SAAhB;AACAlN,2BAAgB,gBAAhB;AACAA,gBAAQ1B,EAAR,GAAa,UAAb;AACA2O,kBAAU5N,IAAV,CAAeW,OAAf;AACA;;AAED,aAAOiN,SAAP;AACA;;AA7BD;AAAA,KAnD4B;AAiF5B;AAAyB,oCAAU;AAClC,aAAOnQ,QAAQO,GAAR,CAAY,sBAAZ,CAAP;AACA;;AAFD;AAAA,KAjF4B;AAoF5B;AAAe,0BAAU;AACxB,UAAG,KAAKiB,EAAL,KAAY,UAAf,EAA0B;AACzB,eAAO,IAAP;AACA;AACD;;AAJD;AAAA,KApF4B;AAyF3B;AAAkB,8BAAU;AAC1B,aAAOxB,QAAQO,GAAR,CAAY,gBAAZ,CAAP;AACD;;AAFD;AAAA,KAzF2B;AA4F3B;AAAe,2BAAU;AACvB,aAAOmB,eAAP;AACD;;AAFD;AAAA;AA5F2B,CAA7B,2H;;;;;;;;;;;AC7EA7B,SAASwQ,UAAT,CAAoBtQ,SAApB,CAA8B,YAAU,CAEvC,CAFD;;AAIAF,SAASwQ,UAAT,CAAoBhP,MAApB,CAA2B,EAA3B;;AAIAxB,SAASwQ,UAAT,CAAoBnQ,OAApB,CAA4B;AAC3B;AAAgB,2BAAU;AACzBU,cAAQC,GAAR,CAAY,SAAZ;AACAuF,gBAAUkK,QAAV,GAAwBlK,UAAUmK,YAAV,IACHnK,UAAUoK,kBADP,IAEHpK,UAAUqK,eAFP,IAGHrK,UAAUsK,cAH/B;;AAKArQ,aAAOsQ,GAAP,GAAatQ,OAAOsQ,GAAP,IACCtQ,OAAOuQ,SADR,IAECvQ,OAAOwQ,MAFR,IAGCxQ,OAAOyQ,KAHrB;;AAKAlQ,cAAQC,GAAR,CAAYR,OAAOsQ,GAAnB;;AAEAvK,gBAAUkK,QAAV;AACG;AACA;AACIS,eAAO;AADX,OAFH;;AAMG;AACA,gBAASC,gBAAT,EAA2B;AACvB,YAAID,QAAQ3N,SAAS6N,aAAT,CAAuB,OAAvB,CAAZ;AACAF,cAAMG,GAAN,GAAY7Q,OAAOsQ,GAAP,CAAWQ,eAAX,CAA2BH,gBAA3B,CAAZ;;AAEC;;;;;;;;;;;;;AAaDpQ,gBAAQC,GAAR,CAAYuF,SAAZ;AACA;;;;;AAKH,OA9BJ;;AAgCG;AACA,gBAAS1F,GAAT,EAAc;AACZE,gBAAQC,GAAR,CAAY,8BAAZ;AACAD,gBAAQC,GAAR,CAAYH,GAAZ;AACD,OApCJ;AAuCA;;AArDD;AAAA;AAD2B,CAA5B,0H;;;;;;;;;;;ACRAb,SAASuR,aAAT,CAAuBrR,SAAvB,CAAiC,YAAW;AAC1C;AACA;AACAS,SAAOuC,SAAP,CAAiB,uBAAjB,EAA0CvC,OAAOW,IAAP,GAAcC,QAAxD;AACD,CAJD;;AAMAvB,SAASuR,aAAT,CAAuBlR,OAAvB,CAA+B;AAC7BuH;AAAa,2BAAW;AACtB,UAAIC,OAAO1H,QAAQO,GAAR,CAAY,aAAZ,CAAX;AACA,UAAGmH,OAAO,GAAV,EAAc;AACZ,eAAO,IAAP;AACD,OAFD,MAEO;AACL,eAAO,KAAP;AACD;AACF;;AAPD;AAAA,KAD6B;AAS7B2J;AAAiB,+BAAU;AACzBxJ,iBAAW7H,QAAQO,GAAR,CAAY,cAAZ,EAA4BiC,MAAvC;AACAqF,kBAAY7H,QAAQO,GAAR,CAAY,eAAZ,EAA6BiC,MAAzC;AACA,aAAOqF,QAAP;AACD;;AAJD;AAAA,KAT6B;AAc7B;AAA2B,uCAAW;AACpC,aAAO7H,QAAQO,GAAR,CAAY,gBAAZ,CAAP;AACD;;AAFD;AAAA;AAd6B,CAA/B;;AAmBAV,SAASuR,aAAT,CAAuB/P,MAAvB,CAA8B;;AAE5B;AAA4B,qCAAU;AACpC,UAAGwG,WAAW,CAAd,EAAgB;AACdxH,eAAOsD,QAAP,GAAkB,sBAAsBnD,OAAOW,IAAP,GAAcC,QAAtD;AACD;AACF;;AAJD;AAAA;;AAF4B,CAA9B,2H;;;;;;;;;;;ACzBAvB,SAASyR,mBAAT,CAA6BpR,OAA7B,CAAqC;AACnC;AAAsB,iCAAU;AAC9BqR,4BAAuBvR,QAAQO,GAAR,CAAY,cAAZ,CAAvB;AACA,UAAGgR,mBAAH,EAAuB;AACrBC,mCAA2BD,oBAAoB/O,MAA/C;AACA,YAAGgP,6BAA6B,CAAhC,EAAkC;AAChC,iBAAO,KAAP;AACD,SAFD,MAEO;AACL,iBAAO,IAAP;AACD;AACF;AACF;;AAVD;AAAA,KADmC;AAYnC;AAAuB,kCAAU;AAC/BC,4BAAuBzR,QAAQO,GAAR,CAAY,eAAZ,CAAvB;AACA,UAAGkR,mBAAH,EAAuB;AACrBC,mCAA2BD,oBAAoBjP,MAA/C;AACA,YAAGkP,6BAA6B,CAAhC,EAAkC;AAChC,iBAAO,KAAP;AACD,SAFD,MAEO;AACL,iBAAO,IAAP;AACD;AACF;AACF;;AAVD;AAAA,KAZmC;AAuBnC;AAAsB,iCAAU;AAC9B,UAAI5P,SAAS,EAAb;AACAyP,0BAAoBlK,OAApB,CAA4B,UAASC,IAAT,EAAc;AACxC1G,gBAAQC,GAAR,CAAYyG,IAAZ;AACA,YAAIqK,YAAYnL,UAAUoL,yBAAV,CAAoCtK,IAApC,CAAhB;AACA1G,gBAAQC,GAAR,CAAY8Q,SAAZ;AACA7P,eAAOS,IAAP,CAAYoP,SAAZ;AACD,OALD;AAMA/Q,cAAQC,GAAR,CAAYiB,MAAZ;;AAEA,aAAOA,MAAP;AACD;;AAXD;AAAA,KAvBmC;AAmCnC;AAAuB,kCAAU;AAC/B,UAAIA,SAAS,EAAb;AACA2P,0BAAoBpK,OAApB,CAA4B,UAASC,IAAT,EAAc;AACxC1G,gBAAQC,GAAR,CAAYyG,IAAZ;AACA,YAAIqK,YAAYnL,UAAUoL,yBAAV,CAAoCtK,IAApC,CAAhB;AACA1G,gBAAQC,GAAR,CAAY8Q,SAAZ;AACA7P,eAAOS,IAAP,CAAYoP,SAAZ;AACD,OALD;AAMA/Q,cAAQC,GAAR,CAAYiB,MAAZ;;AAEA,aAAOA,MAAP;AACD;;AAXD;AAAA;AAnCmC,CAArC;;AAiDAjC,SAASyR,mBAAT,CAA6BjQ,MAA7B,CAAoC;AAClC;AACA;AAAmB,4BAAW;AAC5B,UAAIwQ,eAAe,KAAKrO,GAAxB;AACA;AACA;;AAEA,UAAI0E,QAAQ,IAAI9F,MAAJ,EAAZ;;AAEA8F,YAAMrB,UAAN,GAAmB,KAAKsB,UAAxB,CAP4B,CAOQ;AACpCD,YAAMC,UAAN,GAAmB,KAAKtB,UAAxB,CAR4B,CAQQ;AACpCqB,YAAME,SAAN,GAAkB,IAAIC,IAAJ,EAAlB;AACAH,YAAM4J,sBAAN,GAA+BD,YAA/B;AACA3J,YAAMnB,WAAN,GAAoB,uBAApB;AACAmB,YAAM6J,aAAN,GAAsB,IAAtB;;AAEAvR,aAAOC,IAAP,CAAY,oCAAZ,EAAkDyH,KAAlD;;AAEAsJ;;AAEA;AACA,UAAI/D,SAAS,IAAIrL,MAAJ,EAAb;AACAqL,aAAOtM,IAAP,GAAc,KAAK0F,UAAnB;AACA4G,aAAOuE,UAAP,GAAoB,KAAK7J,UAAzB;AACA3H,aAAOC,IAAP,CAAY,8BAAZ,EAA4CgN,MAA5C;AACD;;AAvBD;AAAA,KAFkC;AA0BlC;AACA;AAAkB,2BAAU;AAC1B,UAAIoE,eAAe,KAAKrO,GAAxB;AACA;AACA;;AAEA,UAAI0E,QAAQ,IAAI9F,MAAJ,EAAZ;;AAEA8F,YAAMrB,UAAN,GAAmB7G,QAAQO,GAAR,CAAY,eAAZ,CAAnB,CAP0B,CAOuB;AACjD2H,YAAMC,UAAN,GAAmB3H,OAAOW,IAAP,GAAcC,QAAjC,CAR0B,CAQiB;AAC3C8G,YAAME,SAAN,GAAkB,IAAIC,IAAJ,EAAlB;AACAH,YAAM4J,sBAAN,GAA+BD,YAA/B;AACA3J,YAAMnB,WAAN,GAAoB,uBAApB;AACAmB,YAAM6J,aAAN,GAAsB,KAAtB;;AAEAvR,aAAOC,IAAP,CAAY,oCAAZ,EAAkDyH,KAAlD;;AAEAsJ;AAED;;AAlBD;AAAA,KA3BkC;AA8ClC;AACA;AACA;AACA;AAAe,wBAAU;;AAEvB,UAAIS,iBAAiB,KAAKzO,GAA1B;;AAEAmD,oBAAc8G,MAAd,CAAqBwE,cAArB,EAAqC,EAACvE,MAAM,EAAC5G,MAAM,IAAP,EAAP,EAArC;;AAEAlG,cAAQC,GAAR,CAAY,QAAZ;AACAD,cAAQC,GAAR,CAAY2Q,2BAA2B,GAA3B,GAAiCE,wBAA7C;;AAEA,UAAGF,6BAA6B,CAA7B,IAAkCE,6BAA6B,CAAlE,EAAoE;AAClErR,eAAOsD,QAAP,GAAkB,GAAlB;AACD;AAEF;;AAbD;AAAA,KAjDkC;AA+DlC;AAAsB,gCAAU;AAC9BtD,aAAOsD,QAAP,GAAkB,cAAc,KAAKwE,UAArC;AACAuJ;AACD;;AAHD;AAAA,KA/DkC;AAmElC;AAAqB,+BAAU;AAC7B,UAAIO,iBAAiB,KAAKzO,GAA1B;;AAEAkO;AACA/K,oBAAc8G,MAAd,CAAqBwE,cAArB,EAAqC,EAACvE,MAAM,EAAC5G,MAAM,IAAP,EAAP,EAArC;;AAEA1G,QAAE,MAAI,KAAK+H,UAAX,EAAuBrC,MAAvB;;AAEAlF,cAAQC,GAAR,CAAY2Q,2BAA2B,GAA3B,GAAiCE,wBAA7C;;AAEA,UAAGF,6BAA6B,CAA7B,IAAkCE,6BAA6B,CAAlE,EAAoE;AAClErR,eAAOsD,QAAP,GAAkB,GAAlB;AACD;AACF;;AAbD;AAAA;AAnEkC,CAApC,2H;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjDA,SAAS9D,QAAT,QAAyB,mBAAzB;AACA,SAASqS,WAAT,QAA4B,qBAA5B;;AAEA,OAAO,aAAP;;AAEA;AACA;AACA;AACA9R,EAAEgD,QAAF,EAAY+O,KAAZ,CAAkB,YAAU;AAC3B/R,GAAEgD,QAAF,EAAYgP,OAAZ,CAAoB,UAAS9Q,KAAT,EAAgB;AAChC,MAAIA,MAAM+Q,OAAN,IAAe,IAAf,KAAwB/Q,MAAMgR,KAAN,IAAe,IAAf,IAAuBhR,MAAMgR,KAAN,IAAe,KAAtC,IAA+ChR,MAAMgR,KAAN,IAAe,KAA9D,IAAuEhR,MAAMgR,KAAN,IAAe,KAAtF,IAAgGhR,MAAMgR,KAAN,IAAe,KAA/G,IAAyHhR,MAAMgR,KAAN,IAAe,KAAhK,CAAJ,EAA+K;AACjLhR,SAAMiO,cAAN;AACG;AACJ,EAJD;;AAMAnP,GAAEC,MAAF,EAAUkS,IAAV,CAAe,2BAAf,EAA4C,UAAUjR,KAAV,EAAiB;AACtD,MAAIA,MAAM+Q,OAAN,IAAiB,IAArB,EAA2B;AAC7B/Q,SAAMiO,cAAN;AACA;AACJ,EAJD;AAKA,CAZD;AAaA;AACA;AACA,4H;;;;;;;;;;;ACvBArD,SAAS,IAAI1L,OAAOgS,UAAX,CAAsB,QAAtB,CAAT;AACAC,gBAAgB,IAAIjS,OAAOgS,UAAX,CAAsB,eAAtB,CAAhB;AACAE,WAAW,IAAIlS,OAAOgS,UAAX,CAAsB,UAAtB,CAAX;AACAG,OAAO,IAAInS,OAAOgS,UAAX,CAAsB,MAAtB,CAAP;AACA7L,gBAAgB,IAAIiM,MAAMJ,UAAV,CAAqB,eAArB,CAAhB;AACAK,SAAS,IAAID,MAAMJ,UAAV,CAAqB,QAArB,CAAT;AACAM,WAAW,IAAIF,MAAMJ,UAAV,CAAqB,UAArB,CAAX;AACAO,QAAQ,IAAIH,MAAMJ,UAAV,CAAqB,OAArB,CAAR,sF;;;;;;;;;;;ACPAQ,OAAOC,SAAP,CAAiB;AACfC,kBAAiB,SADF;AAEfC,mBAAkB;AAFH,CAAjB;;AAKAH,OAAOI,KAAP,CAAa,GAAb,EAAkB;AACjBxR,OAAM,gBADW;AAEjBD;AAAM,kBAAU;AACf3B,WAAQC,GAAR,CAAY,eAAZ,EAA6B,GAA7B;AACA;;AAFD;AAAA;AAFiB,CAAlB;AAMA;AACA+S,OAAOI,KAAP,CAAa,cAAb,EAA6B,EAACxR,MAAM,aAAP,EAA7B;AACAoR,OAAOI,KAAP,CAAa,oBAAb,EAAmC;AAClCxR,OAAM,aAD4B;AAElCD;AAAM,kBAAU;AACf,OAAIR,OAAO,IAAIiB,MAAJ,EAAX;AACAjB,QAAKS,IAAL,GAAY,KAAKyR,MAAL,CAAYjS,QAAxB;;AAEA,OAAImL,cAAcvM,QAAQO,GAAR,CAAY,aAAZ,CAAlB;;AAEAC,UAAOC,IAAP,CAAY,cAAZ,EAA4BU,KAAKS,IAAjC,EAAuC,UAASlB,GAAT,EAAcC,GAAd,EAAmB;AACrDX,YAAQC,GAAR,CAAY,qBAAZ,EAAkCU,GAAlC;AACD,IAFJ;;AAIG2S,yBAAsBtT,QAAQO,GAAR,CAAY,qBAAZ,CAAtB;;AAEA,OAAG+S,mBAAH,EAAuB;AACtB,QAAGA,oBAAoBjR,eAApB,IAAuCkK,WAA1C,EAAsD;AACrDvM,aAAQC,GAAR,CAAY,sBAAZ,EAAoC,KAApC;AACA,KAFD,MAEO;AACND,aAAQC,GAAR,CAAY,sBAAZ,EAAoC,IAApC;AACA;AACD;;AAEDD,WAAQC,GAAR,CAAY,eAAZ,EAA6B,cAAc,KAAKoT,MAAL,CAAYjS,QAAvD;;AAEH,UAAOD,IAAP;AACA;;AAvBD;AAAA;AAFkC,CAAnC;AA2BA6R,OAAOI,KAAP,CAAa,0BAAb,EAAyC;AACxCxR,OAAM,cADkC;AAExCD;AAAM,kBAAU;AACf,OAAIR,OAAO,IAAIiB,MAAJ,EAAX;AACAjB,QAAKS,IAAL,GAAY,KAAKyR,MAAL,CAAYjE,QAAxB;AACApP,WAAQC,GAAR,CAAY,eAAZ,EAA6B,oBAAoB,KAAKoT,MAAL,CAAYjS,QAA7D;AACA,UAAOD,IAAP;AACA;;AALD;AAAA;AAFwC,CAAzC;;AAUA6R,OAAOI,KAAP,CAAa,4BAAb,EAA2C;AAC1CxR,OAAM,qBADoC;AAE1CD;AAAM,kBAAU;AACf,OAAIR,OAAO,IAAIiB,MAAJ,EAAX;AACAjB,QAAKS,IAAL,GAAY,KAAKyR,MAAL,CAAYjE,QAAxB;AACApP,WAAQC,GAAR,CAAY,eAAZ,EAA6B,sBAAsB,KAAKoT,MAAL,CAAYjS,QAA/D;AACA,UAAOD,IAAP;AACA;;AALD;AAAA;AAF0C,CAA3C;;AAUA;AACA;AACA6R,OAAOI,KAAP,CAAa,gBAAb,EAA+B;AAC9BxR,OAAM,kBADwB;AAE9BD;AAAM,kBAAU;AACf,OAAIkD,OAAO7E,QAAQO,GAAR,CAAY,qBAAZ,CAAX;AACA,OAAIgT,UAAU,IAAInR,MAAJ,EAAd;AACAmR,WAAQ/P,GAAR,GAAc,KAAK6P,MAAL,CAAY7P,GAA1B;;AAEA,OAAGqB,IAAH,EAAQ;AACP0O,YAAQ1O,IAAR,GAAeA,IAAf;AACA;;AAED7E,WAAQC,GAAR,CAAY,eAAZ,EAA6B,eAAe,KAAKoT,MAAL,CAAYjS,QAAxD;;AAEA,UAAOmS,OAAP;AACA;;AAZD;AAAA;AAF8B,CAA/B;AAgBAP,OAAOI,KAAP,CAAa,cAAb,EAA6B;AAC1BxR,OAAM,WADoB;AAE1BD;AAAM,kBAAW;AAChB,UAAO,KAAK0R,MAAZ;AACA;;AAFD;AAAA;AAF0B,CAA7B;;AAOAL,OAAOI,KAAP,CAAa,wBAAb,EAAuC;AACtCxR,OAAM,aADgC;AAEtCD;AAAM,kBAAU;AACf3B,WAAQC,GAAR,CAAY,eAAZ,EAA6B,kBAAkB,KAAKoT,MAAL,CAAYjS,QAA3D;AACA,UAAO,KAAKiS,MAAL,CAAYjE,QAAnB;AACA;;AAHD;AAAA;AAFsC,CAAvC;;AAQA4D,OAAOI,KAAP,CAAa,uBAAb,EAAsC;AACrCxR,OAAM,YAD+B;AAErCD;AAAM,kBAAU;AACf,OAAI6R,WAAW,IAAIpR,MAAJ,EAAf;AACAoR,YAASrS,IAAT,GAAgB,KAAKkS,MAAL,CAAYjE,QAA5B;AACAoE,YAAS3O,IAAT,GAAgB,IAAhB;AACA7E,WAAQC,GAAR,CAAY,eAAZ,EAA6B,iBAAiB,KAAKoT,MAAL,CAAYjS,QAA1D;AACA,UAAOoS,QAAP;AACA;;AAND;AAAA;AAFqC,CAAtC;;AAWAR,OAAOI,KAAP,CAAa,aAAb,EAA4B,EAACxR,MAAM,YAAP,EAA5B;;AAEAoR,OAAOI,KAAP,CAAa,SAAb,EAAwB;AACvBxR,OAAM;AADiB,CAAxB;;AAIAoR,OAAOI,KAAP,CAAa,yBAAb,EAAwC;AACvCxR,OAAM,YADiC;AAEvCD;AAAM,kBAAU;AACf,OAAIR,OAAO,IAAIiB,MAAJ,EAAX;AACAjB,QAAKS,IAAL,GAAY,KAAKyR,MAAL,CAAYjS,QAAxB;;AAEA,UAAOD,IAAP;AACA;;AALD;AAAA;AAFuC,CAAxC,4H;;;;;;;;;;;AC9GAqF,YAAY,qBAAW,CAAE,CAAzB,C,CAA8B;;AAE9BA,UAAU0G,UAAV,GAAuB,UAAS9L,QAAT,EAAmB;AACxC;;;;;AAKE,SAAO8K,OAAOtF,IAAP,CAAY,EAACzF,MAAMC,QAAP,EAAZ,EAA8B,EAAC+K,MAAM,EAAC/D,WAAW,CAAC,CAAb,EAAP,EAA9B,CAAP;AACH,CAPD;AAQA;AACA5B,UAAUiN,cAAV,GAA2B,UAASrS,QAAT,EAAmB;AAC5C,MAAIsS,oBAAoBjB,cAAc7L,IAAd,CAAmB,EAAE+M,UAAUvS,QAAZ,EAAnB,EAA2CwS,KAA3C,GAAmDC,GAAnD,CAAuD,UAASlS,IAAT,EAAe;AACpF,WAAOA,KAAKmS,SAAZ;AACD,GAFe,CAAxB;AAGA;AACA;;AAEA,SAAOJ,iBAAP;AACD,CARD;AASA;AACAlN,UAAUuN,aAAV,GAA0B,UAAS3S,QAAT,EAAmB;AAC3C,MAAI8O,mBAAmBuC,cAAc7L,IAAd,CAAmB,EAAEkN,WAAW1S,QAAb,EAAnB,EAA4CwS,KAA5C,GAAoDC,GAApD,CAAwD,UAASlS,IAAT,EAAe;AACpF,WAAOA,KAAKgS,QAAZ;AACD,GAFc,CAAvB;AAGA;AACA;;AAEA,SAAOzD,gBAAP;AACD,CARD;;AAUA1J,UAAUwN,iBAAV,GAA8B,UAAS5S,QAAT,EAAkB;AAC/C,SAAOuF,cAAcC,IAAd,CAAmB,EAACC,YAAYzF,QAAb,EAAuB0F,MAAM,KAA7B,EAAoCmN,YAAY,KAAhD,EAAnB,EAA2E,EAAC9H,MAAM,EAACoB,gBAAgB,CAAC,CAAlB,EAAP,EAA3E,CAAP;AACA,CAFD;;AAIA/G,UAAU0H,qBAAV,GAAkC,UAAS9M,QAAT,EAAmBkK,IAAnB,EAAwB;AACxD,SAAO3E,cAAcC,IAAd,CAAmB,EAACC,YAAYzF,QAAb,EAAuB0F,MAAM,KAA7B,EAAoCmN,YAAY,KAAhD,EAAuDlN,aAAauE,IAApE,EAAnB,EAA8F,EAACa,MAAM,EAACoB,gBAAgB,CAAC,CAAlB,EAAP,EAA9F,CAAP;AACD,CAFD;;AAIA/G,UAAU6F,mBAAV,GAAgC,UAASjL,QAAT,EAAkB;AAChD,SAAOuF,cAAc+F,OAAd,CAAsB,EAAC7F,YAAYzF,QAAb,EAAuB0F,MAAM,KAA7B,EAAoCmN,YAAY,KAAhD,EAAtB,EAA8E,EAAC9H,MAAM,EAACoB,gBAAgB,CAAC,CAAlB,EAAP,EAA9E,CAAP;AACD,CAFD;;AAIA/G,UAAUC,eAAV,GAA4B,UAASrF,QAAT,EAAkB;AAC5C,SAAOuF,cAAcC,IAAd,CAAmB,EAACC,YAAYzF,QAAb,EAAuB0F,MAAM,KAA7B,EAAoCmN,YAAY,KAAhD,EAAuDC,KAAM,CAAC,EAACnN,aAAc,OAAf,EAAD,EAA0B,EAACA,aAAc,KAAf,EAA1B,EAAiD,EAACA,aAAc,SAAf,EAAjD,CAA7D,EAAnB,EAA8JG,KAA9J,EAAP;AACD,CAFD;;AAIAV,UAAUoL,yBAAV,GAAsC,UAASuC,OAAT,EAAiB;AACrD,SAAOxN,cAAc+F,OAAd,CAAsB,EAAClJ,KAAK2Q,OAAN,EAAtB,CAAP;AACD,CAFD;;AAIA3N,UAAU4F,qBAAV,GAAkC,UAASmH,OAAT,EAAiB;AACjD,MAAIa,cAAclI,OAAOQ,OAAP,CAAe,EAAClJ,KAAK+P,OAAN,EAAf,EAA+Bc,MAAjD;AACA,SAAOD,WAAP;AACD,CAHD;;AAKA5N,UAAUoG,gBAAV,GAA6B,UAASpL,EAAT,EAAY;AACvC,SAAOmR,KAAKjG,OAAL,CAAa,EAAC6G,SAAU/R,EAAX,EAAb,CAAP;AACD,CAFD;;AAIAgF,UAAUqG,aAAV,GAA0B,UAASrL,EAAT,EAAagL,MAAb,EAAoB;AAC5C,MAAI8H,iBAAiB,KAArB;AACA;AACA,MAAIC,YAAY/N,UAAUoG,gBAAV,CAA2BpL,EAA3B,CAAhB;;AAEA,MAAG,CAAC+S,SAAJ,EAAc;AACZ;;AAED,GAHD,MAGO;AACL,QAAIzS,SAASyS,UAAUxH,YAAvB;AACA,QAAIyH,QAAQD,UAAU/Q,GAAtB;;AAEA1B,WAAOS,IAAP,CAAYiK,MAAZ;AACA,QAAI5B,MAAMpE,UAAU4F,qBAAV,CAAgC5K,EAAhC,CAAV;AACAoJ;;AAEA;AACAjK,UAAMgS,KAAKlF,MAAL,CAAY+G,KAAZ,EAAmB,EAAC9G,MAAM,EAACX,cAAcjL,MAAf,EAAP,EAAnB,CAAN;AACA2S,WAAOvI,OAAOuB,MAAP,CAAcjM,EAAd,EAAkB,EAACkM,MAAM,EAAC2G,QAAQzJ,GAAT,EAAP,EAAlB,CAAP;;AAEA;AACA,QAAGjK,OAAO8T,IAAV,EAAe;AACbH,uBAAiB,IAAjB;AACD;AACF;;AAED,SAAOA,cAAP;AACD,CA3BD;;AA6BA9N,UAAUwG,gBAAV,GAA6B,UAASxL,EAAT,EAAagL,MAAb,EAAoB;AAC/C,MAAI8H,iBAAiB,KAArB;AACA;AACA,MAAIC,YAAY/N,UAAUoG,gBAAV,CAA2BpL,EAA3B,CAAhB;AACA,MAAIM,SAASyS,UAAUxH,YAAvB;AACA,MAAIyH,QAAQD,UAAU/Q,GAAtB;;AAEA;AACA,MAAIkR,YAAY5S,OAAOZ,OAAP,CAAesL,MAAf,CAAhB;AACA;AACA,SAAO1K,OAAO4S,SAAP,CAAP;;AAEA,MAAI9J,MAAMpE,UAAU4F,qBAAV,CAAgC5K,EAAhC,CAAV;AACAoJ;;AAEA;AACAjK,QAAMgS,KAAKlF,MAAL,CAAY+G,KAAZ,EAAmB,EAAC9G,MAAM,EAACX,cAAcjL,MAAf,EAAP,EAAnB,CAAN;AACA2S,SAAOvI,OAAOuB,MAAP,CAAcjM,EAAd,EAAkB,EAACkM,MAAM,EAAC2G,QAAQzJ,GAAT,EAAP,EAAlB,CAAP;;AAEA;AACA,MAAGjK,OAAO8T,IAAV,EAAe;AACbH,qBAAiB,IAAjB;AACD;;AAED,SAAOA,cAAP;AACD,CAzBD;;AA2BA9N,UAAU4G,kBAAV,GAA+B,UAAS5L,EAAT,EAAY;AACzC,MAAI+J,UAAU5E,cAAc+F,OAAd,CAAsBlL,EAAtB,EAA0B+J,OAAxC;AACA,SAAOA,OAAP;AACD,CAHD;;AAKA/E,UAAUiF,cAAV,GAA2B,UAASkJ,OAAT,EAAiB;AAC1C,SAAOzI,OAAOQ,OAAP,CAAe,EAAClJ,KAAMmR,OAAP,EAAf,EAAgCnJ,UAAvC;AACD,CAFD;;AAIA;AACAhF,UAAU8F,oBAAV,GAAiC,UAASsI,SAAT,EAAoBxF,QAApB,EAA6B;AAC5D,MAAIyF,YAAJ,EAAkB;AAChB,QAAIA,aAAaC,UAAb,KAA4B,SAAhC,EAA2C;AACzCD,mBAAaE,iBAAb;AACD;AACD,QAAIC,QAAQ,YAAZ;AACA,QAAIC,YAAY,EAAhB;;AAEA,QAAGL,cAAc,KAAjB,EAAuB;AACrBK,kBAAY,gBAAgB7F,QAAhB,GAA2B,8BAAvC;AACD,KAFD,MAEO,IAAGwF,cAAc,SAAjB,EAA2B;AAChCK,kBAAY,gBAAgB7F,QAAhB,GAA2B,6BAAvC;AACD,KAFM,MAEA,IAAGwF,cAAc,OAAjB,EAAyB;AAC9BK,kBAAY,gBAAgB7F,QAAhB,GAA2B,gCAAvC;AACD,KAFM,MAEA,IAAGwF,cAAc,WAAjB,EAA6B;AAClCK,kBAAY,8BAAZ;AACD;;AAED,QAAIC,QAAQ,EAAEC,MAAMF,SAAR,EAAZ;;AAEA,QAAIG,OAAO,IAAIP,YAAJ,CAAiBG,KAAjB,EAAwBE,KAAxB,CAAX;;AAEAE,SAAKC,OAAL,GAAe,YAAU;AACvB;AACAhV,aAAOsD,QAAP,GAAkB,oBAAoBnD,OAAOW,IAAP,GAAcC,QAApD;AACD,KAHD;;AAKAgU,SAAKE,OAAL,GAAe;AACb;AADa,KAAf;;AAIAC,eAAY,YAAW;AAAEH,WAAKI,KAAL;AAAc,KAAvC,EAAyC,IAAzC;AACD;AACF,CAjCD;;AAmCAhP,UAAUoF,iBAAV,GAA8B,UAASL,OAAT,EAAiB;AAC7C,SAAOW,OAAOQ,OAAP,CAAe,EAAClJ,KAAM+H,OAAP,EAAf,EAAgCpK,IAAvC;AACD,CAFD,4H","file":"/app.js","sourcesContent":["Template.conversationsMenu.onCreated(function() {  \r\n  Session.set('showMessages', true);\r\n});\r\n\r\nTemplate.conversationsMenu.helpers({\r\n  'setStyleNavBar': function(){\r\n    var widthNav = $(window).width();\r\n    //RESTAMOS DOS PIXELES POR LOS BORDES\r\n    widthNav -= 2; \r\n    return widthNav/2 + \"px\";\r\n  },\r\n\r\n  'btnShowMessages': function(){\r\n    return Session.get('showMessages');\r\n  },\r\n\r\n  'showChatsForThisUser' : function(){\r\n    Meteor.call('findChatsAvailable', function(err, res){\r\n      console.log(res);\r\n      if(err){\r\n        console.log(err);\r\n      }\r\n    });\r\n    \r\n  },\r\n\r\n  'chatName' : function(nameChat){\r\n    var usersInChat = nameChat.split('_');\r\n    var chatUserName = usersInChat[usersInChat.indexOf(Meteor.user().username)];\r\n    return chatUserName;\r\n  }\r\n});\r\n\r\nTemplate.conversationsMenu.events({\r\n  'click #btnShowContacts' : function(){\r\n    Session.set('showMessages', false);\r\n  },\r\n  'click #btnShowMessages' : function(){\r\n    Session.set('showMessages', true);\r\n  },\r\n  'click .goToConversation' : function(event){\r\n    //COMPROBAMOS SI EL CHAT ESTA CREADO\r\n    Meteor.call('checkChat', event.currentTarget.id, function(err, res){\r\n      if(res){\r\n        Meteor.call('createChat', event.currentTarget.id);\r\n      }\r\n    });\r\n  }\r\n});","Template.editLicenses.onCreated(function(){\r\n\tcurrentUserName = this.data.name;\r\n  currDataUser = Session.get('dataUser');\r\n\r\n  arrAux = currDataUser.showWhatsTo;\r\n  var usersFound = new Array();\r\n  for(var i in arrAux){\r\n    Meteor.call('findUserDataWithId', arrAux[i], function(err, res) {\r\n      var aux = new Object();\r\n      aux.name = res.userNameProfile;\r\n      aux.userId = res.userId;\r\n      usersFound.push(aux);\r\n      Session.set('usersFound', usersFound);\r\n    });\r\n  };\r\n\r\n  if(arrAux.length > 0){\r\n    Session.set('countUsersFound', true);\r\n  } else {\r\n    Session.set('countUsersFound', false);\r\n  }\r\n});\r\n\r\nTemplate.editLicenses.events({  \r\n  'click #scrollSpy a': function(event){\r\n    selectUser = event.target.id;\r\n  },\r\n\r\n\t'click #remLicense': function(event) {  \r\n    var pos = arrAux.indexOf(selectUser);\r\n    arrAux.splice(pos,1);\r\n  \r\n    var data = new Object();\r\n    data.userId = currDataUser.userId;\r\n    data.showWhats = arrAux;\r\n\r\n    Session.set('usersFound', arrAux);\r\n    \r\n    if(arrAux.length > 0){\r\n      Session.set('countUsersFound', true);\r\n    } else {\r\n      Session.set('countUsersFound', false);\r\n    }\r\n\r\n    //POR ULTIMO ACTUALIZAMOS EL VALOR DE ESTE ARRAY EN LA BBDD\r\n    Meteor.call('updateShowWhatsTo', data);\r\n  }\r\n});\r\n\r\nTemplate.editLicenses.helpers({\r\n  'userWhatsCount': function(){\r\n    return Session.get('countUsersFound');\r\n  },\r\n\r\n  'responseLicenses' : function(){\r\n    return Session.get('usersFound');\r\n  },\r\n});","Template.editProfile.onCreated(function(){\r\n\tMeteor.subscribe('images');\r\n\tMeteor.call('findUserData', this.data, function(err, res) {\r\n\t\tSession.set('datauser',res);\r\n  \t});\r\n  \tcurrentDataUser = Session.get('datauser');\r\n});\r\n\r\nTemplate.editProfile.events({  \r\n\t'click #saveChanges': function(){\r\n\t\tuserAux = Session.get('datauser');\r\n\t\tnewData = new Object();\r\n\t\tnewData.description = document.getElementById(\"userDescription\").value;\r\n\t\tif(newData.description === \"\"){\r\n\t\t\tnewData.description = $('#userDescription').attr(\"placeholder\");\r\n\t\t}\r\n\t\tnewData.userId = userAux._id;\r\n\r\n\t\t//AHORA NOS GUARDAMOS EL _id DEL DOCUEMNTO QUE VAMSO A INSERTAR EN LA COLECCION Images\r\n\t\t//QUE ALMACENARÃ LA NUEVA FOTO\r\n\t\tvar codeImg = $('#imgCurrentUser').attr(\"src\");\r\n\r\n\t\tMeteor.call('insertNewImage', codeImg, function(err,res){\r\n\t\t\tnewData.imgId = res;\r\n\t\t\tconsole.log(newData.imgId);\r\n\t\t\tMeteor.call('updUserData', newData);\r\n\t\t\twindow.location = \"/Profile/\" + userAux.userNameProfile;\r\n\t\t});\r\n\r\n\t\t/*\r\n\t\t//REALIZAMOS LA PETICION AJAX PARA GUARDAR LA IMAGEN EN PUBLIC\r\n\t\t//RECUPERAMOS LA IMAGEN QUE HEMOS SUBIDO\r\n  \t\tvar file = $('#inputFile')[0].files[0];\r\n  \t\tvar readFile = new FileReader();\r\n  \t\treadFile.readAsDataURL(file);\r\n\r\n  \t\tconsole.log(readFile);\r\n\r\n\t\tvar ruta = \"img-ajax.php\";\r\n        $.ajax({\r\n            url: ruta,\r\n            type: \"POST\",\r\n            data: readFile,\r\n            contentType: false,\r\n            processData: false,\r\n            success: function(datos)\r\n            {\r\n                console.log(datos);\r\n            }\r\n        });\r\n        */\r\n  \t},\r\n  \t'change #inputFile': function(){\r\n\r\n  \t\t//RECUPERAMOS LA IMAGEN QUE HEMOS SUBIDO\r\n  \t\tvar file = $('#inputFile')[0].files[0];\r\n\r\n  \t\treader = new FileReader();\r\n  \t\treader.onload = (function(file){\r\n  \t\t\treturn function(e){\r\n  \t\t\t\t$('#imgCurrentUser').attr(\"src\", e.target.result);\r\n  \t\t\t}\r\n  \t\t})(file);\r\n\r\n  \t\treader.readAsDataURL(file);\t\r\n  \t}\r\n});\r\n\r\nTemplate.editProfile.helpers({\r\n\t'dataUserFound': function(){\r\n\t\tdataUser = Session.get('datauser');\r\n\t\treturn dataUser;\r\n\t},\r\n\t'userImgFound': function(){\r\n\t\tif(dataUser.userImg){\r\n\t\t\tMeteor.call('findUserImg', dataUser.userImg, function(err, res) {\r\n\t\t\t\t$('#imgCurrentUser').attr(\"src\", res);\r\n\t\t  \t});\r\n\t\t} else {\r\n\t\t\tconsole.log(\"Imagen test\");\r\n\t\t\t$('#imgCurrentUser').attr(\"src\", \"/profileImgTest.png\");\r\n\t\t}\r\n\t},\r\n\t'tweets': function(username){\r\n\t  \tMeteor.call('tweetsPublish', username, function(err, res) {\r\n\t    \tSession.set('numTweets',res);\r\n\t  \t});\r\n\t  \treturn Session.get('numTweets');\r\n\t},\r\n  \t'following': function(){\r\n\t\tMeteor.call('usersFollowings', function(err, res) {\r\n      \t\tSession.set('numFollowings',res);\r\n    \t});\r\n    \treturn Session.get('numFollowings');\r\n  \t},\r\n  \t'followers': function(){\r\n\t    Meteor.call('usersFollowers', function(err, res) {\r\n\t      \tSession.set('numFollowers',res);\r\n\t    });\r\n    \treturn Session.get('numFollowers');\r\n  \t},\r\n  \t'userHaveSN' : function(dataUserFound){\r\n\t    if((dataUserFound.userWhats) && (dataUserFound.userFb) && (dataUserFound.userInsta)){\r\n\t      return false;\r\n\t    } else {\r\n\t      return true;\r\n\t    }\r\n  \t},\r\n});","Template.followAnts.onCreated(function() {  \r\n  Session.set('notificationsModeOn', true);\r\n});\r\n\r\nTemplate.followAnts.helpers({\r\n  'setStyleNavBar': function(){\r\n    var widthNav = $(window).width();\r\n    //RESTAMOS DOS PIXELES POR LOS BORDES\r\n    widthNav -= 2; \r\n    return widthNav/2 + \"px\";\r\n  },\r\n\r\n  'getDataFollowAnts':function(){\r\n    Meteor.call('getFollowers', this.user, function(err, res) {\r\n      Session.set('followers',res);\r\n    });\r\n\r\n    Meteor.call('getFollowings', this.user, function(err, res) {\r\n      Session.set('followings',res);\r\n    });\r\n\r\n    foundFollowers = Session.get('followers');\r\n    foundFollowings = Session.get('followings');\r\n    if(foundFollowers){\r\n      if(foundFollowers.length === 0){\r\n        Session.set('noFollowers', true);\r\n      } else {\r\n        Session.set('noFollowers', false);\r\n      }\r\n    }\r\n          \r\n    if(foundFollowings){\r\n      if(foundFollowings.length === 0){\r\n        Session.set('noFollowings', true);\r\n      } else {\r\n        Session.set('noFollowings', false);\r\n      }\r\n    }\r\n\r\n    Session.set('showFollowers', this.mode);\r\n    countOrientationCard = 0;\r\n  },\r\n\r\n  'getWhatShow': function(){\r\n    return Session.get('showFollowers');\r\n  },\r\n\r\n  'noFollowers': function(){\r\n    return Session.get('noFollowers');\r\n  },\r\n\r\n  'noFollowings': function(){\r\n    return Session.get('noFollowings');\r\n  },\r\n\r\n  'btnShowFollowers': function(){\r\n    return Session.get('showFollowers');\r\n  },\r\n\r\n  'getProfileData': function(username){\r\n    listFoundFollower = [];\r\n    \r\n    Meteor.call('findUserData', username, function(err,response){\r\n      if(response){\r\n        imgFoundProf = \"\";\r\n        Meteor.call('findUserImg', response.userImg, function(err, res){\r\n          imgFoundProf = res;\r\n          response.imgFoundProf = imgFoundProf;\r\n          listFoundFollower.push(response);\r\n          Session.set('listFollAnts', listFoundFollower);\r\n        });\r\n      }\r\n    });\r\n    return Session.get('listFollAnts');\r\n  }, \r\n\r\n  'showFollowers': function(){\r\n    return foundFollowers;\r\n  },\r\n\r\n  'showFollowings': function(){\r\n    return foundFollowings;\r\n  },\r\n\r\n  'orientationCard': function(){\r\n    countOrientationCard++;\r\n    if(countOrientationCard % 2 === 0){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  },\r\n});\r\n\r\nTemplate.followAnts.events({\r\n  'click #btnShowFollowings' : function(){\r\n    Session.set('showFollowers', false);\r\n    countOrientationCard = 0;\r\n  },\r\n  'click #btnShowFollowers' : function(){\r\n    Session.set('showFollowers', true);\r\n    countOrientationCard = 0;\r\n  }\r\n});","var arrDataProfile = [];\r\nvar arrRecUsers = [];\r\n\r\nTemplate.followUsers.onRendered(function () { \r\n  (async function() {\r\n    recListUsers  = await Meteor.callPromise('recommendUsers');\r\n\r\n    for (var i = 0; i < recListUsers.length; i++) {\r\n      if(recListUsers[i].username != Session.get('currentUser')){\r\n        arrRecUsers.push(recListUsers[i]);\r\n      };\r\n    }\r\n\r\n    for (var i = 0; i < arrRecUsers.length; i++) {\r\n      dataUserFound = await Meteor.callPromise('findUserData', arrRecUsers[i].username);\r\n      arrDataProfile.push(dataUserFound);\r\n    }\r\n\r\n    //ELIMINAMOS NUESTRO PROPIO USUARIO\r\n    recListUsers.splice(0, 1);\r\n\r\n    if (recListUsers.length === 0) {\r\n      Session.set('numRecommendedUsers', false);\r\n    } else {\r\n      Session.set('numRecommendedUsers', true);\r\n    };\r\n\r\n    Session.set('recommendedUsers', recListUsers);\r\n    Session.set('userDataRecProfile', arrDataProfile);\r\n  }());\r\n});\r\n\r\nTemplate.followUsers.events({ \r\n  'click #searchBtn': function(event) {\r\n    var searchUser = $('#searchUser').val();\r\n    var foundUser = Meteor.call('findUser', searchUser, function(err, res) {\r\n        if (res) {\r\n          Meteor.call('findUserData', res.username, function(err,res){\r\n            if(res){\r\n              Session.set('foundUser', res);\r\n              Meteor.call('findUserImg', res.userImg, function(err, res){\r\n                Session.set('imgFound', res);  \r\n              });\r\n            }\r\n          });\r\n        } else {\r\n          $('#barFound').append(\"<h5 class='text-center msgErrorReg'>\"\r\n            + \"No se ha encontrado ningÃºn usuario</h5>\");\r\n        }\r\n    });\r\n    return false;\r\n  }, \r\n\r\n  'click #follow': function() {\r\n    //ANTES DE SEGUIR A DICHO USUARIO HAY QUE\r\n    //COMPROBAR SI YA LO ESTAMOS SIGUIENDO\r\n    Meteor.call('followUser', Session.get('foundUser').username);\r\n  },\r\n\r\n  'click #followRec': function() {\r\n    posUser = -1;\r\n    listRecomm = Session.get('recommendedUsers');\r\n\r\n    Meteor.call('followUser', this.userNameProfile);\r\n    //LOCALIZAMOS EL USUARIO QUE ACABAMOS DE SEGUIR Y\r\n    //LO ELIMINAMOS DE LA LISTA DE RECOMENDADOS\r\n    if(listRecomm){\r\n      for(i = 0; i < listRecomm.length; i++){\r\n        if(listRecomm[i].username === this.userNameProfile){\r\n          posUser = i;\r\n        }\r\n      };\r\n    };\r\n\r\n    if(posUser != -1){\r\n      listRecomm.splice(posUser, 1);\r\n    };\r\n\r\n    if (listRecomm.length === 0) {\r\n      Session.set('numRecommendedUsers', false);\r\n    } else {\r\n      Session.set('numRecommendedUsers', true);\r\n    };\r\n\r\n    Session.set('recommendedUsers', listRecomm);\r\n    Session.set('userDataRecProfile', listRecomm);\r\n  },\r\n\r\n  'change #searchUser': function(){\r\n    if($('#searchUser').val().length === 0){\r\n      Session.set('foundUser', '');\r\n      $('.msgErrorReg').remove();\r\n    };\r\n  }\r\n\r\n});\r\n\r\nTemplate.followUsers.helpers({ \r\n  'foundUser': function() {\r\n    return Session.get('foundUser');\r\n  },\r\n\r\n  'recommendedUsers': function() {\r\n    return Session.get('userDataRecProfile');\r\n  },\r\n\r\n  'recUsersLis': function(){\r\n    return Session.get('numRecommendedUsers');\r\n  },\r\n  'mineUser' : function(user){\r\n    if(user === Session.get('currentUser')){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  },\r\n\r\n  'getImgProfile' : function(imgId){\r\n    var imgFound = \"imgPath\";\r\n    var imgFoundSession = Session.get('imgFound');\r\n    //console.log(imgId);\r\n\r\n    if(imgId === ''){\r\n      return \"/profileImgTest.png\";\r\n    } else if(imgFoundSession){\r\n      return imgFoundSession;\r\n    } else {\r\n      Meteor.call('findUserImg', imgId, function(err, res){\r\n        Session.set('imgFound', res);\r\n      });\r\n      return Session.get('imgFound');;\r\n    }\r\n  }\r\n});","Template.mainPage.onCreated(function(){\r\n\tSession.set('pathActualApp', window.location.pathname);\r\n});\r\n\r\nTemplate.mainPage.helpers({\r\n\t'mainPage': function(){\r\n\t\tif(Session.get('pathActualApp') === \"/\"){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n})","Template.navBarTemplate.onCreated( function() {\r\n\tSession.set('sizeDisplay', $(window).width());\r\n\tSession.set('navBarCollapse', false);\r\n\tSession.set('currentUser', Meteor.user().username);\r\n\r\n\t//PEDIMOS PERMISO AL USUARIO PARA MOSTRARLE NOTIFICACIONES\r\n\tconsole.log(navigator.platform);\r\n\r\n\t/*\r\n\tHAY QUE CONTROLAR ESTO PORQUE NO FUNCIONA EL NOTIFICATION EN IPHONE\r\n\tif(navigator.platform != 'iPad' || navigator.platform != 'iPhone' || navigator.platform != 'iPod'){\r\n\t\tNotification.requestPermission();\r\n\t}\r\n\t*/\r\n\r\n});\r\n\r\nTemplate.navBarTemplate.events({\r\n\t'click #recommendationsBtn' : function(){\r\n\t\t//Contraer el dropDownMenu \r\n\t\t$('#btnMenuNavBar').click();\r\n\t\tSession.set('pathActualApp', '/whoToFollow');\r\n\t},\r\n\t'show.bs.collapse' : function(){\r\n\t\tSession.set('navBarCollapse', true);\r\n\t},\r\n\t'hide.bs.collapse' : function(){\r\n\t\tSession.set('navBarCollapse', false);\r\n\t},\r\n\t'click #btnNewTweet' : function(){\r\n\t    Session.set('commentMode', false);\r\n  \t},\r\n  \t'click #btnNewTwiit' : function(){\r\n\t    Session.set('commentMode', false);\r\n  \t},/*\r\n  \t'click #videoTrans' : function(){\r\n  \t\tconsole.log(Session.get('currentUser'));\r\n  \t\tif(Session.get('currentUser') === \"nachosizle\"){\r\n  \t\t\twindow.location = \"/videoTrans\";\r\n  \t\t}\r\n  \t},*/\r\n  \t'click .imgProfileNavBar': function(){\r\n  \t\t$('#btnMenuNavBar').click();\r\n  \t\tSession.set('pathActualApp', '/Profile/' + Meteor.user().username);\r\n  \t},\r\n  \t'click #btnShowConver': function(){\r\n  \t\t$('#btnMenuNavBar').click();\r\n  \t\tSession.set('pathActualApp', '/Conversations/' + Meteor.user().username);\r\n  \t}\r\n});\r\n\r\nTemplate.navBarTemplate.helpers({\r\n\t'notificationCount': function() {\r\n\t    var resultNotif = UserUtils.findNumberNotif(Meteor.user().username);\r\n\t    return resultNotif;\r\n\t},\r\n\t'whatsNotifCount' : function(){\r\n\t\t//OBTENEMOS EL NUMERO DE NOTIFICACIONES DE LAS PETICIONES DE WHATSAPP Y LAS \r\n\t\t//RESPUESTAS A LAS PETICIONES REALIZADAS POR EL USUARIO\r\n\t\tresultNotifRequest = Notifications.find({recepNotif: Meteor.user().username, read: false, typeOfNotif: \"whatsAppNotif\"});\r\n\t\tresultNotifResponse = Notifications.find({recepNotif: Meteor.user().username, read: false, typeOfNotif: \"responseWhatsAppNotif\"});\r\n\t\tauxTotalCount = 0;\r\n\r\n\t\tif(resultNotifRequest.count() > 0){\r\n\t\t\tauxTotalCount = resultNotifRequest.count();\r\n\t\t\tif(resultNotifResponse.count() > 0){\r\n\t\t\t\tauxTotalCount += resultNotifResponse.count();\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tif(resultNotifResponse.count() > 0){\r\n\t\t\t\tauxTotalCount = resultNotifResponse.count();\r\n\t\t\t};\r\n\t\t}\r\n\t\t//NO SE ESTA OBTENIENDO CORRECTAMENTE ESTE TIPO DE NOTIF\r\n\t\t//REVISAR publications.js\r\n\t\t//console.log(resultNotifResponse);\r\n\t\t//console.log(resultNotifResponse.count());\r\n\r\n\t\t//DEVOLVEMOS LA SUMA TOTAL DE LAS NOTIFICACIONES\r\n\t\tif(auxTotalCount > 0){\r\n\t\t\treturn auxTotalCount;\r\n\t\t}\r\n\t},\r\n\t'whatsAppReq' : function(){\r\n\t    var cont = 0;\r\n\t    var req = [];\r\n\t    var res = [];\r\n\r\n\t    resultNotifRequest.forEach(function(item){\r\n\t       req.push(item._id);\r\n\t       cont++;\r\n\t    });\r\n\r\n\t    resultNotifResponse.forEach(function(item){\r\n\t       res.push(item._id);\r\n\t       cont++;\r\n\t    }); \r\n\r\n\t    if(cont > 0){      \r\n\t      Session.set('whatsAppRequest', true);\r\n\t      Session.set('requestWhats', req);\r\n\t      Session.set('responseWhats', res);\r\n\t      return true;\r\n\t    } else {\r\n\t    \tSession.set('whatsAppRequest', false);\r\n\t    \treturn false;\r\n\t    }\r\n\t},\r\n\t'infoStateCollapseNavBar': function() {\r\n\t  return Session.get('navBarCollapse');\r\n\t},\r\n\t'userImgFound': function(){\r\n\t\tMeteor.call('findUserData', Meteor.user().username, function(err, res) {\r\n\t\t\tif(res.userImg){\r\n\t\t\t\tMeteor.call('findUserImg', res.userImg, function(err, res) {\r\n\t\t\t\t\t$('#imgProfile').attr(\"src\", res);\t\r\n\t\t\t  \t});\r\n\t\t\t} else {\r\n\t\t\t\t$('#imgProfile').attr(\"src\", \"/profileImgTest.png\");\r\n\t\t\t}\r\n\t\t\t\r\n\t  \t});\r\n\t},\r\n\t'currentUser': function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = Session.get('currentUser');\r\n\t\treturn user;\r\n\t}\r\n});\r\n//PARA CONTROLAR SI SE CAMBIA EL TAMAÃ‘O DE PANTALLA\r\n$(window).resize(function(){\r\n\tconsole.log(\"Change Display Size\");\r\n\tSession.set('sizeDisplay', $(window).width());\r\n});\r\n","Template.notifications.onCreated(function() { \r\n  //console.log(\"Usuario: \"); \r\n  //console.log(Meteor.user().username);\r\n  Meteor.subscribe('notifications', Meteor.user().username);\r\n});\r\n\r\nTemplate.notifications.helpers({\r\n  modeDisplay: function() {\r\n    var size = Session.get('sizeDisplay');\r\n    if(size > 768){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  notifications: function() {\r\n    return Notifications.find({recepNotif: Meteor.user().username, read: false});\r\n  },\r\n  notificationCount: function(){\r\n    /*\r\n    var followings = UserUtils.findFollowings(Meteor.user().username);\r\n    return Notifications.find({twiitNotifUserName: { $nin: followings }, read: false}).count();\r\n    */\r\n    return UserUtils.findNumberNotif(Meteor.user().username);\r\n  },\r\n  'infoStateCollapseNavBar': function() {\r\n    return Session.get('navBarCollapse');\r\n  }\r\n});\r\n\r\n/*\r\nTemplate.notificationItem.helpers({\r\n  notificationTwiitPath: function() {\r\n    var path = this.twiitId;\r\n    console.log(path);\r\n    return path;\r\n  }\r\n});\r\n\r\n\r\nTemplate.notificationItem.events({\r\n  'click a': function() {\r\n    Notifications.update(this._id, {$set: {read: true}});\r\n  }\r\n});\r\n*/","Template.notificationsNew.onCreated(function() { \r\n  //console.log(\"Usuario: \"); \r\n  //console.log(Meteor.user().username);\r\n  Meteor.subscribe('notifications', Meteor.user().username);\r\n});\r\n\r\nTemplate.notificationsNew.helpers({\r\n  modeDisplay: function() {\r\n    var size = Session.get('sizeDisplay');\r\n    if(size > 768){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  notifications: function() {\r\n    //followings = UserUtils.findFollowings(Meteor.user().username);\r\n    console.log(Meteor.user().username);\r\n    return Notifications.find({recepNotif: Meteor.user().username, read: false});\r\n  },\r\n  notificationCount: function(){\r\n    /*\r\n    var followings = UserUtils.findFollowings(Meteor.user().username);\r\n    return Notifications.find({twiitNotifUserName: { $nin: followings }, read: false}).count();\r\n    */\r\n    numNotif = UserUtils.findNumberNotif(Meteor.user().username);\r\n\r\n    return numNotif;\r\n  },\r\n  'infoStateCollapseNavBar': function() {\r\n    return Session.get('navBarCollapse');\r\n  },\r\n  'currentUser': function(){\r\n    return Meteor.user().username;\r\n  }\r\n});\r\n\r\nTemplate.notificationsNew.events({\r\n  \r\n  'click #linkToNotif' : function(){\r\n    if(numNotif > 0){\r\n\r\n      window.location = \"/Notifications/\" + Meteor.user().username;\r\n    }\r\n  }\r\n  \r\n});","Template.removeProfile.events({  \r\n\t'click #remove': function() { \r\n    var userToRemove = new Object();\r\n    var aux = Session.get('dataUser');\r\n\r\n    userToRemove.id = aux.userId;\r\n    userToRemove.name = aux.userNameProfile;\r\n\r\n    console.log(userToRemove);\r\n\r\n    Meteor.call('removeThisUser', userToRemove);\r\n\r\n    window.location = \"/\";\r\n\t},\r\n  'click #noRemove': function(){\r\n    //HAY QUE DECIRLE AL MODAL QUE SE CIERRE\r\n    $('#dialog-removeProfile').modal('hide');\r\n  }\r\n});","Template.sendRequest.onRendered(function(){\r\n\r\n});\r\n\r\nTemplate.sendRequest.events({\r\n  \t'click #sent': function(){\r\n\r\n  \t\tvar notif = new Object();\r\n  \t\t\r\n  \t\tnotif.recepNotif = Session.get('userToSentPet'); //EL USUARIO QUE VA A RECIBIR LA PETICION\r\n  \t\tnotif.actorNotif = Meteor.user().username; //EL USUARIO QUE REALIZA LA PETICION\r\n  \t\tnotif.timestamp = new Date();\r\n  \t\tnotif.typeOfNotif = \"whatsAppNotif\";\r\n\r\n  \t\tMeteor.call('createWhatsAppNotification', notif);\r\n  \t\t$('#dialog-showSocialNetwork').modal('hide');\r\n  \t\t//POR ULTIMO INFORMAMOS AL USUARIO QUE LA PETICION SE HA ENVIADO\r\n\r\n  \t\t$('#dialog-operationSuccess').modal('show');\r\n  \t}, \r\n  \t'click #noSent': function(){\r\n  \t\t$('#dialog-showSocialNetwork').modal('hide');\r\n  \t}\r\n});\r\n\r\nTemplate.sendRequest.helpers({\r\n  \t'userNameToSentPet': function(){\r\n    \treturn Session.get('userToSentPet');\r\n  \t}\r\n});  ","Template.showConver.onCreated(function() {  \r\n  Meteor.subscribe('chats');\r\n  Session.set('messageInputEmpty', true);\r\n  Session.set('recepUsernameChat', this.data.name);\r\n});\r\n\r\nTemplate.showConver.helpers({\r\n  'messagesInChat' : function(){\r\n    recoverChat();\r\n    return Session.get('chatFound');\r\n  },\r\n\r\n  'btnDisabled' : function() {\r\n    return Session.get('messageInputEmpty');\r\n  },\r\n\r\n  'recepUserChat' : function(){\r\n    var user = new Object();\r\n    user.name = Session.get('recepUsernameChat');\r\n    return user;\r\n  },\r\n\r\n  'messageIsMine' : function(isMine){\r\n    if(isMine === Session.get('currentUser')){\r\n      return \"messageIsMine\";\r\n    } else {\r\n      return \"messageNotMine\";\r\n    }\r\n  },\r\n\r\n  'convertDateTime': function(dateToConvert) {\r\n    var dateNew = new Date(dateToConvert);\r\n    var dateCon = dateNew.toLocaleString();\r\n\r\n    var elem = dateCon.split(' ');\r\n\r\n    return elem[0];\r\n  },\r\n});\r\n\r\nTemplate.showConver.events({\r\n  'click #btnSendMessage' : function(){\r\n    var chatData = new Object();\r\n    var contentMessage = $('#inputMessage').val();\r\n    var userRecepMsg = Session.get('recepUsernameChat');\r\n\r\n    chatData.contentMessage = contentMessage;\r\n    chatData.userRecepMsg = userRecepMsg;\r\n    if(Session.get('chatEmpty')){\r\n      Meteor.call('insertMsgChat', chatData);\r\n    } else {\r\n      chatData.nameChat = Session.get('nameChat');\r\n      Meteor.call('insertMsg', chatData);\r\n    }\r\n    //HAY QUE MANDAR UNA NOTIFICACIÃ“N AL OTRO USUARIO PARA QUE SE ENTERE DE \r\n    //QUE LE HEMOS ESCRITO UN MENSAJE\r\n    \r\n    //INSERTAR UN NUEVO MENSAJE PARA PRODUCIR EL EFECTO DE QUE SE HA ENVIADO\r\n    recoverChat();\r\n    //LIMPIAMOS EL TEXTO QUE HEMOS PUESTO EN EL #inputMessage\r\n    $('#inputMessage').val(\"\");\r\n  },\r\n\r\n  'input #inputMessage' : function(){\r\n    var lengthMessage = $('#inputMessage').val().length;\r\n    if(lengthMessage > 0){\r\n      Session.set('messageInputEmpty', false);\r\n    } else if(lengthMessage === 0){\r\n      Session.set('messageInputEmpty', true);\r\n    }\r\n  },\r\n\r\n  'click #cleanHistory' : function(){\r\n    Meteor.call('removeChat', Session.get('recepUsernameChat'));\r\n  }\r\n});\r\n\r\nfunction recoverChat(){\r\n  var userNameToFindChat = Session.get('recepUsernameChat');\r\n\r\n  Meteor.call('findChatFromUser', userNameToFindChat, function(err, res){\r\n    if(res){\r\n      Session.set('chatFound', res);\r\n      if(res.length === 0){\r\n        Session.set('chatEmpty', true);\r\n      } else {\r\n        Session.set('nameChat', res[0].nameChat);\r\n        Session.set('chatEmpty', false);\r\n      }\r\n    } \r\n\r\n    if(err){\r\n      console.log(err);\r\n    }\r\n  });\r\n}","Template.showSocialNetwork.onRendered(function(){\r\n\r\n});\r\n\r\nTemplate.showSocialNetwork.events({\r\n  \t'click #sent': function(){\r\n\r\n  \t}, \r\n  \t'click #noSent': function(){\r\n  \t\t\r\n  \t}\r\n});\r\n\r\nTemplate.showSocialNetwork.helpers({\r\n  \t'userNameToSentPet': function(){\r\n    \treturn Session.get('userToSentPet');\r\n  \t},\r\n  \t'showProfileOtherUser' : function(){\r\n\t\treturn Session.get('showProfileOtherUser');\r\n\t}\r\n});   \r\n\r\n\r\n//EN EL MODAL EMERGENTE QUE MSTRARÃ LA INFORMACION AÃ‘ADIDA DEL USUARIO SOBRE SU RED SOCIAL\r\n//SE IMPLEMENTARA QUE PINCHE EN EL NOMBRE DE USUARIO Y QUE SE REDIRIJA LA PAGINA A LA \r\n//PAGINA DE PERFIL DE USUARIO QUE CORRESPONDA\r\n\r\n//EN INSTAGRAM SE REDIRIGIRÃ A: https://www.instagram.com/{{currentUser.userInsta}}/\r\n//EN FACEBOOK SE REDIRIGIRÃ A: https://www.facebook.com/search/all/?q={{currentUser.userFb}}\r\n\r\n//EL CASO DE WHATSAPP ES MAS DIFERENTE. LO QUE HAREMOS SERÃ SOLICITAR AL USUARIO QUE SI QUIERE\r\n//AÃ‘ADIR EL NUMERO DE TELEFONO EN SU AGENDA (SOLO PARA DISPOSITIVOS MÃ“VILES)","Template.socialNetworkBox.onRendered(function(){\r\n  selectOptions = Session.get('optionsAva');\r\n  currentDataUser = Session.get('datauser');\r\n  Session.set('inputNotEmpty', true);\r\n  Session.set('removeDataSN', false);\r\n  $('[data-toggle=\"tooltip\"]').tooltip();\r\n});\r\n\r\nTemplate.socialNetworkBox.events({\r\n  \t'click #btnNewSN': function(){\r\n  \t\tvar numSocialNetworks = Session.get('countSocialNetworks');\r\n\r\n  \t\tif(numSocialNetworks < 3){\r\n\r\n        var avaSelecOptions = \"\";\r\n        var selectOptionsArray = Session.get('optionsAva');\r\n\r\n        for (var i = 0; i < selectOptionsArray.length; i++) {\r\n          avaSelecOptions += \"<li><a href='#'>\" + selectOptionsArray[i] + \"</a></li>\";\r\n        }\r\n  \t\t\t\r\n  \t\t\t$('#containerInputs').append(\"<div class='input-group' id='inputGroup\" + numSocialNetworks + \"' style='margin-bottom: 10px;'>\"\r\n  \t\t\t\t+ \"<div class='input-group-btn'>\"\r\n  \t\t\t\t+ \"<button id='\" + numSocialNetworks + \"' type='button' class='btn btn-default dropdown-toggle btnDropDown btnOptionsSN' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>Choose\"\r\n  \t\t\t\t+ \"<span class='caret'></span>\"\r\n  \t\t\t\t+ \"</button>\"\r\n  \t\t\t\t+ \"<ul id='dropdownMenu\" + numSocialNetworks + \"' class='dropdown-menu'>\"\r\n  \t\t\t\t+ avaSelecOptions\r\n  \t\t\t\t+ \"</ul>\"\r\n  \t\t\t\t+ \"</div>\"\r\n  \t\t\t\t+ \"<input required id='input\" + numSocialNetworks + \"' type='text' class='form-control inputSN inputNewSN' aria-label='...' placeholder='Username...'>\"\r\n  \t\t\t\t+ \"<button id='clearDataUser\" + numSocialNetworks + \"' type='button' class='btn btn-danger' aria-haspopup='true' aria-expanded='false'>\"\r\n          + \"<span id='\" + numSocialNetworks + \"' class='glyphicon glyphicon-remove'></span>\"\r\n          + \"</button>\"\r\n          + \"</div>\");\r\n  \t\t  numSocialNetworks++;\r\n        Session.set('countSocialNetworks', numSocialNetworks);\r\n      };\r\n\r\n      if(numSocialNetworks === 3){\r\n        $('#btnNewSN').hide();\r\n        Session.set('removeDataSN', false);\r\n      };\r\n  \t},\r\n  \t'click .btnDropDown': function(event){\r\n  \t\tSession.set('btnTap', event.target.id);\r\n  \t},\r\n  \t'click .dropdown-menu li a': function(event){\r\n  \t\tvar btnTap = Session.get('btnTap');\r\n  \t\tvar selectOption = event.target.text;\r\n      //AÃ‘ADIR A UN ARRAY LAS SELECCIONES QUE HACEMOS PARA QUE NO SE PUEDAN REPETIR.\r\n      //ES DECIR, UN USUARIO SOLO VA A PODER ENLAZAR 1 CUENTA DE FACEBOOK, INSTAGRAM \r\n      //O WHATSAPP.\r\n      var arrOptions = Session.get('optionsAva');\r\n\r\n      var numSele = arrOptions.indexOf(selectOption);\r\n      if(numSele >= 0){\r\n        arrOptions.splice(numSele, 1);\r\n      } \r\n\r\n      //VAMOS A COMPROBAR QUE SI selectOption ES WHATSAPP LE VAMOS A PONER AL INPUT UN FORMATO PARA QUE \r\n      //EL USUARIO SOLO PUEDA INTRODUCIR NUMEROS\r\n      if(selectOption === \"WhatsApp\"){\r\n        $('#input' + btnTap).attr(\"type\", \"number\");\r\n      }\r\n\r\n      //UNA VEZ SELECCIONADO LA OPCION DEL DROPDOWN, TRANSFORMAMOS EL DROPDOWN A UN BTN DESHABILITADO\r\n      $('#'+ btnTap).html(selectOption);\r\n\r\n      $('#dropdownMenu'+ btnTap).remove();\r\n\r\n      Session.set('optionsAva', arrOptions);\r\n  \t},\r\n    'click .btn-danger': function(event){\r\n\r\n      //GUARDAMOS EL ID (numero entre 0 y 2) PARA DESPUES IDENTIFICAR EL INPUT-GROUP Y ASI ELIMINAR LOS DATOS DE MONGODB\r\n      var selectOption = event.target.id;\r\n      //AHORA BUSCAMOS EL CAMPO A ELIMINAR Y LLAMAMOS AL METODO DE userData.js\r\n      var btnToRem = $('#' + selectOption).text();\r\n      var newData = new Object();\r\n\r\n      if(btnToRem != 'Choose'){\r\n        newData.userId = Session.get('datauser')._id;\r\n        newData.propertyToRem = btnToRem;\r\n\r\n        Meteor.call('removeDataSocialNetworks', newData);\r\n      };\r\n      \r\n      //POR ULTIMO VAMOS A INFORMAR AL USUARIO QUE SE HA ELIMINADO LA RED SOCIAL\r\n      //PARA ELLO, VAMOS A ELIMINAR EL inputGroup DE LA SN QUE SE HA ELIMINADO\r\n      $('#inputGroup' + selectOption).remove();\r\n      Session.set('removeDataSN', true);\r\n\r\n      //ACTUALIZAMOS EL VALOR DE optionsAva EN Session.keys\r\n      var auxOptions = Session.get('optionsAva');\r\n\r\n      if(btnToRem != \"Choose\"){\r\n        if(auxOptions.indexOf(newData.propertyToRem) === -1){\r\n          auxOptions.push(newData.propertyToRem);\r\n          Session.set('optionsAva', auxOptions);\r\n        };\r\n      };\r\n\r\n      //ACTUALIZAMOS EL VALOR DE countSocialNetworks EN Session.keys\r\n      var auxCount = Session.get('countSocialNetworks');\r\n      auxCount--;\r\n      Session.set('countSocialNetworks', auxCount);\r\n\r\n      //CUANDO SE BORRA UN INPUTGROUP HAY QUE REESTABLECER LOS ID PARA QUE EMPIECEN POR 0 HASTA 2\r\n\r\n      for (var i = 0; i < auxCount; i++) {\r\n        $('.input-group').attr('id', 'inputGroup' + i);\r\n\r\n        $('.btnOptionsSN').attr('id', i);\r\n\r\n        $('.dropdown-menu').attr('id', 'dropdownMenu' + i);\r\n\r\n        $('.inputSN').attr('id', 'input' + i);\r\n\r\n        $('.glyphicon-remove').attr('id', i);\r\n\r\n        $('.btn-danger').attr('id', 'clearDataUser' +  i);\r\n      }\r\n\r\n      if(auxCount < 3){\r\n        Session.set('modeToAdd', true);\r\n        $('#btnNewSN').show();\r\n      }\r\n    },\r\n  \t'click #saveData': function(){\r\n  \t\t//DE ESTA MANERA OBTENEMOS TODOS LOS BLOQUES QUE HEMOS AÃ‘ADIDO DINÃMICAMENTE\r\n  \t\t//HAY QUE OBTENER TODOS LOS VALORES SELECCIONADOS EN CADA DROPDOWN Y EL CONTENIDO DE SUS RESPECTIVOS INPUT\r\n  \t\t//TODO\r\n      var valuesInput = [];\r\n  \t\tvar valuesButton = [];\r\n      var foundInputNewSN = false;\r\n\r\n      //PARA CADA CASO HAY QUE COMPROBAR QUE LOS INPUT QUE TIENEN, ESTAN RELLENADOS. EN EL CASO DE LAS REDES QUE \r\n      //YA EXISTEN EN MNONGODB, SE COGERÃ SU PLACEHOLDER.\r\n      if(Session.get('modeToAdd') === true){\r\n        //ESTE ES EL CASO QUE SE DA CUANDO SE HA INTRODUCIDO UNA NUEVA RED SOCIAL PARA ANIADIRLA A MONGODB\r\n        //ESTE CASO SALTA CUANDO SE HA DADO AL BOTON DE addNewSN\r\n\r\n        //RECORREMOS LOS INPUT QUE VIENEN DIRECTAMENTE DE MONGODB\r\n        $('.inputSN').each(function() {\r\n          if($(this).val() != \"\"){\r\n            valuesInput.push($(this).val());\r\n          }\r\n        });\r\n\r\n\r\n        //RECORREMOS LOS INPUT CREADOS CON EL BTN addNewSN\r\n        $('.inputNewSN').each(function(){\r\n          if($(this).val() != \"\"){\r\n            valuesInput.push($(this).val());\r\n            Session.set('inputNotEmpty', true);\r\n          } else {\r\n            Session.set('inputNotEmpty', false);\r\n          }\r\n          foundInputNewSN = true;\r\n        });\r\n\r\n\r\n        if(valuesInput.length === 0){\r\n          //SI SE HA AÃ‘ADIDO UN INPUT EN EL QUE NO SE HA INTRODUCIDO NADA, \r\n          //HAY QUE AVISAR AL USUARIO DE QUE TIENE QUE INTRODUCIR UN VALOR\r\n          $('.inputSN').each(function() {\r\n            if($(this).val() === \"\"){\r\n              console.log(\"NO hay val\");\r\n              $(this).addClass(\"fieldEmpty\");\r\n              $('.msgFieldEmpty').attr(\"hidden\", false);\r\n            };\r\n          });\r\n        }\r\n\r\n        if(foundInputNewSN){\r\n          valuesInput.splice(valuesInput.length - 1, 1);\r\n          foundInputNewSN = false;\r\n        }\r\n\r\n      } else {\r\n        //ESTE CASO SE PRODUCE CUANDO LAS REDES QUE SE MUESTRAN AL USUARIO SON TODAS YA EXISTENTES EN MONGODB\r\n        //POR TANTO, SOLO RECORREMOS LOS INPUT QUE VIENEN DIRECTAMENTE DE MONGODB\r\n        $('.inputSN').each(function() {\r\n          if($(this).val() === \"\"){\r\n            valuesInput.push($(this).attr('placeholder'));\r\n          } else {\r\n            valuesInput.push($(this).val());\r\n          }\r\n        });\r\n\r\n        Session.set('inputNotEmpty', true);\r\n      };\r\n\r\n      //RECOGEMOS LOS VALORES DE LOS BOTONES DESACTIVADOS (NOMBRES REDES SOCIALES)\r\n      $('.btnOptionsSN').each(function() {\r\n        valuesButton.push($(this).text());\r\n      });\r\n\r\n      if(Session.get('inputNotEmpty')){\r\n        //COMPROBAMOS QUE SE HA INTRODUCIDO ALGUN VALOR O SELECCIONADO ALGUNA RED SOCIAL PARA AÃ‘ADIRLA\r\n        if(valuesInput && valuesButton){\r\n          //AHORA OBTENEMOS EL _id DEL USUARIO Y LO AÃ‘ADIMOS AL OBJETO QUE LE VAMOS A PASAR \r\n          //A LA LLAMADA A userData.js QUE SE ENCARGARÃ DE ACTUALIZAR EL REGISTRO.\r\n          var newData = new Object();\r\n          newData.userId = Session.get('datauser')._id;\r\n\r\n          for ( i = 0; i < valuesButton.length; i++ ){\r\n            var valu = valuesButton[i];\r\n            var num = valuesButton.indexOf(valu);\r\n\r\n            if(num >= 0){\r\n              if(\"WhatsApp\" === valu ){\r\n                newData.userWhats = valuesInput[num];\r\n              } else if(\"Facebook\" === valu){\r\n                newData.userFb = valuesInput[num];\r\n              } else if(\"Instagram\" === valu ){\r\n                newData.userInsta = valuesInput[num];\r\n              }\r\n            }\r\n          }\r\n          //POR ULTIMO, REALIZAMOS LA LLAMADA A userData.js\r\n          Meteor.call('updUserDataSocialNetworks', newData);\r\n        }\r\n        \r\n\r\n        //HAY QUE DECIRLE AL MODAL QUE SE CIERRE\r\n        $('#dialog-NewSocialNetwork').modal('hide');\r\n      }\r\n\r\n      //EN EL CASO DE QUE SE DE CLICK A SALVAR DATOS DESPUES DE HABER ELIMINADO UNA RED SOCIAL\r\n      //SE TENDRÃ QUE DECIR AL SISTEMA QUE CAMBIE LA OPCION DE EDITAR SN A AÃ‘ADIR SN\r\n      if(Session.get('removeDataSN')){\r\n        Session.set('modeToAdd', false);\r\n        Session.set('removeDataSN', false);\r\n      };\r\n  \t},\r\n});\r\n\r\nTemplate.socialNetworkBox.helpers({\r\n  'modeAddNewSN': function(){\r\n    var result = new Object();\r\n\r\n    var currentDataUser = Session.get('datauser');\r\n\r\n    var selectOptions = [\"WhatsApp\", \"Instagram\", \"Facebook\"];\r\n    var numSocialNetworks = 0;\r\n\r\n    var datauserSN = [];\r\n\r\n    if(currentDataUser.userWhats){\r\n      var numSele = selectOptions.indexOf(\"WhatsApp\");\r\n      selectOptions.splice(numSele, 1);\r\n      numSocialNetworks += 1;\r\n      datauserSN.push(currentDataUser.userWhats);\r\n    }\r\n\r\n    if(currentDataUser.userFb){\r\n      var numSele = selectOptions.indexOf(\"Facebook\");\r\n      selectOptions.splice(numSele, 1);\r\n      numSocialNetworks += 1;\r\n      datauserSN.push(currentDataUser.userFb);\r\n    }\r\n\r\n    if(currentDataUser.userInsta){\r\n      var numSele = selectOptions.indexOf(\"Instagram\");\r\n      selectOptions.splice(numSele, 1);\r\n      numSocialNetworks += 1;\r\n      datauserSN.push(currentDataUser.userInsta);\r\n    }\r\n\r\n    Session.set('getDataUserSN', datauserSN);\r\n\r\n    Session.set('countSocialNetworks', numSocialNetworks);\r\n\r\n    Session.set('optionsAva', selectOptions);\r\n\r\n\r\n    if(selectOptions.length > 0 && selectOptions.length <= 3){\r\n      result.messageMode = \"AÃ±ade tu red social a twiiterClone\";\r\n      Session.set('modeToAdd', true);\r\n    } else if(selectOptions.length === 0){\r\n      //POR ULTIMO VAMOS A AÃ‘ADIR LOS CAMPOS PARA PODER SER EDITADOS\r\n      var aux = [\"WhatsApp\", \"Facebook\", \"Instagram\"];\r\n      var contentToAppend = [];\r\n      for (var i = 0; i < numSocialNetworks; i++) {\r\n        var objAux = new Object();\r\n        objAux.id = i;\r\n        objAux.valueBtn = aux[i];\r\n        objAux.placeholder = datauserSN[i];\r\n\r\n        contentToAppend.push(objAux);\r\n      }\r\n      result.messageMode = \"Edita tu red social\";\r\n      Session.set('appendThis', contentToAppend);\r\n      Session.set('modeToAdd', false);\r\n    } \r\n\r\n    return result;\r\n  },\r\n\r\n  'contentToAppend': function(){\r\n    return Session.get('appendThis');\r\n  },\r\n\r\n\t'userHaveSN' : function(){\r\n    if(Session.get('optionsAva').length > 0){\r\n      return true;\r\n    } else if(Session.get('modeToAdd')){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n});   ","//DETECTAMOS QUE SE ENCUENTRA EN EL CLIENTE EL CODIGO QUE SE VA  AEJECUTAR\r\nif(Meteor.isClient){\r\n\r\n\tTemplate.tweetBox.onRendered(function(){\r\n\t  Session.set('numChars', 0);\r\n\t});\r\n\r\n\tTemplate.tweetBox.events({\r\n\t  \t'input #tweetText':function(){\r\n\t    \tSession.set('numChars', $('#tweetText').val().length);\r\n\t  \t},\r\n\t  \t'click button': function() {  \r\n\t\t\tvar message = $('#tweetText').val();\r\n\t\t\tvar type = Session.get('commentMode');\r\n\r\n\t\t\tif(type){\r\n\t\t\t\tvar twiitId = Session.get('idCurrentTwiit');\r\n\t\t\t\tvar numComment = UserUtils.findNumComment(twiitId);\r\n\t\t\t\tnumComment++;\r\n\t\t\t}\r\n\r\n\t\t\t$('#tweetText').val(\"\");\r\n\t\t\tSession.set('numChars', 0);\r\n\r\n\t\t\tvar tweet = new Object();\r\n\t\t\ttweet.message = message;\r\n\t\t\ttweet.type = type;\r\n\r\n\t\t\tif(twiitId != null){\r\n\t\t\t\ttweet.twiitId = twiitId;\r\n\t\t\t\ttweet.numComment = numComment;\r\n\t\t\t\ttweet.typeOfNotif = \"comment\";\r\n\t\t\t\t//recepNotif\r\n\t\t\t\ttweet.recepUser = UserUtils.findUserFromTwiit(twiitId);\r\n\t\t\t} else {\r\n\t\t\t\ttweet.typeOfNotif = \"twiit\";\r\n\t\t\t\t//recepNotif\r\n\t\t\t\ttweet.recepUser = Meteor.user().username;\r\n\t\t\t}\r\n\r\n\t\t\ttweet.actorUser = Meteor.user().username;\r\n\r\n\t\t\tMeteor.call('insertTweet', tweet);\r\n\t    }\r\n\t});\r\n\r\n\r\n\tTemplate.tweetBox.helpers({  \r\n\t  charCount: function() {\r\n\t    return 140 - Session.get('numChars');\r\n\t  },\r\n\r\n\t  charClass: function() {\r\n\t    if (Session.get('numChars') > 140) {\r\n\t      return 'errCharCount';\r\n\t    } else {\r\n\t      return 'charCount';\r\n\t    }\r\n\t  },\r\n\r\n\t  disableButton: function() {\r\n\t    if (Session.get('numChars') <= 0 ||\r\n\t        Session.get('numChars') > 140 || \r\n\t        !Meteor.user()) {\r\n\t      return 'disabled';\r\n\t    }\r\n\t  }\r\n\t});\r\n}","Template.tweetFeed.onCreated(function() {  \r\n\tthis.subscribe('twitts');\r\n  this.subscribe('favs');\r\n});\r\n\r\nTemplate.tweetFeed.helpers({  \r\n  'tweetMessage': function() {\r\n    var tweet =  Twitts.find({}, {sort: {timestamp: -1}} );\r\n    return tweet;\r\n  },\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.timestamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n\r\n    var elem = dateCon.split(' ');\r\n\r\n    return elem[0];\r\n  },\r\n  'numComment': function(){\r\n    var num = UserUtils.findNumComment(this._id);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var num = UserUtils.findNumberFavPerTwiit(this._id);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  },\r\n  'infoNotif': function(){\r\n    var username = Meteor.user().username;\r\n\r\n    var numNotif = UserUtils.findNumberNotif(username);\r\n    //PRIMERO TENEMOS QUE COMPROBAR SI HAY NOTIFICACIONES\r\n    if(numNotif === 1){\r\n      //BUSCAMOS LAS NOTIFICACIONES DISPONIBLES\r\n      var notif = UserUtils.findOneNotification(username);\r\n\r\n      UserUtils.createNotifToBrowser(notif.typeOfNotif, notif.actorNotif);\r\n    } else if(numNotif > 1){\r\n      UserUtils.createNotifToBrowser(\"moreNotif\", username);\r\n    }\r\n  }\r\n});\r\n\r\nTemplate.tweetFeed.events({\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n\r\n    console.log(this._id);\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var userTapFav = UserUtils.findFavsForTwiit(this._id);\r\n\r\n    //HACEMOS UNA COMPROBACION DE QUE EL TWIIT NO TIENE NINGUN FAV O QUE SI LO TIENE\r\n    if(!userTapFav){\r\n      //console.log(\"No tiene FAVS\");\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      var arrAux = userTapFav.idUserTapFav;\r\n    }\r\n    \r\n    //SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = this._id;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(this._id);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÃ ESTE OTRO MÃ‰TODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },\r\n  'click #btnComm' : function(){\r\n    var numComment = UserUtils.findNumComment(this._id);\r\n    //SI EL TWIIT TIENE POR LO MENOS 1 COMENTARIO, ENTONCES REDIRIGIMOS AL USUARIO A \r\n    //LA RUTA /Comments. SI NO, SE ABRE EL MODAL Y SE PUEDE HACER EL COMENTARIO\r\n    if(numComment === 0){\r\n        $(\"#dialog-NewTwiit\").modal();\r\n        Session.set('commentMode', true);\r\n        Session.set('idCurrentTwiit', this._id);\r\n    }\r\n  }\r\n});","Template.tweetFeedProfile.onCreated(function() {  \r\n\tthis.subscribe('twittsProfile');\r\n  this.subscribe('favs');\r\n});\r\n\r\nTemplate.tweetFeedProfile.helpers({  \r\n  'tweetMessageProfile': function() {\r\n    /*\r\n    var tweet =  Twitts.find({user: this.name}, { \r\n        sort: {timestamp: -1}, \r\n        limit: 10\r\n    });\r\n    */\r\n    return UserUtils.findTweets(this.name);\r\n  },\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.timestamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n\r\n    var elem = dateCon.split(' ');\r\n\r\n    return elem[0];\r\n  },\r\n  'numComment': function(){\r\n    var num = UserUtils.findNumComment(this._id);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var num = UserUtils.findNumberFavPerTwiit(this._id);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  }\r\n});\r\n\r\nTemplate.tweetFeedProfile.events({\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var userTapFav = UserUtils.findFavsForTwiit(this._id);\r\n    var arrAux = userTapFav.idUserTapFav;\r\n\r\n    //SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = this._id;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(this._id);\r\n\r\n      console.log(notif);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÃ ESTE OTRO MÃ‰TODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },/*\r\n  'click #btnComm' : function(){\r\n    var numComment = UserUtils.findNumComment(this._id);\r\n    //SI EL TWIIT TIENE POR LO MENOS 1 COMENTARIO, ENTONCES REDIRIGIMOS AL USUARIO A \r\n    //LA RUTA /Comments. SI NO, SE ABRE EL MODAL Y SE PUEDE HACER EL COMENTARIO\r\n    if(numComment === 0){\r\n        $(\"#dialog-NewTwiit\").modal();\r\n        Session.set('commentMode', true);\r\n        Session.set('idCurrentTwiit', this._id);\r\n    }\r\n  }*/   \r\n})","Template.twiitCommentPage.onCreated(function() {  \r\n\tthis.subscribe('twittsWithComment');\r\n  \tthis.subscribe('favs');\r\n});\r\n\r\nTemplate.twiitCommentPage.helpers({\r\n\t//DEVUELVE EL MENSAJE ORIGINAL DEL QUE SE PRODUCEN LOS COMENTARIOS\r\n  'tweetMessage' : function(){\r\n  \t//HAY QUE CONSEGUIR PASAR A ESTA VISTA EL this._id DE tweetFeed PARA PODER \r\n  \t//DEVOLVER EL TWEET INICIAL Y DE AHI PASAR A MOSTRAR CON tweetThatCommentMessage\r\n  \t//TODOS LOS COMENTARIOS QUE TENGA!\r\n  \tif(this.mode){\r\n  \t\tid = UserUtils.findTwiitFromNotif(this._id);\r\n  \t\treturn Twitts.find( id, {sort: {timestamp: -1}});\r\n  \t} else {\r\n  \t\treturn Twitts.find( this._id, {sort: {timestamp: -1}});\r\n  \t}\r\n  },\r\n  'tweetThatCommentMessage': function() {\r\n  \tif(this.mode){\r\n  \t\tid = UserUtils.findTwiitFromNotif(this._id);\r\n  \t\treturn Twitts.find({twiitIdComment : id}, {sort: {timestamp: -1}} );\r\n  \t} else {\r\n  \t\treturn Twitts.find({twiitIdComment : this._id}, {sort: {timestamp: -1}});\r\n  \t}\r\n  },\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.timestamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n\r\n    var elem = dateCon.split(' ');\r\n\r\n    return elem[0];\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var num = UserUtils.findNumberFavPerTwiit(this._id);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  }\r\n});\r\n\r\nTemplate.twiitCommentPage.events({\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var userTapFav = UserUtils.findFavsForTwiit(this._id);\r\n    var arrAux = userTapFav.idUserTapFav;\r\n//SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = this._id;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(this._id);\r\n\r\n      console.log(notif);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÃ ESTE OTRO MÃ‰TODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },\r\n  'click #btnComm' : function(){\r\n\t$(\"#dialog-NewTwiit\").modal();\r\n\tSession.set('idCurrentTwiit', this._id);\r\n\tSession.set('commentMode', true);\r\n  }\r\n});","Template.twiitPage.helpers({  \r\n  'convertDateTime': function() {\r\n  \tvar dateNew = new Date(this.twiitTimeStamp);\r\n  \tvar dateCon = dateNew.toLocaleString();\r\n    return dateCon;\r\n  },\r\n\r\n  'tweetMessage': function() {\r\n    console.log(this._id);\r\n    var notify =  Notifications.find({_id: this._id});\r\n    return notify;\r\n  },\r\n\r\n  'countNotifTwiit' : function(){\r\n    var num =  Notifications.find({_id: this._id}).count();\r\n    if(num === 0){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n});\r\n\r\nTemplate.twiitPage.events({\r\n  'click button': function() {\r\n    console.log(this._id);\r\n    Notifications.update(this._id, {$set: {read: true}});\r\n    console.log(\"Clean!\");\r\n    window.location = \"/\";\r\n  },\r\n});\r\n","Template.twiitPageNew.onCreated(function() {  \r\n  this.subscribe('twittsWithComment');\r\n  this.subscribe('favs');\r\n  this.subscribe('allNotifications');\r\n  arrWithId = [];\r\n  arrWithCommNotif = [];\r\n  arrWithFavsNotif = [];\r\n  countArrFavs = 0;\r\n  countArrComm = 0;\r\n\r\n  foundNotifComm = UserUtils.findNotifForTypeNotif(this.data.name, 'comment');\r\n  \r\n  foundNotifFavs = UserUtils.findNotifForTypeNotif(this.data.name, 'fav');\r\n\r\n  Session.set('notificationsModeOn', true);\r\n});\r\n\r\nTemplate.twiitPageNew.helpers({\r\n  'setStyleNavBar': function(){\r\n    var widthNav = $(window).width();\r\n    //RESTAMOS DOS PIXELES POR LOS BORDES\r\n    widthNav -= 2; \r\n    return widthNav/2 + \"px\";\r\n  },\r\n\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.twiitTimeStamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n\r\n    var elem = dateCon.split(' ');\r\n    return elem[0];\r\n  },\r\n\r\n  'showComments': function() {\r\n    countArrComm = foundNotifComm.count();\r\n    Session.set('lengthArrComm', countArrComm);\r\n    return foundNotifComm;\r\n  },\r\n\r\n  'showFavs': function() {\r\n    countArrFavs = foundNotifFavs.count();\r\n    Session.set('lengthArrFavs', countArrFavs);\r\n    return foundNotifFavs;\r\n  },\r\n\r\n  'countNotifTwiit' : function(){\r\n    var numNotif =  UserUtils.findNumberNotif(this.name);\r\n    if(numNotif === 0){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  },\r\n\r\n  'saveIdInArr' : function(){\r\n    arrWithId.push(this._id);\r\n    if(this.typeOfNotif === 'comment'){\r\n      if(arrWithCommNotif.length < countArrComm){\r\n        arrWithCommNotif.push(this._id);\r\n      }\r\n    } else if(this.typeOfNotif === 'fav'){\r\n      if(arrWithFavsNotif.length < countArrFavs){\r\n        arrWithFavsNotif.push(this._id);\r\n      }\r\n    } \r\n  },\r\n\r\n  'selectTypeNotifToShow' : function(){\r\n\r\n    var lengthFavs = Session.get('lengthArrFavs');\r\n    var lengthComm = Session.get('lengthArrComm');\r\n\r\n    if(lengthFavs > lengthComm){\r\n      //SOLO MOSTRAMOS LAS NOTIF DE TIPO FAVS Y HAY QUE DEJAR SELECCIONADO\r\n      //EL BTN DE FAVS DE LA NAVBAR FOOTER\r\n      Session.set('btnShowCommIsPulse', false);\r\n    } else if(lengthFavs < lengthComm){\r\n      //SOLO MOSTRAMOS LAS NOTIF DE TIPO COMM Y HAY QUE DEJAR SELECCIONADO\r\n      //EL BTN DE COMM DE LA NAVBAR FOOTER\r\n      Session.set('btnShowCommIsPulse', true);\r\n    } else if(lengthFavs === lengthComm){\r\n      //SI TENEMOS EL MISMO NUMERO DE NOTIF, NO HACEMOS NADA. MOSTRAMOS TODAS.\r\n      Session.set('btnShowCommIsPulse', false);\r\n    }\r\n  },\r\n\r\n  'numFavPerTwiit' : function(){\r\n    return UserUtils.findNumberFavPerTwiit(this.twiitId);\r\n  },\r\n  'findNumComment' : function(){\r\n    //AQUI this._id ES EL _ID DE LA COLLECTION NOTIFICATIONS\r\n    //POR LO QUE HABRA QUE SACAR EL CAMPO twiitId\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n\r\n    var num = UserUtils.findNumComment(twiitId);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  },\r\n  'numComment': function(){\r\n    var num = UserUtils.findNumComment(UserUtils.findTwiitFromNotif(this._id));\r\n    return num;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n    var num = UserUtils.findNumberFavPerTwiit(twiitId);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  },\r\n  'numFavorite': function(){\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n    var num = UserUtils.findNumberFavPerTwiit(twiitId);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  },\r\n  'numFav': function(){\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n    var num = UserUtils.findNumberFavPerTwiit(twiitId);\r\n    return num;\r\n  },\r\n  'btnShowComm': function(){\r\n    return Session.get('btnShowCommIsPulse');\r\n  },\r\n  'noCommNotif': function(){\r\n    if(Session.get('lengthArrComm') === 0){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  'noFavsNotif': function(){\r\n    if(Session.get('lengthArrFavs') === 0){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  }, \r\n  'notifCommCount': function(){\r\n    return Session.get('lengthArrComm');\r\n  },\r\n  'notifFavsCount': function(){\r\n    return Session.get('lengthArrFavs');\r\n  }\r\n});\r\n\r\nTemplate.twiitPageNew.events({\r\n  'click .btnDismissNotif': function(event) {\r\n    console.log(arrWithCommNotif.length);\r\n    console.log(arrWithFavsNotif.length);\r\n\r\n    console.log(arrWithId);\r\n\r\n    var idBtn = event.target.id;\r\n\r\n    if(idBtn === 'dismissCommNotif'){\r\n      for (var aux in arrWithCommNotif){\r\n        var id = arrWithCommNotif[aux];\r\n        Notifications.update(id, {$set: {read: true}});\r\n        arrWithCommNotif.splice(aux,1);\r\n      }\r\n    } else if(idBtn === 'dismissFavsNotif'){\r\n      for (var aux in arrWithFavsNotif){\r\n        var id = arrWithFavsNotif[aux];\r\n        Notifications.update(id, {$set: {read: true}});\r\n        arrWithFavsNotif.splice(aux,1);\r\n      }\r\n    }\r\n\r\n    Session.set('lengthArrFavs', arrWithFavsNotif.length);\r\n    Session.set('lengthArrComm', arrWithCommNotif.length);\r\n\r\n    if(arrWithCommNotif.length === 0 && arrWithFavsNotif.length === 0){\r\n      window.location = \"/\";\r\n    }\r\n  },\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var idAux = UserUtils.findTwiitFromNotif(this._id);\r\n    var userTapFav = UserUtils.findFavsForTwiit(idAux);\r\n    var arrAux = userTapFav.idUserTapFav;\r\n\r\n    //SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(idAux, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = idAux;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(idAux);\r\n\r\n      console.log(notif);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÃ ESTE OTRO MÃ‰TODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(idAux, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },\r\n  'click #btnComm' : function(){\r\n    var numComment = UserUtils.findNumComment(UserUtils.findTwiitFromNotif(this._id));\r\n    //SI EL TWIIT TIENE POR LO MENOS 1 COMENTARIO, ENTONCES REDIRIGIMOS AL USUARIO A \r\n    //LA RUTA /Comments. SI NO, SE ABRE EL MODAL Y SE PUEDE HACER EL COMENTARIO\r\n    if(numComment === 0){\r\n        $(\"#dialog-NewTwiit\").modal();\r\n        Session.set('commentMode', true);\r\n        Session.set('idCurrentTwiit', UserUtils.findTwiitFromNotif(this._id));\r\n    }\r\n  }, \r\n  'click #btnShowFavsNotif' : function(){\r\n    Session.set('btnShowCommIsPulse', false);\r\n  },\r\n  'click #btnShowCommNotif' : function(){\r\n    Session.set('btnShowCommIsPulse', true);\r\n  }\r\n});","Template.userManagement.onRendered(function(){\r\n  Session.set('pageToLoad', true);\r\n});\r\n\r\nTemplate.userManagement.events({  \r\n  'click #signup': function(event) {\r\n    var passOk = false;\r\n    var emailOk = false;\r\n\r\n    //LIMPIAMOS LOS MENSAJES DE ERROR QUE HABIA ANTES\r\n    $('.msgErrorReg').each(function(){\r\n      $(this).remove();\r\n    });\r\n    $('.invalidField').each(function(){\r\n      $(this).removeClass('invalidField')\r\n    });\r\n\r\n    var user = {\r\n      username: $('#signupNameProfile').val(),\r\n      password: $('#signupPassword').val(),\r\n      profile: {\r\n        fullname: $('#signupUsername').val(),\r\n        email : $('#signupEmail').val()\r\n      }\r\n    };\r\n\r\n    //VALIDAMOS QUE EL CORREO ES VALIDO\r\n    if(user.profile.email.indexOf('@') === -1){\r\n      $('.formRegisterNew').append(\"<h5 class='text-center msgErrorReg'>El email no es vÃ¡lido</h5>\");\r\n      $('#signupEmail').addClass('invalidField');\r\n      emailOk = false;\r\n    } else {\r\n      emailOk = true;\r\n    };\r\n\r\n    //VALIDAMOS QUE LAS CONTRASEÃ‘AS SEAN IGUALES\r\n    var pass2 = Session.get('valInputPass2');\r\n\r\n    if(user.password != pass2){\r\n      $('.formRegisterNew').append(\"<h5 class='text-center msgErrorReg'>Las contraseÃ±as no coinciden</h5>\");\r\n      $('#signupPassword').addClass('invalidField');\r\n      $('#signupPassword2').addClass('invalidField');\r\n      passOk = false;\r\n    } else {\r\n      passOk = true;\r\n    };\r\n\r\n    if(passOk && emailOk){\r\n      Accounts.createUser(user, function (err) {\r\n        //VALIDAMOS SI EL NOMRBE DE USUARIO username YA EXISTE\r\n        if(err.reason === \"Username already exists.\"){\r\n          $('#signupNameProfile').addClass('invalidField');\r\n          $('.formRegisterNew').append(\"<h5 class='text-center msgErrorReg'>El nombre de usuario estÃ¡ en uso</h5>\");\r\n        }\r\n      });\r\n\r\n      //Creamos el nuevo usuario en DataUser\r\n      var userData = new Object();\r\n      userData.userName = user.profile.fullname;\r\n      userData.userNameProfile = user.username;\r\n      userData.emailUser = user.email;\r\n      userData.userImg = \"\";\r\n      userData.userDescription = \"\";\r\n      \r\n      Meteor.call('insertDataUser', userData);\r\n    };\r\n  },\r\n\r\n  'click #login': function(event) {\r\n    event.preventDefault();\r\n    $('#errorContent').text(\"\");\r\n    var username = $('#loginNameProfile').val();\r\n    var password = $('#loginPassword').val();\r\n\r\n    Meteor.loginWithPassword(username, password, function(err) {\r\n      if(err){\r\n        if(err.reason === \"User not found\"){\r\n          $('#loginNameProfile').addClass('invalidField');\r\n          $('#errorContent').append(\"Usuario no encontrado\");\r\n        } else {\r\n          $('#loginPassword').addClass('invalidField');\r\n          $('#errorContent').append(\"Usuario/ContraseÃ±a incorrecta\");      \r\n        }\r\n        $('#dialog-errorLogin').modal('show');\r\n      };\r\n\r\n    });\r\n    loggingIn = true;\r\n  },\r\n\r\n  'click #recommendationsBtn': function() {  \r\n    Session.set('recommendations', true);\r\n  },\r\n\r\n  'click #goToLogInPage': function(){\r\n    Session.set('pageToLoad', true);\r\n  }, \r\n\r\n  'click #goToRegisterPage': function(){\r\n    Session.set('pageToLoad', false);\r\n  }, \r\n  'change #signupPassword2': function(event){\r\n    Session.set('valInputPass2', $('#signupPassword2').val());\r\n  },\r\n  'change #loginNameProfile' : function(event){\r\n    $('#loginNameProfile').removeClass('invalidField');\r\n  },\r\n  'change #loginPassword' : function(event){\r\n    $('#loginPassword').removeClass('invalidField');\r\n  }\r\n});\r\n\r\nTemplate.userManagement.helpers({\r\n  'loginPage': function(){\r\n    return Session.get('pageToLoad');\r\n  },\r\n});","Template.userProfile.onCreated(function(){\r\n\tcurrentUserName = this.data.name;\r\n  Session.set('pathActualApp', '/Profile/'+currentUserName);\r\n});\r\n\r\nTemplate.userProfile.events({  \r\n\t'click #logout': function() {  \r\n    \tMeteor.logout();\r\n    \twindow.location = \"/\";\r\n  \t},\r\n    'click #editWhatsLicenses': function(){\r\n      $('#dialog-editLicenses').modal('show');\r\n    },\r\n  \t'click .btnShowSN': function(event){\r\n\r\n  \t\tvar idSN = event.target.id;\r\n  \t\tif(idSN === \"Facebook\"){\r\n  \t\t\twindow.open(\"https://www.facebook.com/search/all/?q=\" + Session.get('dataUser').userFb);\r\n  \t\t} else if(idSN === \"Instagram\"){\r\n  \t\t\twindow.open(\"https://www.instagram.com/\" + Session.get('dataUser').userInsta + \"/\");\r\n  \t\t} else if(idSN === \"WhatsApp\"){\r\n  \t\t\tSession.set('userToSentPet', currentUserName);\r\n\r\n  \t\t\tvar userActName = Meteor.user().username;\r\n    \t\t\t\r\n  \t\t\tvar arrWhats = dataUser.showWhatsTo;\r\n  \t\t\tMeteor.call('findUserData', userActName, function(err,res){\r\n    \t\t\tif(arrWhats.length > 0){\r\n      \t\t\t\tif(arrWhats.indexOf(res.userId) >= 0){\r\n                console.log(\"TOOLTIP\");\r\n    \t  \t\t\t\t//MOSTRAMOS EL WHATSAPP\r\n                $('[data-toggle=\"tooltip\"]').attr(\"title\", dataUser.userWhats);\r\n      \t\t\t\t\t$('[data-toggle=\"tooltip\"]').tooltip('show'); \r\n      \t  \t\t\t} else {\r\n                  $('[data-toggle=\"tooltip\"]').tooltip('show'); \r\n                }\r\n        \t\t\t} else if(!Session.get('showProfileOtherUser')){\r\n      \t\t\t\t\t//ESTE PROCESO NO ES INSTANTANEO YA QUE EL USUARIO TIENE QUE ACEPTAR LA PETICION\r\n      \t\t\t\t\t$('#dialog-showSocialNetwork').modal('show');\r\n      \t\t\t\t} else {\r\n                $('[data-toggle=\"tooltip\"]').tooltip('show'); \r\n              }\r\n  \t\t\t});\r\n  \t\t}\r\n  \t},\r\n  \t'click .showFollowings': function(){\r\n  \t\twindow.location = \"/followAnts/\" + currentUserName;\r\n  \t},\r\n  \t'click .showFollowers': function(){\r\n  \t\twindow.location = \"/followAnts/\" + currentUserName;\r\n  \t},\r\n    'click #btnUnfollow': function(){\r\n      $('#dialog-stopFollowing').modal('show');\r\n    },\r\n    'click #stopFolBtn': function(){\r\n      Meteor.call('unfollowUser', currentUserName);\r\n      Session.set('userIsFollowMe', false);\r\n      $('#dialog-stopFollowing').modal('hide');\r\n    },\r\n    'click #noStopFolBtn': function(){\r\n      $('#dialog-stopFollowing').modal('hide');\r\n    },\r\n    'click #btnFollow': function(){\r\n      Session.set('userIsFollowMe', true);\r\n      Meteor.call('followUser', currentUserName);\r\n    },\r\n    'click #imgCurrentUser': function(){\r\n      var imgUserProfile = $('#imgCurrentUser').attr('src');\r\n      $('#img' + currentUserName).attr('src', imgUserProfile);\r\n      $('#dialog-showImageProfile').modal('show');\r\n      $('.modal-backdrop').css('opacity', 0.9);\r\n    },\r\n    'click #btnCloseModalImgProfile': function(){\r\n      $('#dialog-showImageProfile').modal('hide');\r\n    }\r\n});\r\n\r\nTemplate.userProfile.helpers({\r\n\t'dataUserFound': function(){\r\n\t\tMeteor.call('findUserData', currentUserName, function(err, res) {\r\n    \tSession.set('dataUser',res);\r\n  \t});\r\n\r\n  \tdataUser = Session.get('dataUser');\r\n\r\n  \treturn dataUser;\r\n\t},\r\n\t'userImgFound': function(){\r\n\t\tif(dataUser.userImg != \"\"){\r\n\t\t\tMeteor.call('findUserImg', dataUser.userImg, function(err, res) {\r\n\t\t\t\t$('#imgCurrentUser').attr(\"src\", res);\r\n\t\t  \t});\r\n\t\t} else {\r\n\t\t\tconsole.log(\"No Img Profile\");\r\n\t\t\t//$('#imgCurrentUser').attr(\"src\", \"/profileImgTest.png\");\r\n\t\t\treturn \"/profileImgTest.png\";\r\n\t\t}\r\n\t},\r\n\t'tweets': function(){\r\n\t\treturn UserUtils.findTweets(currentUserName).count();\r\n\t},\r\n\t'following': function(){\r\n\t  Meteor.call('getFollowings', currentUserName, function(err, res) {\r\n  \t\tSession.set('numFollowings',res.length);\r\n  \t});\r\n  \treturn Session.get('numFollowings');\r\n\t},\r\n\t'followers': function(){\r\n    Meteor.call('getFollowers', currentUserName, function(err, res) {\r\n      Session.set('getFollowers',res);\r\n    \tSession.set('numFollowers',res.length);\r\n    });\r\n\r\n    var currentFollowers = Session.get('getFollowers');\r\n    var currentUser = Session.get('currentUser');\r\n\r\n    if(currentFollowers){\r\n      var posUser = currentFollowers.indexOf(currentUser);\r\n\r\n      if(posUser != -1){\r\n        Session.set('userIsFollowMe', true);\r\n      } else {\r\n        Session.set('userIsFollowMe', false);\r\n      }\r\n    }\r\n    \r\n  \treturn Session.get('numFollowers');\r\n\t},\r\n\t'existsSocialNetwork': function(){\r\n\t\t\r\n\t\tvar btnSocial = [];\r\n\r\n\t\tif(dataUser.userFb){\r\n\t\t\tvar newData = new Object();\r\n\t\t\tnewData.color = \"primary\";\r\n\t\t\tnewData.class = \"fa fa-facebook\";\r\n\t\t\tnewData.id = \"Facebook\";\r\n\t\t\tbtnSocial.push(newData);\r\n\t\t}\r\n\r\n\t\tif(dataUser.userInsta){\r\n\t\t\tvar newData = new Object();\r\n\t\t\tnewData.color = \"warning\";\r\n\t\t\tnewData.class = \"fa fa-instagram\";\r\n\t\t\tnewData.id = \"Instagram\";\r\n\t\t\tbtnSocial.push(newData);\r\n\t\t}\r\n\r\n\t\tif(dataUser.userWhats){\r\n\t\t\tvar newData = new Object();\r\n\t\t\tnewData.color = \"success\";\r\n\t\t\tnewData.class = \"fa fa-whatsapp\";\r\n\t\t\tnewData.id = \"WhatsApp\";\r\n\t\t\tbtnSocial.push(newData);\r\n\t\t}\r\n\r\n\t\treturn btnSocial;\r\n\t},\r\n\t'showProfileOtherUser' : function(){\r\n\t\treturn Session.get('showProfileOtherUser');\r\n\t},\r\n\t'isWhatsapp' : function(){\r\n\t\tif(this.id === \"WhatsApp\"){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t},\r\n  'userIsFollowMe': function(){\r\n    return Session.get('userIsFollowMe');\r\n  }, \r\n  'currentUser': function(){\r\n    return currentUserName;\r\n  }\r\n});","Template.videoTrans.onCreated(function(){\r\n\t\r\n});\r\n\r\nTemplate.videoTrans.events({  \r\n\t\r\n});\r\n\r\nTemplate.videoTrans.helpers({\r\n\t'chargeVideo' : function(){\r\n\t\tconsole.log(\"Loading\");\r\n\t\tnavigator.getMedia = (  navigator.getUserMedia ||\r\n\t                   \t\t\tnavigator.webkitGetUserMedia ||\r\n\t                   \t\t\tnavigator.mozGetUserMedia ||\r\n\t                   \t\t\tnavigator.msGetUserMedia);\r\n\r\n\t\twindow.URL = window.URL || \r\n             \t\t window.webkitURL || \r\n             \t\t window.mozURL || \r\n             \t\t window.msURL;\r\n\r\n\t\tconsole.log(window.URL);\r\n\r\n\t\tnavigator.getMedia (\r\n\t\t   // Restricciones (contraints) *Requerido\r\n\t\t   {\r\n\t\t      \tvideo: true\r\n\t\t   },\r\n\r\n\t\t   // Funcion de finalizacion (Succes-Callback) *Requerido\r\n\t\t   function(localMediaStream) {\r\n\t\t      \tvar video = document.querySelector('video');\r\n\t\t      \tvideo.src = window.URL.createObjectURL(localMediaStream);\r\n\r\n\t\t        /*\r\n\t\t      \tvar playPromise = video.play();\r\n\t\t      \t\r\n\t\t      \tif (playPromise !== undefined) {\r\n\t\t\t\t  playPromise.then(function() {\r\n\t\t\t\t    // Automatic playback started!\r\n\t\t\t\t  }).catch(function(error) {\r\n\t\t\t\t  \tconsole.log(error);\r\n\t\t\t\t    // Automatic playback failed.\r\n\t\t\t\t    // Show a UI element to let the user manually start playback.\r\n\t\t\t\t  });\r\n\t\t\t\t};\r\n\t\t\t\t*/\r\n\t\t      \tconsole.log(navigator);\r\n\t\t      \t/*\r\n\t\t      \tvideo.onloadedmetadata = function(e) {\r\n\t\t         // Haz algo con el video aquÃ­.\r\n\t\t      \t};\r\n\t\t      \t*/\r\n\t\t   },\r\n\r\n\t\t   // errorCallback *Opcional\r\n\t\t   function(err) {\r\n\t   \t\t\tconsole.log(\"OcurriÃ³ el siguiente error: \");\r\n\t   \t\t\tconsole.log(err);\r\n\t\t   }\r\n\r\n\t\t);\r\n\t},\r\n});","Template.whatsAppNotif.onCreated(function() { \r\n  //console.log(\"Usuario: \"); \r\n  //console.log(Meteor.user().username);\r\n  Meteor.subscribe('whatsAppNotifications', Meteor.user().username);\r\n});\r\n\r\nTemplate.whatsAppNotif.helpers({\r\n  modeDisplay: function() {\r\n    var size = Session.get('sizeDisplay');\r\n    if(size > 768){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  whatsNotifCount: function(){\r\n    numNotif = Session.get('requestWhats').length;\r\n    numNotif += Session.get('responseWhats').length;\r\n    return numNotif;\r\n  },\r\n  'infoStateCollapseNavBar': function() {\r\n    return Session.get('navBarCollapse');\r\n  }\r\n});\r\n\r\nTemplate.whatsAppNotif.events({\r\n  \r\n  'click #linkToWhatsNotif' : function(){\r\n    if(numNotif > 0){\r\n      window.location = \"/RequestWhatsApp/\" + Meteor.user().username;\r\n    }\r\n  }\r\n  \r\n});","Template.whatsAppRequestPage.helpers({  \r\n  'countNotifRequest' : function(){\r\n    arrWhatsAppReqNotif =  Session.get('requestWhats');\r\n    if(arrWhatsAppReqNotif){\r\n      countNumReqWhatsAppNotif = arrWhatsAppReqNotif.length;\r\n      if(countNumReqWhatsAppNotif === 0){\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    };\r\n  },\r\n  'countNotifResponse' : function(){\r\n    arrWhatsAppResNotif =  Session.get('responseWhats');\r\n    if(arrWhatsAppResNotif){\r\n      countNumResWhatsAppNotif = arrWhatsAppResNotif.length;\r\n      if(countNumResWhatsAppNotif === 0){\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    };\r\n  },\r\n  'whatsRequestNotif' : function(){\r\n    var arrAux = [];\r\n    arrWhatsAppReqNotif.forEach(function(item){\r\n      console.log(item);\r\n      var dataFound = UserUtils.findWhatsAppNotifications(item);\r\n      console.log(dataFound);\r\n      arrAux.push(dataFound);\r\n    });\r\n    console.log(arrAux);\r\n\r\n    return arrAux;\r\n  },\r\n  'whatsResponseNotif' : function(){\r\n    var arrAux = [];\r\n    arrWhatsAppResNotif.forEach(function(item){\r\n      console.log(item);\r\n      var dataFound = UserUtils.findWhatsAppNotifications(item);\r\n      console.log(dataFound);\r\n      arrAux.push(dataFound);\r\n    });\r\n    console.log(arrAux);\r\n\r\n    return arrAux;\r\n  }\r\n});\r\n\r\nTemplate.whatsAppRequestPage.events({\r\n  //SE PRODUCE CUANDO EL USUARIO ACEPTA LA SOLICITUD\r\n  'click #sentYes' : function() {\r\n    var idWhatsNotif = this._id;\r\n    //HAY QUE REALIZAR UNA NOTIFICACION AL USUARIO QUE HA SOLICITADO EL WHATSAPP\r\n    //INFORMANDOLE QUE SE HA ACEPTADO DICHA SOLICITUD\r\n    \r\n    var notif = new Object();\r\n      \r\n    notif.recepNotif = this.actorNotif; //EL USUARIO QUE VA A RECIBIR LA RESPUESTA DE LA PETICION\r\n    notif.actorNotif = this.recepNotif; //EL USUARIO QUE CONFIRMA LA PETICION\r\n    notif.timestamp = new Date();\r\n    notif.idNotifRequestWhatsApp = idWhatsNotif;\r\n    notif.typeOfNotif = \"responseWhatsAppNotif\";\r\n    notif.stateResponse = true;\r\n\r\n    Meteor.call('createResponseWhatsAppNotification', notif);\r\n    \r\n    countNumReqWhatsAppNotif--;\r\n\r\n    //ADEMAS HAY QUE AÃ‘ADIR A showWhatsTo[] A QUIEN ACABAMOS DE ACEPTAR\r\n    var update = new Object();\r\n    update.user = this.recepNotif;\r\n    update.userToShow = this.actorNotif;\r\n    Meteor.call('updateArrayWhatsAppAuthorize', update);\r\n  },\r\n  //SE PRODUCE CUANDO EL USUARIO RECHAZA LA SOLICITUD\r\n  'click #sentNo' : function(){\r\n    var idWhatsNotif = this._id;\r\n    //HAY QUE REALIZAR UNA NOTIFICACION AL USUARIO QUE HA SOLICITADO EL WHATSAPP\r\n    //INFORMANDOLE QUE SE HA RECHAZADO DICHA SOLICITUD\r\n    \r\n    var notif = new Object();\r\n      \r\n    notif.recepNotif = Session.get('userToSentPet'); //EL USUARIO QUE VA A RECIBIR LA PETICION\r\n    notif.actorNotif = Meteor.user().username; //EL USUARIO QUE REALIZA LA PETICION\r\n    notif.timestamp = new Date();\r\n    notif.idNotifRequestWhatsApp = idWhatsNotif;\r\n    notif.typeOfNotif = \"responseWhatsAppNotif\";\r\n    notif.stateResponse = false;\r\n\r\n    Meteor.call('createResponseWhatsAppNotification', notif);\r\n    \r\n    countNumReqWhatsAppNotif--;\r\n\r\n  },\r\n  //PULSEMOS EL BTN QUE PULSEMOS SE HARAN DOS COSAS:\r\n  //1) REDIRECCION A LA PAGINA PPAL SI SE HAN ACABADO LAS NOTIFICACIONES\r\n  //2) PONER LA NOTIFICACION A LEIDA\r\n  'click .btn' : function(){\r\n    \r\n    var idNotifToClear = this._id;\r\n    \r\n    Notifications.update(idNotifToClear, {$set: {read: true}});\r\n\r\n    console.log(\"Clean!\");\r\n    console.log(countNumReqWhatsAppNotif + \" \" + countNumResWhatsAppNotif);\r\n\r\n    if(countNumReqWhatsAppNotif === 0 && countNumResWhatsAppNotif === 0){\r\n      window.location = \"/\"; \r\n    }\r\n    \r\n  },\r\n  'click #goToProfile': function(){\r\n    window.location = \"/Profile/\" + this.actorNotif;\r\n    countNumResWhatsAppNotif--;\r\n  },\r\n  'click #clearNotif': function(){\r\n    var idNotifToClear = this._id;\r\n    \r\n    countNumResWhatsAppNotif--;\r\n    Notifications.update(idNotifToClear, {$set: {read: true}});\r\n\r\n    $('#'+this.actorNotif).remove();\r\n\r\n    console.log(countNumReqWhatsAppNotif + \" \" + countNumResWhatsAppNotif);\r\n\r\n    if(countNumReqWhatsAppNotif === 0 && countNumResWhatsAppNotif === 0){\r\n      window.location = \"/\"; \r\n    }\r\n  }\r\n});","import { Template } from 'meteor/templating';\r\nimport { ReactiveVar } from 'meteor/reactive-var';\r\n\r\nimport './main.html';\r\n\r\n/*****************************************************************/\r\n/****************CONTROLAMOS EL ZOOM EN LA PAGINA*****************/\r\n/*****************************************************************/\r\n$(document).ready(function(){\r\n\t$(document).keydown(function(event) {\r\n\t    if (event.ctrlKey==true && (event.which == '61' || event.which == '107' || event.which == '173' || event.which == '109'  || event.which == '187'  || event.which == '189'  ) ) {\r\n\t\t\tevent.preventDefault();\r\n\t    };\r\n\t});\r\n\r\n\t$(window).bind('mousewheel DOMMouseScroll', function (event) {\r\n       \tif (event.ctrlKey == true) {\r\n\t\t   \tevent.preventDefault();\r\n\t    };\r\n\t});\r\n});\r\n/*****************************************************************/\r\n/*****************************************************************/\r\n/*****************************************************************/","Twitts = new Meteor.Collection('twitts');\r\nRelationships = new Meteor.Collection('relationships');\r\nDataUser = new Meteor.Collection('dataUser');\r\nFavs = new Meteor.Collection('favs');\r\nNotifications = new Mongo.Collection('notifications');\r\nImages = new Mongo.Collection('images');\r\nChatsMsg = new Mongo.Collection('chatsMsg');\r\nChats = new Mongo.Collection('chats');","Router.configure({\r\n  loadingTemplate: 'loading',\r\n  notFoundTemplate: 'notFound',\r\n});\r\n\r\nRouter.route('/', {\r\n\tname: 'userManagement',\r\n\tdata: function(){\r\n\t\tSession.set('pathActualApp', '/');\r\n\t}\r\n});\r\n/*SE ACCEDE POR WINDOW.LOCATION*/\r\nRouter.route('/whoToFollow', {name: 'followUsers'});\r\nRouter.route('/Profile/:username', {\r\n\tname: 'userProfile',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.username;\r\n\r\n\t\tvar currentUser = Session.get('currentUser');\r\n\r\n\t\tMeteor.call('findUserData', user.name, function(err, res) {\r\n\t      Session.set('dataUserShowProfile',res);\r\n\t    });\r\n\r\n\t    dataUserShowProfile = Session.get('dataUserShowProfile');\r\n\r\n\t    if(dataUserShowProfile){\r\n\t    \tif(dataUserShowProfile.userNameProfile != currentUser){\r\n\t\t    \tSession.set('showProfileOtherUser', false);\r\n\t\t    } else {\r\n\t\t    \tSession.set('showProfileOtherUser', true);\r\n\t\t    }\r\n\t    }\r\n\t    \r\n\t    Session.set('pathActualApp', \"/Profile/\" + this.params.username);\r\n\r\n\t\treturn user;\r\n\t}\r\n});\r\nRouter.route('/Notifications/:userName', {\r\n\tname: 'twiitPageNew',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.userName;\r\n\t\tSession.set('pathActualApp', \"/Notifications/\" + this.params.username);\r\n\t\treturn user;\r\n\t}\r\n});\r\n\r\nRouter.route('/RequestWhatsApp/:userName', {\r\n\tname: 'whatsAppRequestPage',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.userName;\r\n\t\tSession.set('pathActualApp', \"/RequestWhatsApp/\" + this.params.username);\r\n\t\treturn user;\r\n\t}\r\n});\r\n\r\n//Router.route('/Comments', {name: 'twiitCommentPage'});\r\n/*SE ACCEDE POR PATHFOR*/\r\nRouter.route('/Comments/:_id', {\r\n\tname: 'twiitCommentPage',\r\n\tdata: function(){\r\n\t\tvar mode = Session.get('notificationsModeOn');\r\n\t\tvar idTwiit = new Object();\r\n\t\tidTwiit._id = this.params._id;\r\n\r\n\t\tif(mode){\r\n\t\t\tidTwiit.mode = mode;\r\n\t\t}\r\n\r\n\t\tSession.set('pathActualApp', \"/Comments/\" + this.params.username);\r\n\r\n\t\treturn idTwiit;\r\n\t}\r\n});\r\nRouter.route('/twiits/:_id', {\r\n  \tname: 'twiitPage',\r\n  \tdata: function() { \r\n  \t\treturn this.params;\r\n  \t}\r\n});\r\n\r\nRouter.route('/editProfile/:userName', {\r\n\tname: 'editProfile',\r\n\tdata: function(){\r\n\t\tSession.set('pathActualApp', \"/editProfile/\" + this.params.username);\r\n\t\treturn this.params.userName;\t\r\n\t}\r\n});\r\n\r\nRouter.route('/followAnts/:userName', {\r\n\tname: 'followAnts',\r\n\tdata: function(){\r\n\t\tvar showData = new Object();\r\n\t\tshowData.user = this.params.userName;\r\n\t\tshowData.mode = true;\r\n\t\tSession.set('pathActualApp', \"/followAnts/\" + this.params.username);\r\n\t\treturn showData;\r\n\t}\r\n});\r\n\r\nRouter.route('/videoTrans', {name: 'videoTrans'});\r\n\r\nRouter.route('/Chats/', {\r\n\tname: 'conversationsMenu',\r\n});\r\n\r\nRouter.route('/Conversation/:username', {\r\n\tname: 'showConver',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.username;\r\n\r\n\t\treturn user;\r\n\t}\r\n});","UserUtils = function() {};    //no var in front\r\n\r\nUserUtils.findTweets = function(username) { \r\n  /*\r\n  var currentTweets = Twitts.find({ user: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data;\r\n  \t\t\t\t\t\t  });\r\n                */\r\n    return Twitts.find({user: username}, {sort: {timestamp: -1} });\r\n};\t\r\n//SIGUIENDO\r\nUserUtils.findFollowings = function(username) { \r\n  var currentFollowings = Relationships.find({ follower: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  //console.log(\"Siguiendo: \");\r\n  //console.log(currentFollowings);\r\n\r\n  return currentFollowings;\r\n};\t\r\n//SEGUIDORES\r\nUserUtils.findFollowers = function(username) { \r\n  var currentFollowers = Relationships.find({ following: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.follower;\r\n  \t\t\t\t\t\t  });\r\n  //console.log(\"Seguidores: \");\r\n  //console.log(currentFollowers);\r\n\r\n  return currentFollowers;\r\n};\t\r\n\r\nUserUtils.findNotifications = function(username){\r\n\treturn Notifications.find({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findNotifForTypeNotif = function(username, type){\r\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, typeOfNotif: type}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findOneNotification = function(username){\r\n  return Notifications.findOne({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findNumberNotif = function(username){\r\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, $or : [{typeOfNotif : 'twiit'}, {typeOfNotif : 'fav'}, {typeOfNotif : 'comment'}]}).count();\r\n};\r\n\r\nUserUtils.findWhatsAppNotifications = function(notifId){\r\n  return Notifications.findOne({_id: notifId});\r\n};\r\n\r\nUserUtils.findNumberFavPerTwiit = function(idTwiit){\r\n  var twiitNumFav = Twitts.findOne({_id: idTwiit}).numFav;\r\n  return twiitNumFav;\r\n};\r\n\r\nUserUtils.findFavsForTwiit = function(id){\r\n  return Favs.findOne({idTwiit : id});\r\n}\r\n\r\nUserUtils.addFavToTwiit = function(id, idUser){\r\n  var resultToUpdate = false;\r\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\r\n  var favObject = UserUtils.findFavsForTwiit(id);\r\n\r\n  if(!favObject){\r\n    //console.log(\"No tiene FAVS\");\r\n    \r\n  } else {\r\n    var arrAux = favObject.idUserTapFav;\r\n    var idFav = favObject._id;\r\n\r\n    arrAux.push(idUser);\r\n    var num = UserUtils.findNumberFavPerTwiit(id);\r\n    num++;\r\n\r\n    //AHORA HACEMOS LAS OPERACIONES DE UPDATE\r\n    res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\r\n    resT = Twitts.update(id, {$set: {numFav: num}});\r\n\r\n    //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\r\n    if(res && resT){\r\n      resultToUpdate = true;\r\n    }\r\n  }\r\n\r\n  return resultToUpdate;\r\n};\r\n\r\nUserUtils.removeFavToTwiit = function(id, idUser){\r\n  var resultToUpdate = false;\r\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\r\n  var favObject = UserUtils.findFavsForTwiit(id);\r\n  var arrAux = favObject.idUserTapFav;\r\n  var idFav = favObject._id;\r\n\r\n  //HAY QUE AVERIGUAR LA POSICION DEL idUser DENTRO DEL ARRAY DE LA BBDD\r\n  var posIdUser = arrAux.indexOf(idUser);\r\n  //AHORA ELIMINAMOS EL ELEMENTO ASOCIADO A ESA POSICION\r\n  delete arrAux[posIdUser];\r\n\r\n  var num = UserUtils.findNumberFavPerTwiit(id);\r\n  num--;\r\n\r\n  //AHORA HACEMOS LAS OPERACIONES DE UPDATE\r\n  res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\r\n  resT = Twitts.update(id, {$set: {numFav: num}});\r\n\r\n  //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\r\n  if(res && resT){\r\n    resultToUpdate = true;\r\n  }\r\n\r\n  return resultToUpdate;\r\n};\r\n\r\nUserUtils.findTwiitFromNotif = function(id){\r\n  var twiitId = Notifications.findOne(id).twiitId;\r\n  return twiitId;\r\n};\r\n\r\nUserUtils.findNumComment = function(idTweet){\r\n  return Twitts.findOne({_id : idTweet}).numComment;\r\n};\r\n\r\n//PARA MOSTRAR NOTIFICACIONES EN EL NAVEGADOR WEB\r\nUserUtils.createNotifToBrowser = function(typeNotif, userName){\r\n  if (Notification) {\r\n    if (Notification.permission !== \"granted\") {\r\n      Notification.requestPermission();\r\n    }\r\n    var title = \"TwiitClone\";\r\n    var bodyNotif = \"\";\r\n\r\n    if(typeNotif === \"fav\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha dado fav a un twiit tuyo\";\r\n    } else if(typeNotif === \"comment\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha comentado un twiit tuyo\";\r\n    } else if(typeNotif === \"twiit\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha publicado a un twiit nuevo\";\r\n    } else if(typeNotif === \"moreNotif\"){\r\n      bodyNotif = \"Tienes muchas Notificaciones\";\r\n    }\r\n\r\n    var extra = { body: bodyNotif };\r\n\r\n    var noti = new Notification(title, extra);\r\n\r\n    noti.onclick = function(){\r\n      // Al hacer click\r\n      window.location = \"/Notifications/\" + Meteor.user().username;\r\n    };\r\n\r\n    noti.onclose = {\r\n      // Al cerrar\r\n    };\r\n\r\n    setTimeout( function() { noti.close() }, 5000);\r\n  }\r\n};\r\n\r\nUserUtils.findUserFromTwiit = function(twiitId){\r\n  return Twitts.findOne({_id : twiitId}).user;\r\n};"]}
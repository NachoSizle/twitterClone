{"version":3,"sources":["meteor://💻app/client/partialTemplates/editProfile.js","meteor://💻app/client/partialTemplates/followUsers.js","meteor://💻app/client/partialTemplates/navBarTemplate.js","meteor://💻app/client/partialTemplates/notifications.js","meteor://💻app/client/partialTemplates/notificationsNew.js","meteor://💻app/client/partialTemplates/removeProfile.js","meteor://💻app/client/partialTemplates/sendRequest.js","meteor://💻app/client/partialTemplates/showSocialNetwork.js","meteor://💻app/client/partialTemplates/socialNetworkBox.js","meteor://💻app/client/partialTemplates/tweetBox.js","meteor://💻app/client/partialTemplates/tweetFeed.js","meteor://💻app/client/partialTemplates/tweetFeedProfile.js","meteor://💻app/client/partialTemplates/twiitCommentPage.js","meteor://💻app/client/partialTemplates/twiitPage.js","meteor://💻app/client/partialTemplates/twiitPageNew.js","meteor://💻app/client/partialTemplates/userManagement.js","meteor://💻app/client/partialTemplates/userProfile.js","meteor://💻app/client/partialTemplates/whatsAppNotif.js","meteor://💻app/client/partialTemplates/whatsAppRequestPage.js","meteor://💻app/client/main.js","meteor://💻app/lib/collections/collections.js","meteor://💻app/lib/router.js","meteor://💻app/lib/userUtils.js"],"names":["Template","editProfile","onCreated","Meteor","subscribe","call","data","err","res","Session","set","currentDataUser","get","events","userAux","newData","Object","description","document","getElementById","value","$","attr","userId","_id","codeImg","imgId","console","log","window","location","userNameProfile","file","files","reader","FileReader","onload","e","target","result","readAsDataURL","helpers","dataUser","userImg","username","dataUserFound","userWhats","userFb","userInsta","followUsers","event","searchUser","foundUser","onRendered","navBarTemplate","width","user","navigator","platform","resultNotif","UserUtils","findNumberNotif","resultNotifRequest","Notifications","find","recepNotif","read","typeOfNotif","resultNotifResponse","auxTotalCount","count","cont","req","forEach","item","push","resize","notifications","modeDisplay","size","notificationCount","notificationsNew","numNotif","removeProfile","userToRemove","aux","id","name","modal","sendRequest","notif","actorNotif","timestamp","Date","showSocialNetwork","socialNetworkBox","selectOptions","numSocialNetworks","avaSelecOptions","selectOptionsArray","i","length","append","hide","btnTap","selectOption","text","arrOptions","numSele","indexOf","splice","html","remove","btnToRem","propertyToRem","auxOptions","auxCount","show","valuesInput","valuesButton","foundInputNewSN","each","val","valu","num","datauserSN","messageMode","contentToAppend","objAux","valueBtn","placeholder","isClient","tweetBox","message","type","twiitId","numComment","findNumComment","tweet","recepUser","findUserFromTwiit","actorUser","charCount","charClass","disableButton","tweetFeed","Twitts","sort","dateNew","dateCon","toLocaleString","findNumberFavPerTwiit","findOneNotification","createNotifToBrowser","currentUser","idUser","users","findOne","userTapFav","findFavsForTwiit","addFavToTwiit","addClass","removeClass","arrAux","idUserTapFav","removeFavToTwiit","tweetFeedProfile","limit","twiitCommentPage","mode","findTwiitFromNotif","twiitIdComment","twiitPage","twiitTimeStamp","notify","update","$set","twiitPageNew","arrWithId","findNotifications","idAux","userManagement","password","profile","fullname","Accounts","createUser","error","alert","userData","userName","userDescription","loginWithPassword","loggingIn","userProfile","currentUserName","logout","idSN","open","tooltip","btnSocial","color","whatsAppNotif","whatsNotifCount","whatsAppRequestPage","arrWhatsAppReqNotif","countNumWhatsAppNotif","arrWhatsAppResNotif","dataFound","findWhatsAppNotifications","idWhatsNotif","idNotifRequestWhatsApp","stateResponse","idNotifToClear","ReactiveVar","Collection","Relationships","DataUser","Favs","Mongo","Images","Router","configure","loadingTemplate","notFoundTemplate","route","params","dataUserShowProfile","idTwiit","findTweets","currentTweets","fetch","map","following","findFollowings","currentFollowings","follower","findFollowers","currentFollowers","isOwnTwiit","$or","notifId","twiitNumFav","numFav","resultToUpdate","favObject","idFav","resT","posIdUser","idTweet","typeNotif","Notification","permission","requestPermission","title","bodyNotif","extra","body","noti","onclick","onclose","setTimeout","close"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","file":"/app.js","sourcesContent":["Template.editProfile.onCreated(function(){\r\n\tMeteor.subscribe('images');\r\n\tMeteor.call('findUserData', this.data, function(err, res) {\r\n\t\tSession.set('datauser',res);\r\n  \t});\r\n  \tcurrentDataUser = Session.get('datauser');\r\n});\r\n\r\nTemplate.editProfile.events({  \r\n\t'click #saveChanges': function(){\r\n\t\tuserAux = Session.get('datauser');\r\n\t\tnewData = new Object();\r\n\t\tnewData.description = document.getElementById(\"userDescription\").value;\r\n\t\tif(newData.description === \"\"){\r\n\t\t\tnewData.description = $('#userDescription').attr(\"placeholder\");\r\n\t\t}\r\n\t\tnewData.userId = userAux._id;\r\n\r\n\t\t//AHORA NOS GUARDAMOS EL _id DEL DOCUEMNTO QUE VAMSO A INSERTAR EN LA COLECCION Images\r\n\t\t//QUE ALMACENARÁ LA NUEVA FOTO\r\n\t\tvar codeImg = $('#imgCurrentUser').attr(\"src\");\r\n\r\n\t\tMeteor.call('insertNewImage', codeImg, function(err,res){\r\n\t\t\tnewData.imgId = res;\r\n\t\t\tconsole.log(newData.imgId);\r\n\t\t\tMeteor.call('updUserData', newData);\r\n\t\t\twindow.location = \"/Profile/\" + userAux.userNameProfile;\r\n\t\t});\r\n\r\n\t\t/*\r\n\t\t//REALIZAMOS LA PETICION AJAX PARA GUARDAR LA IMAGEN EN PUBLIC\r\n\t\t//RECUPERAMOS LA IMAGEN QUE HEMOS SUBIDO\r\n  \t\tvar file = $('#inputFile')[0].files[0];\r\n  \t\tvar readFile = new FileReader();\r\n  \t\treadFile.readAsDataURL(file);\r\n\r\n  \t\tconsole.log(readFile);\r\n\r\n\t\tvar ruta = \"img-ajax.php\";\r\n        $.ajax({\r\n            url: ruta,\r\n            type: \"POST\",\r\n            data: readFile,\r\n            contentType: false,\r\n            processData: false,\r\n            success: function(datos)\r\n            {\r\n                console.log(datos);\r\n            }\r\n        });\r\n        */\r\n  \t},\r\n  \t'change #inputFile': function(){\r\n\r\n  \t\t//RECUPERAMOS LA IMAGEN QUE HEMOS SUBIDO\r\n  \t\tvar file = $('#inputFile')[0].files[0];\r\n\r\n  \t\treader = new FileReader();\r\n  \t\treader.onload = (function(file){\r\n  \t\t\treturn function(e){\r\n  \t\t\t\t$('#imgCurrentUser').attr(\"src\", e.target.result);\r\n  \t\t\t}\r\n  \t\t})(file);\r\n\r\n  \t\treader.readAsDataURL(file);\t\r\n  \t}\r\n});\r\n\r\nTemplate.editProfile.helpers({\r\n\t'dataUserFound': function(){\r\n\t\tdataUser = Session.get('datauser');\r\n\t\treturn dataUser;\r\n\t},\r\n\t'userImgFound': function(){\r\n\t\tif(dataUser.userImg){\r\n\t\t\tMeteor.call('findUserImg', dataUser.userImg, function(err, res) {\r\n\t\t\t\t$('#imgCurrentUser').attr(\"src\", res);\r\n\t\t  \t});\r\n\t\t} else {\r\n\t\t\tconsole.log(\"Imagen test\");\r\n\t\t\t$('#imgCurrentUser').attr(\"src\", \"/profileImgTest.png\");\r\n\t\t}\r\n\t},\r\n\t'tweets': function(username){\r\n\t  \tMeteor.call('tweetsPublish', username, function(err, res) {\r\n\t    \tSession.set('numTweets',res);\r\n\t  \t});\r\n\t  \treturn Session.get('numTweets');\r\n\t},\r\n  \t'following': function(){\r\n\t\tMeteor.call('usersFollowings', function(err, res) {\r\n      \t\tSession.set('numFollowings',res);\r\n    \t});\r\n    \treturn Session.get('numFollowings');\r\n  \t},\r\n  \t'followers': function(){\r\n\t    Meteor.call('usersFollowers', function(err, res) {\r\n\t      \tSession.set('numFollowers',res);\r\n\t    });\r\n    \treturn Session.get('numFollowers');\r\n  \t},\r\n  \t'userHaveSN' : function(dataUserFound){\r\n\t    if((dataUserFound.userWhats) && (dataUserFound.userFb) && (dataUserFound.userInsta)){\r\n\t      return false;\r\n\t    } else {\r\n\t      return true;\r\n\t    }\r\n  \t},\r\n});","Template.followUsers.events({ \r\n  'submit form': function(event) {\r\n\r\n    var searchUser = event.target.searchUser.value;\r\n    var foundUser = Meteor.call('findUser', searchUser, function(err, res) {\r\n      if (res) Session.set('foundUser', res);\r\n    });\r\n    return false;\r\n  }, \r\n\r\n  'click #follow': function() {\r\n    Meteor.call('followUser', Session.get('foundUser').username);\r\n  },\r\n\r\n  'click #followRec': function(event) {\r\n    Meteor.call('followUser', this.username);\r\n  }\r\n});\r\n\r\nTemplate.followUsers.helpers({ \r\n  'foundUser': function() {\r\n    return Session.get('foundUser');\r\n  },\r\n\r\n  'recommendedUsers': function() {\r\n    return Session.get('recommendedUsers');\r\n  }\r\n});\r\n\r\n\r\nTemplate.followUsers.onRendered(function () { \r\n  Meteor.call('recommendUsers', function(err, res) {\r\n    Session.set('recommendedUsers', res);\r\n  });\r\n});\r\n","Template.navBarTemplate.onCreated( function() {\r\n\tSession.set('sizeDisplay', $(window).width());\r\n\tSession.set('navBarCollapse', false);\r\n\tSession.set('currentUser', Meteor.user().username);\r\n\r\n\t//PEDIMOS PERMISO AL USUARIO PARA MOSTRARLE NOTIFICACIONES\r\n\tconsole.log(navigator.platform);\r\n\r\n\t/*\r\n\tHAY QUE CONTROLAR ESTO PORQUE NO FUNCIONA EL NOTIFICATION EN IPHONE\r\n\tif(navigator.platform != 'iPad' || navigator.platform != 'iPhone' || navigator.platform != 'iPod'){\r\n\t\tNotification.requestPermission();\r\n\t}\r\n\t*/\r\n\r\n});\r\n\r\n//ESTA ES OTRA FORMA DE HACER APARECER EL SPINNER CUANDO NO SE HA CARGADO LA TEMPLATE\r\n/*\r\n\tSession.set(\"onRender\", true);\r\n});\r\n\r\nTemplate.navBarTemplate.onRendered(function() {\r\n\tSession.set(\"onRender\", false);\r\n    return Session.get(\"onRender\");\r\n});\r\n*/\r\nTemplate.navBarTemplate.events({\r\n\t'click #recommendationsBtn' : function(){\r\n\t\t//console.log(\"A quien seguir\");\r\n\t},\r\n\t'click #imgProfile' : function(){\r\n\t\twindow.location = \"/Profile/\" + Session.get('currentUser');\r\n\t},\r\n\t'click #imgLogTwiiterClone' : function(){\r\n\t\twindow.location = \"/\";\r\n\t},\r\n\t'show.bs.collapse' : function(){\r\n\t\tSession.set('navBarCollapse', true);\r\n\t},\r\n\t'hide.bs.collapse' : function(){\r\n\t\tSession.set('navBarCollapse', false);\r\n\t},\r\n\t'click #btnNewTweet' : function(){\r\n\t    Session.set('commentMode', false);\r\n  \t},\r\n  \t'click #btnNewTwiit' : function(){\r\n\t    Session.set('commentMode', false);\r\n  \t}\r\n});\r\n\r\nTemplate.navBarTemplate.helpers({\r\n\t'notificationCount': function() {\r\n\t\tconsole.log(\"NUMERO DE NOTIFICACIONES NORMALES\");\r\n\t    var resultNotif = UserUtils.findNumberNotif(Meteor.user().username);\r\n\t    return resultNotif;\r\n\t},\r\n\t'whatsNotifCount' : function(){\r\n\t\t//OBTENEMOS EL NUMERO DE NOTIFICACIONES DE LAS PETICIONES DE WHATSAPP Y LAS \r\n\t\t//RESPUESTAS A LAS PETICIONES REALIZADAS POR EL USUARIO\r\n\t\tresultNotifRequest = Notifications.find({recepNotif: Meteor.user().username, read: false, typeOfNotif: \"whatsAppNotif\"});\r\n\t\tresultNotifResponse = Notifications.find({recepNotif: Meteor.user().username, read: false, typeOfNotif: \"responseWhatsAppNotif\"});\r\n\t\tauxTotalCount = 0;\r\n\r\n\t\tif(resultNotifRequest.count() > 0){\r\n\t\t\tauxTotalCount = resultNotifRequest.count();\r\n\t\t\tif(resultNotifResponse.count() > 0){\r\n\t\t\t\tauxTotalCount += resultNotifResponse.count();\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tif(resultNotifResponse.count() > 0){\r\n\t\t\t\tauxTotalCount = resultNotifResponse.count();\r\n\t\t\t};\r\n\t\t}\r\n\t\t//NO SE ESTA OBTENIENDO CORRECTAMENTE ESTE TIPO DE NOTIF\r\n\t\t//REVISAR publications.js\r\n\t\tconsole.log(resultNotifResponse);\r\n\t\tconsole.log(resultNotifResponse.count());\r\n\r\n\t\t//DEVOLVEMOS LA SUMA TOTAL DE LAS NOTIFICACIONES\r\n\t\tif(auxTotalCount > 0){\r\n\t\t\treturn auxTotalCount;\r\n\t\t}\r\n\t},\r\n\t'whatsAppReq' : function(){\r\n\t\tconsole.log(\"NUMERO DE NOTIFICACIONES DE PETICIONES DE WHATSAPP\");\r\n\t\t\r\n\t    var cont = 0;\r\n\t    var req = [];\r\n\t    var res = [];\r\n\r\n\t    resultNotifRequest.forEach(function(item){\r\n\t       req.push(item._id);\r\n\t       cont++;\r\n\t    });\r\n\r\n\t    resultNotifResponse.forEach(function(item){\r\n\t       res.push(item._id);\r\n\t       cont++;\r\n\t    }); \r\n\r\n\t    if(cont > 0){      \r\n\t      Session.set('whatsAppRequest', true);\r\n\t      Session.set('requestWhats', req);\r\n\t      Session.set('responseWhats', res);\r\n\t      return true;\r\n\t    } else {\r\n\t    \tSession.set('whatsAppRequest', false);\r\n\t    \treturn false;\r\n\t    }\r\n\t},\r\n\t'infoStateCollapseNavBar': function() {\r\n\t  return Session.get('navBarCollapse');\r\n\t},\r\n\t'userImgFound': function(){\r\n\t\tMeteor.call('findUserData', Meteor.user().username, function(err, res) {\r\n\t\t\tif(res.userImg){\r\n\t\t\t\tMeteor.call('findUserImg', res.userImg, function(err, res) {\r\n\t\t\t\t\t$('#imgProfile').attr(\"src\", res);\t\r\n\t\t\t  \t});\r\n\t\t\t} else {\r\n\t\t\t\t$('#imgProfile').attr(\"src\", \"/profileImgTest.png\");\r\n\t\t\t}\r\n\t\t\t\r\n\t  \t});\r\n\t}\r\n});\r\n//PARA CONTROLAR SI SE CAMBIA EL TAMAÑO DE PANTALLA\r\n$(window).resize(function(){\r\n\tconsole.log(\"Change Display Size\");\r\n\tSession.set('sizeDisplay', $(window).width());\r\n});\r\n","Template.notifications.onCreated(function() { \r\n  //console.log(\"Usuario: \"); \r\n  //console.log(Meteor.user().username);\r\n  Meteor.subscribe('notifications', Meteor.user().username);\r\n});\r\n\r\nTemplate.notifications.helpers({\r\n  modeDisplay: function() {\r\n    var size = Session.get('sizeDisplay');\r\n    if(size > 768){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  notifications: function() {\r\n    return Notifications.find({recepNotif: Meteor.user().username, read: false});\r\n  },\r\n  notificationCount: function(){\r\n    /*\r\n    var followings = UserUtils.findFollowings(Meteor.user().username);\r\n    return Notifications.find({twiitNotifUserName: { $nin: followings }, read: false}).count();\r\n    */\r\n    return UserUtils.findNumberNotif(Meteor.user().username);\r\n  },\r\n  'infoStateCollapseNavBar': function() {\r\n    return Session.get('navBarCollapse');\r\n  }\r\n});\r\n\r\n/*\r\nTemplate.notificationItem.helpers({\r\n  notificationTwiitPath: function() {\r\n    var path = this.twiitId;\r\n    console.log(path);\r\n    return path;\r\n  }\r\n});\r\n\r\n\r\nTemplate.notificationItem.events({\r\n  'click a': function() {\r\n    Notifications.update(this._id, {$set: {read: true}});\r\n  }\r\n});\r\n*/","Template.notificationsNew.onCreated(function() { \r\n  //console.log(\"Usuario: \"); \r\n  //console.log(Meteor.user().username);\r\n  Meteor.subscribe('notifications', Meteor.user().username);\r\n});\r\n\r\nTemplate.notificationsNew.helpers({\r\n  modeDisplay: function() {\r\n    var size = Session.get('sizeDisplay');\r\n    if(size > 768){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  notifications: function() {\r\n    //followings = UserUtils.findFollowings(Meteor.user().username);\r\n    console.log(Meteor.user().username);\r\n    return Notifications.find({recepNotif: Meteor.user().username, read: false});\r\n  },\r\n  notificationCount: function(){\r\n    /*\r\n    var followings = UserUtils.findFollowings(Meteor.user().username);\r\n    return Notifications.find({twiitNotifUserName: { $nin: followings }, read: false}).count();\r\n    */\r\n    numNotif = UserUtils.findNumberNotif(Meteor.user().username);\r\n\r\n    return numNotif;\r\n  },\r\n  'infoStateCollapseNavBar': function() {\r\n    return Session.get('navBarCollapse');\r\n  },\r\n  'currentUser': function(){\r\n    return Meteor.user().username;\r\n  }\r\n});\r\n\r\nTemplate.notificationsNew.events({\r\n  \r\n  'click #linkToNotif' : function(){\r\n    if(numNotif > 0){\r\n\r\n      window.location = \"/Notifications/\" + Meteor.user().username;\r\n    }\r\n  }\r\n  \r\n});","Template.removeProfile.events({  \r\n\t'click #remove': function() { \r\n    var userToRemove = new Object();\r\n    var aux = Session.get('dataUser');\r\n\r\n    userToRemove.id = aux.userId;\r\n    userToRemove.name = aux.userNameProfile;\r\n\r\n    console.log(userToRemove);\r\n\r\n    Meteor.call('removeThisUser', userToRemove);\r\n\r\n    window.location = \"/\";\r\n\t},\r\n  'click #noRemove': function(){\r\n    //HAY QUE DECIRLE AL MODAL QUE SE CIERRE\r\n    $('#dialog-removeProfile').modal('hide');\r\n  }\r\n});","Template.sendRequest.onRendered(function(){\r\n\r\n});\r\n\r\nTemplate.sendRequest.events({\r\n  \t'click #sent': function(){\r\n\r\n  \t\tvar notif = new Object();\r\n  \t\t\r\n  \t\tnotif.recepNotif = Session.get('userToSentPet'); //EL USUARIO QUE VA A RECIBIR LA PETICION\r\n  \t\tnotif.actorNotif = Meteor.user().username; //EL USUARIO QUE REALIZA LA PETICION\r\n  \t\tnotif.timestamp = new Date();\r\n  \t\tnotif.typeOfNotif = \"whatsAppNotif\";\r\n\r\n  \t\tMeteor.call('createWhatsAppNotification', notif);\r\n  \t\t$('#dialog-showSocialNetwork').modal('hide');\r\n  \t\t//POR ULTIMO INFORMAMOS AL USUARIO QUE LA PETICION SE HA ENVIADO\r\n\r\n  \t\t$('#dialog-operationSuccess').modal('show');\r\n  \t}, \r\n  \t'click #noSent': function(){\r\n  \t\t$('#dialog-showSocialNetwork').modal('hide');\r\n  \t}\r\n});\r\n\r\nTemplate.sendRequest.helpers({\r\n  \t'userNameToSentPet': function(){\r\n    \treturn Session.get('userToSentPet');\r\n  \t}\r\n});  ","Template.showSocialNetwork.onRendered(function(){\r\n\r\n});\r\n\r\nTemplate.showSocialNetwork.events({\r\n  \t'click #sent': function(){\r\n\r\n  \t}, \r\n  \t'click #noSent': function(){\r\n  \t\t\r\n  \t}\r\n});\r\n\r\nTemplate.showSocialNetwork.helpers({\r\n  \t'userNameToSentPet': function(){\r\n    \treturn Session.get('userToSentPet');\r\n  \t},\r\n  \t'showProfileOtherUser' : function(){\r\n\t\treturn Session.get('showProfileOtherUser');\r\n\t}\r\n});   \r\n\r\n\r\n//EN EL MODAL EMERGENTE QUE MSTRARÁ LA INFORMACION AÑADIDA DEL USUARIO SOBRE SU RED SOCIAL\r\n//SE IMPLEMENTARA QUE PINCHE EN EL NOMBRE DE USUARIO Y QUE SE REDIRIJA LA PAGINA A LA \r\n//PAGINA DE PERFIL DE USUARIO QUE CORRESPONDA\r\n\r\n//EN INSTAGRAM SE REDIRIGIRÁ A: https://www.instagram.com/{{currentUser.userInsta}}/\r\n//EN FACEBOOK SE REDIRIGIRÁ A: https://www.facebook.com/search/all/?q={{currentUser.userFb}}\r\n\r\n//EL CASO DE WHATSAPP ES MAS DIFERENTE. LO QUE HAREMOS SERÁ SOLICITAR AL USUARIO QUE SI QUIERE\r\n//AÑADIR EL NUMERO DE TELEFONO EN SU AGENDA (SOLO PARA DISPOSITIVOS MÓVILES)","Template.socialNetworkBox.onRendered(function(){\r\n  selectOptions = Session.get('optionsAva');\r\n  currentDataUser = Session.get('datauser');\r\n  Session.set('inputNotEmpty', true);\r\n  Session.set('removeDataSN', false);\r\n});\r\n\r\nTemplate.socialNetworkBox.events({\r\n  \t'click #btnNewSN': function(){\r\n  \t\tvar numSocialNetworks = Session.get('countSocialNetworks');\r\n\r\n  \t\tif(numSocialNetworks < 3){\r\n\r\n        var avaSelecOptions = \"\";\r\n        var selectOptionsArray = Session.get('optionsAva');\r\n\r\n        for (var i = 0; i < selectOptionsArray.length; i++) {\r\n          avaSelecOptions += \"<li><a href='#'>\" + selectOptionsArray[i] + \"</a></li>\";\r\n        }\r\n  \t\t\t\r\n  \t\t\t$('#containerInputs').append(\"<div class='input-group' id='inputGroup\" + numSocialNetworks + \"' style='margin-bottom: 10px;'>\"\r\n  \t\t\t\t+ \"<div class='input-group-btn'>\"\r\n  \t\t\t\t+ \"<button id='\" + numSocialNetworks + \"' type='button' class='btn btn-default dropdown-toggle btnDropDown btnOptionsSN' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>Choose\"\r\n  \t\t\t\t+ \"<span class='caret'></span>\"\r\n  \t\t\t\t+ \"</button>\"\r\n  \t\t\t\t+ \"<ul id='dropdownMenu\" + numSocialNetworks + \"' class='dropdown-menu'>\"\r\n  \t\t\t\t+ avaSelecOptions\r\n  \t\t\t\t+ \"</ul>\"\r\n  \t\t\t\t+ \"</div>\"\r\n  \t\t\t\t+ \"<input required id='input\" + numSocialNetworks + \"' type='text' class='form-control inputSN inputNewSN' aria-label='...' placeholder='Username...'>\"\r\n  \t\t\t\t+ \"<button id='clearDataUser\" + numSocialNetworks + \"' type='button' class='btn btn-danger' aria-haspopup='true' aria-expanded='false'>\"\r\n          + \"<span id='\" + numSocialNetworks + \"' class='glyphicon glyphicon-remove'></span>\"\r\n          + \"</button>\"\r\n          + \"</div>\");\r\n  \t\t  numSocialNetworks++;\r\n        Session.set('countSocialNetworks', numSocialNetworks);\r\n      };\r\n\r\n      if(numSocialNetworks === 3){\r\n        $('#btnNewSN').hide();\r\n        Session.set('removeDataSN', false);\r\n      };\r\n  \t},\r\n  \t'click .btnDropDown': function(event){\r\n  \t\tSession.set('btnTap', event.target.id);\r\n  \t},\r\n  \t'click .dropdown-menu li a': function(event){\r\n  \t\tvar btnTap = Session.get('btnTap');\r\n  \t\tvar selectOption = event.target.text;\r\n      //AÑADIR A UN ARRAY LAS SELECCIONES QUE HACEMOS PARA QUE NO SE PUEDAN REPETIR.\r\n      //ES DECIR, UN USUARIO SOLO VA A PODER ENLAZAR 1 CUENTA DE FACEBOOK, INSTAGRAM \r\n      //O WHATSAPP.\r\n      var arrOptions = Session.get('optionsAva');\r\n\r\n      var numSele = arrOptions.indexOf(selectOption);\r\n      if(numSele >= 0){\r\n        arrOptions.splice(numSele, 1);\r\n      } \r\n\r\n      //VAMOS A COMPROBAR QUE SI selectOption ES WHATSAPP LE VAMOS A PONER AL INPUT UN FORMATO PARA QUE \r\n      //EL USUARIO SOLO PUEDA INTRODUCIR NUMEROS\r\n      if(selectOption === \"WhatsApp\"){\r\n        $('#input' + btnTap).attr(\"type\", \"number\");\r\n      }\r\n\r\n      //UNA VEZ SELECCIONADO LA OPCION DEL DROPDOWN, TRANSFORMAMOS EL DROPDOWN A UN BTN DESHABILITADO\r\n      $('#'+ btnTap).html(selectOption);\r\n\r\n      $('#dropdownMenu'+ btnTap).remove();\r\n\r\n      Session.set('optionsAva', arrOptions);\r\n  \t},\r\n    'click .btn-danger': function(event){\r\n\r\n      //GUARDAMOS EL ID (numero entre 0 y 2) PARA DESPUES IDENTIFICAR EL INPUT-GROUP Y ASI ELIMINAR LOS DATOS DE MONGODB\r\n      var selectOption = event.target.id;\r\n      //AHORA BUSCAMOS EL CAMPO A ELIMINAR Y LLAMAMOS AL METODO DE userData.js\r\n      var btnToRem = $('#' + selectOption).text();\r\n      var newData = new Object();\r\n\r\n      if(btnToRem != 'Choose'){\r\n        newData.userId = Session.get('datauser')._id;\r\n        newData.propertyToRem = btnToRem;\r\n\r\n        Meteor.call('removeDataSocialNetworks', newData);\r\n      };\r\n      \r\n      //POR ULTIMO VAMOS A INFORMAR AL USUARIO QUE SE HA ELIMINADO LA RED SOCIAL\r\n      //PARA ELLO, VAMOS A ELIMINAR EL inputGroup DE LA SN QUE SE HA ELIMINADO\r\n      $('#inputGroup' + selectOption).remove();\r\n      Session.set('removeDataSN', true);\r\n\r\n      //ACTUALIZAMOS EL VALOR DE optionsAva EN Session.keys\r\n      var auxOptions = Session.get('optionsAva');\r\n\r\n      if(btnToRem != \"Choose\"){\r\n        if(auxOptions.indexOf(newData.propertyToRem) === -1){\r\n          auxOptions.push(newData.propertyToRem);\r\n          Session.set('optionsAva', auxOptions);\r\n        };\r\n      };\r\n\r\n      //ACTUALIZAMOS EL VALOR DE countSocialNetworks EN Session.keys\r\n      var auxCount = Session.get('countSocialNetworks');\r\n      auxCount--;\r\n      Session.set('countSocialNetworks', auxCount);\r\n\r\n      //CUANDO SE BORRA UN INPUTGROUP HAY QUE REESTABLECER LOS ID PARA QUE EMPIECEN POR 0 HASTA 2\r\n\r\n      for (var i = 0; i < auxCount; i++) {\r\n        $('.input-group').attr('id', 'inputGroup' + i);\r\n\r\n        $('.btnOptionsSN').attr('id', i);\r\n\r\n        $('.dropdown-menu').attr('id', 'dropdownMenu' + i);\r\n\r\n        $('.inputSN').attr('id', 'input' + i);\r\n\r\n        $('.glyphicon-remove').attr('id', i);\r\n\r\n        $('.btn-danger').attr('id', 'clearDataUser' +  i);\r\n      }\r\n\r\n      if(auxCount < 3){\r\n        Session.set('modeToAdd', true);\r\n        $('#btnNewSN').show();\r\n      }\r\n    },\r\n  \t'click #saveData': function(){\r\n  \t\t//DE ESTA MANERA OBTENEMOS TODOS LOS BLOQUES QUE HEMOS AÑADIDO DINÁMICAMENTE\r\n  \t\t//HAY QUE OBTENER TODOS LOS VALORES SELECCIONADOS EN CADA DROPDOWN Y EL CONTENIDO DE SUS RESPECTIVOS INPUT\r\n  \t\t//TODO\r\n      var valuesInput = [];\r\n  \t\tvar valuesButton = [];\r\n      var foundInputNewSN = false;\r\n\r\n      //PARA CADA CASO HAY QUE COMPROBAR QUE LOS INPUT QUE TIENEN, ESTAN RELLENADOS. EN EL CASO DE LAS REDES QUE \r\n      //YA EXISTEN EN MNONGODB, SE COGERÁ SU PLACEHOLDER.\r\n      if(Session.get('modeToAdd') === true){\r\n        //ESTE ES EL CASO QUE SE DA CUANDO SE HA INTRODUCIDO UNA NUEVA RED SOCIAL PARA ANIADIRLA A MONGODB\r\n        //ESTE CASO SALTA CUANDO SE HA DADO AL BOTON DE addNewSN\r\n\r\n        //RECORREMOS LOS INPUT QUE VIENEN DIRECTAMENTE DE MONGODB\r\n        $('.inputSN').each(function() {\r\n          if($(this).val() === \"\"){\r\n            valuesInput.push($(this).attr('placeholder'));\r\n          } else {\r\n            valuesInput.push($(this).val());\r\n          }\r\n        });\r\n\r\n        //RECORREMOS LOS INPUT CREADOS CON EL BTN addNewSN\r\n        $('.inputNewSN').each(function(){\r\n          if($(this).val() != \"\"){\r\n            valuesInput.push($(this).val());\r\n            Session.set('inputNotEmpty', true);\r\n          } else {\r\n            Session.set('inputNotEmpty', false);\r\n          }\r\n          foundInputNewSN = true;\r\n        });\r\n\r\n        if(foundInputNewSN){\r\n          valuesInput.splice(valuesInput.length - 1, 1);\r\n          foundInputNewSN = false;\r\n        }\r\n\r\n      } else {\r\n        //ESTE CASO SE PRODUCE CUANDO LAS REDES QUE SE MUESTRAN AL USUARIO SON TODAS YA EXISTENTES EN MONGODB\r\n        //POR TANTO, SOLO RECORREMOS LOS INPUT QUE VIENEN DIRECTAMENTE DE MONGODB\r\n        $('.inputSN').each(function() {\r\n          if($(this).val() === \"\"){\r\n            valuesInput.push($(this).attr('placeholder'));\r\n          } else {\r\n            valuesInput.push($(this).val());\r\n          }\r\n        });\r\n\r\n        Session.set('inputNotEmpty', true);\r\n      };\r\n\r\n      //RECOGEMOS LOS VALORES DE LOS BOTONES DESACTIVADOS (NOMBRES REDES SOCIALES)\r\n      $('.btnOptionsSN').each(function() {\r\n        valuesButton.push($(this).text());\r\n      });\r\n\r\n      //ESTA PARTE ESTA CORRECTA\r\n      if(Session.get('inputNotEmpty')){\r\n        //COMPROBAMOS QUE SE HA INTRODUCIDO ALGUN VALOR O SELECCIONADO ALGUNA RED SOCIAL PARA AÑADIRLA\r\n        if(valuesInput && valuesButton){\r\n          //AHORA OBTENEMOS EL _id DEL USUARIO Y LO AÑADIMOS AL OBJETO QUE LE VAMOS A PASAR \r\n          //A LA LLAMADA A userData.js QUE SE ENCARGARÁ DE ACTUALIZAR EL REGISTRO.\r\n          var newData = new Object();\r\n          newData.userId = Session.get('datauser')._id;\r\n\r\n          for ( i = 0; i < valuesButton.length; i++ ){\r\n            var valu = valuesButton[i];\r\n            var num = valuesButton.indexOf(valu);\r\n\r\n            if(num >= 0){\r\n              if(\"WhatsApp\" === valu ){\r\n                newData.userWhats = valuesInput[num];\r\n              } else if(\"Facebook\" === valu){\r\n                newData.userFb = valuesInput[num];\r\n              } else if(\"Instagram\" === valu ){\r\n                newData.userInsta = valuesInput[num];\r\n              }\r\n            }\r\n          }\r\n          //POR ULTIMO, REALIZAMOS LA LLAMADA A userData.js\r\n          Meteor.call('updUserDataSocialNetworks', newData);\r\n        }\r\n        \r\n\r\n        //HAY QUE DECIRLE AL MODAL QUE SE CIERRE\r\n        $('#dialog-NewSocialNetwork').modal('hide');\r\n      }\r\n\r\n      //EN EL CASO DE QUE SE DE CLICK A SALVAR DATOS DESPUES DE HABER ELIMINADO UNA RED SOCIAL\r\n      //SE TENDRÁ QUE DECIR AL SISTEMA QUE CAMBIE LA OPCION DE EDITAR SN A AÑADIR SN\r\n      if(Session.get('removeDataSN')){\r\n        Session.set('modeToAdd', false);\r\n        Session.set('removeDataSN', false);\r\n      };\r\n  \t},\r\n});\r\n\r\nTemplate.socialNetworkBox.helpers({\r\n  'modeAddNewSN': function(){\r\n    var result = new Object();\r\n\r\n    var currentDataUser = Session.get('datauser');\r\n\r\n    var selectOptions = [\"WhatsApp\", \"Instagram\", \"Facebook\"];\r\n    var numSocialNetworks = 0;\r\n\r\n    var datauserSN = [];\r\n\r\n    if(currentDataUser.userWhats){\r\n      var numSele = selectOptions.indexOf(\"WhatsApp\");\r\n      selectOptions.splice(numSele, 1);\r\n      numSocialNetworks += 1;\r\n      datauserSN.push(currentDataUser.userWhats);\r\n    }\r\n\r\n    if(currentDataUser.userFb){\r\n      var numSele = selectOptions.indexOf(\"Facebook\");\r\n      selectOptions.splice(numSele, 1);\r\n      numSocialNetworks += 1;\r\n      datauserSN.push(currentDataUser.userFb);\r\n    }\r\n\r\n    if(currentDataUser.userInsta){\r\n      var numSele = selectOptions.indexOf(\"Instagram\");\r\n      selectOptions.splice(numSele, 1);\r\n      numSocialNetworks += 1;\r\n      datauserSN.push(currentDataUser.userInsta);\r\n    }\r\n\r\n    Session.set('getDataUserSN', datauserSN);\r\n\r\n    Session.set('countSocialNetworks', numSocialNetworks);\r\n\r\n    Session.set('optionsAva', selectOptions);\r\n\r\n\r\n    if(selectOptions.length > 0 && selectOptions.length <= 3){\r\n      result.messageMode = \"Añade tu red social a twiiterClone\";\r\n      Session.set('modeToAdd', true);\r\n    } else if(selectOptions.length === 0){\r\n      //POR ULTIMO VAMOS A AÑADIR LOS CAMPOS PARA PODER SER EDITADOS\r\n      var aux = [\"WhatsApp\", \"Facebook\", \"Instagram\"];\r\n      var contentToAppend = [];\r\n      for (var i = 0; i < numSocialNetworks; i++) {\r\n        var objAux = new Object();\r\n        objAux.id = i;\r\n        objAux.valueBtn = aux[i];\r\n        objAux.placeholder = datauserSN[i];\r\n\r\n        contentToAppend.push(objAux);\r\n      }\r\n      result.messageMode = \"Edita tu red social\";\r\n      Session.set('appendThis', contentToAppend);\r\n      Session.set('modeToAdd', false);\r\n    } \r\n\r\n    return result;\r\n  },\r\n\r\n  'contentToAppend': function(){\r\n    return Session.get('appendThis');\r\n  },\r\n\r\n\t'userHaveSN' : function(){\r\n    if(Session.get('optionsAva').length > 0){\r\n      return true;\r\n    } else if(Session.get('modeToAdd')){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n});   ","//DETECTAMOS QUE SE ENCUENTRA EN EL CLIENTE EL CODIGO QUE SE VA  AEJECUTAR\r\nif(Meteor.isClient){\r\n\r\n\tTemplate.tweetBox.onRendered(function(){\r\n\t  Session.set('numChars', 0);\r\n\t});\r\n\r\n\tTemplate.tweetBox.events({\r\n\t  \t'input #tweetText':function(){\r\n\t    \tSession.set('numChars', $('#tweetText').val().length);\r\n\t  \t},\r\n\t  \t'click button': function() {  \r\n\t\t\tvar message = $('#tweetText').val();\r\n\t\t\tvar type = Session.get('commentMode');\r\n\r\n\t\t\tif(type){\r\n\t\t\t\tvar twiitId = Session.get('idCurrentTwiit');\r\n\t\t\t\tvar numComment = UserUtils.findNumComment(twiitId);\r\n\t\t\t\tnumComment++;\r\n\t\t\t}\r\n\r\n\t\t\t$('#tweetText').val(\"\");\r\n\t\t\tSession.set('numChars', 0);\r\n\r\n\t\t\tvar tweet = new Object();\r\n\t\t\ttweet.message = message;\r\n\t\t\ttweet.type = type;\r\n\r\n\t\t\tif(twiitId != null){\r\n\t\t\t\ttweet.twiitId = twiitId;\r\n\t\t\t\ttweet.numComment = numComment;\r\n\t\t\t\ttweet.typeOfNotif = \"comment\";\r\n\t\t\t\t//recepNotif\r\n\t\t\t\ttweet.recepUser = UserUtils.findUserFromTwiit(twiitId);\r\n\t\t\t} else {\r\n\t\t\t\ttweet.typeOfNotif = \"twiit\";\r\n\t\t\t\t//recepNotif\r\n\t\t\t\ttweet.recepUser = Meteor.user().username;\r\n\t\t\t}\r\n\r\n\t\t\ttweet.actorUser = Meteor.user().username;\r\n\r\n\t\t\tMeteor.call('insertTweet', tweet);\r\n\t    }\r\n\t});\r\n\r\n\r\n\tTemplate.tweetBox.helpers({  \r\n\t  charCount: function() {\r\n\t    return 140 - Session.get('numChars');\r\n\t  },\r\n\r\n\t  charClass: function() {\r\n\t    if (Session.get('numChars') > 140) {\r\n\t      return 'errCharCount';    // o el nombre que le disteis en el fichero css\r\n\t    } else {\r\n\t      return 'charCount';       //o el nombre que le disteis en el fichero css\r\n\t    }\r\n\t  },\r\n\r\n\t  disableButton: function() {\r\n\t    if (Session.get('numChars') <= 0 ||\r\n\t        Session.get('numChars') > 140 || \r\n\t        !Meteor.user()) {\r\n\t      return 'disabled';\r\n\t    }\r\n\t  }\r\n\t});\r\n}","Template.tweetFeed.onCreated(function() {  \r\n\tthis.subscribe('twitts');\r\n  this.subscribe('favs');\r\n});\r\n\r\nTemplate.tweetFeed.helpers({  \r\n  'tweetMessage': function() {\r\n    var tweet =  Twitts.find({}, {sort: {timestamp: -1}} );\r\n    return tweet;\r\n  },\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.timestamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n    return dateCon;\r\n  },\r\n  'numComment': function(){\r\n    var num = UserUtils.findNumComment(this._id);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var num = UserUtils.findNumberFavPerTwiit(this._id);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  },\r\n  'infoNotif': function(){\r\n    var username = Meteor.user().username;\r\n\r\n    var numNotif = UserUtils.findNumberNotif(username);\r\n    //PRIMERO TENEMOS QUE COMPROBAR SI HAY NOTIFICACIONES\r\n    if(numNotif === 1){\r\n      //BUSCAMOS LAS NOTIFICACIONES DISPONIBLES\r\n      var notif = UserUtils.findOneNotification(username);\r\n\r\n      UserUtils.createNotifToBrowser(notif.typeOfNotif, notif.actorNotif);\r\n    } else if(numNotif > 1){\r\n      UserUtils.createNotifToBrowser(\"moreNotif\", username);\r\n    }\r\n  }\r\n});\r\n\r\nTemplate.tweetFeed.events({\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n\r\n    console.log(this._id);\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var userTapFav = UserUtils.findFavsForTwiit(this._id);\r\n\r\n    //HACEMOS UNA COMPROBACION DE QUE EL TWIIT NO TIENE NINGUN FAV O QUE SI LO TIENE\r\n    if(!userTapFav){\r\n      //console.log(\"No tiene FAVS\");\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      var arrAux = userTapFav.idUserTapFav;\r\n    }\r\n    \r\n    //SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = this._id;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(this._id);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÁ ESTE OTRO MÉTODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },\r\n  'click #btnComm' : function(){\r\n    var numComment = UserUtils.findNumComment(this._id);\r\n    //SI EL TWIIT TIENE POR LO MENOS 1 COMENTARIO, ENTONCES REDIRIGIMOS AL USUARIO A \r\n    //LA RUTA /Comments. SI NO, SE ABRE EL MODAL Y SE PUEDE HACER EL COMENTARIO\r\n    if(numComment === 0){\r\n        $(\"#dialog-NewTwiit\").modal();\r\n        Session.set('commentMode', true);\r\n        Session.set('idCurrentTwiit', this._id);\r\n    }\r\n  }\r\n});","Template.tweetFeedProfile.onCreated(function() {  \r\n\tthis.subscribe('twittsProfile');\r\n  this.subscribe('favs');\r\n});\r\n\r\nTemplate.tweetFeedProfile.helpers({  \r\n  'tweetMessageProfile': function() {\r\n    var tweet =  Twitts.find({}, { \r\n        sort: {timestamp: -1}, \r\n        limit: 10\r\n    });\r\n    return tweet;\r\n  },\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.timestamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n    return dateCon;\r\n  },\r\n  'numComment': function(){\r\n    var num = UserUtils.findNumComment(this._id);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var num = UserUtils.findNumberFavPerTwiit(this._id);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  }\r\n});\r\n\r\nTemplate.tweetFeedProfile.events({\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var userTapFav = UserUtils.findFavsForTwiit(this._id);\r\n    var arrAux = userTapFav.idUserTapFav;\r\n\r\n    //SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = this._id;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(this._id);\r\n\r\n      console.log(notif);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÁ ESTE OTRO MÉTODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },/*\r\n  'click #btnComm' : function(){\r\n    var numComment = UserUtils.findNumComment(this._id);\r\n    //SI EL TWIIT TIENE POR LO MENOS 1 COMENTARIO, ENTONCES REDIRIGIMOS AL USUARIO A \r\n    //LA RUTA /Comments. SI NO, SE ABRE EL MODAL Y SE PUEDE HACER EL COMENTARIO\r\n    if(numComment === 0){\r\n        $(\"#dialog-NewTwiit\").modal();\r\n        Session.set('commentMode', true);\r\n        Session.set('idCurrentTwiit', this._id);\r\n    }\r\n  }*/   \r\n  'click .userNameProfile' : function(event){\r\n    window.location = \"/Profile/\" + event.target.id;\r\n  }\r\n})","Template.twiitCommentPage.onCreated(function() {  \r\n\tthis.subscribe('twittsWithComment');\r\n  \tthis.subscribe('favs');\r\n});\r\n\r\nTemplate.twiitCommentPage.helpers({\r\n\t//DEVUELVE EL MENSAJE ORIGINAL DEL QUE SE PRODUCEN LOS COMENTARIOS\r\n  'tweetMessage' : function(){\r\n  \t//HAY QUE CONSEGUIR PASAR A ESTA VISTA EL this._id DE tweetFeed PARA PODER \r\n  \t//DEVOLVER EL TWEET INICIAL Y DE AHI PASAR A MOSTRAR CON tweetThatCommentMessage\r\n  \t//TODOS LOS COMENTARIOS QUE TENGA!\r\n  \tif(this.mode){\r\n  \t\tid = UserUtils.findTwiitFromNotif(this._id);\r\n  \t\treturn Twitts.find( id, {sort: {timestamp: -1}});\r\n  \t} else {\r\n  \t\treturn Twitts.find( this._id, {sort: {timestamp: -1}});\r\n  \t}\r\n  },\r\n  'tweetThatCommentMessage': function() {\r\n  \tif(this.mode){\r\n  \t\tid = UserUtils.findTwiitFromNotif(this._id);\r\n  \t\treturn Twitts.find({twiitIdComment : id}, {sort: {timestamp: -1}} );\r\n  \t} else {\r\n  \t\treturn Twitts.find({twiitIdComment : this._id}, {sort: {timestamp: -1}});\r\n  \t}\r\n  },\r\n  'convertDateTime': function() {\r\n    var dateNew = new Date(this.timestamp);\r\n    var dateCon = dateNew.toLocaleString();\r\n    return dateCon;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var num = UserUtils.findNumberFavPerTwiit(this._id);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  }\r\n});\r\n\r\nTemplate.twiitCommentPage.events({\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var userTapFav = UserUtils.findFavsForTwiit(this._id);\r\n    var arrAux = userTapFav.idUserTapFav;\r\n//SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(this._id, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = this._id;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(this._id);\r\n\r\n      console.log(notif);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÁ ESTE OTRO MÉTODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(this._id, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },\r\n  'click #btnComm' : function(){\r\n\t$(\"#dialog-NewTwiit\").modal();\r\n\tSession.set('idCurrentTwiit', this._id);\r\n\tSession.set('commentMode', true);\r\n  }\r\n});","Template.twiitPage.helpers({  \r\n  'convertDateTime': function() {\r\n  \tvar dateNew = new Date(this.twiitTimeStamp);\r\n  \tvar dateCon = dateNew.toLocaleString();\r\n    return dateCon;\r\n  },\r\n\r\n  'tweetMessage': function() {\r\n    console.log(this._id);\r\n    var notify =  Notifications.find({_id: this._id});\r\n    return notify;\r\n  },\r\n\r\n  'countNotifTwiit' : function(){\r\n    var num =  Notifications.find({_id: this._id}).count();\r\n    if(num === 0){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n});\r\n\r\nTemplate.twiitPage.events({\r\n  'click button': function() {\r\n    console.log(this._id);\r\n    Notifications.update(this._id, {$set: {read: true}});\r\n    console.log(\"Clean!\");\r\n    window.location = \"/\";\r\n  },\r\n});\r\n","Template.twiitPageNew.onCreated(function() {  \r\n  this.subscribe('twittsWithComment');\r\n  this.subscribe('favs');\r\n  this.subscribe('allNotifications');\r\n  arrWithId = [];\r\n  Session.set('notificationsModeOn', true);\r\n});\r\n\r\nTemplate.twiitPageNew.helpers({\r\n  'requestWhatsApp' : function(){\r\n    \r\n  }, \r\n  'convertDateTime': function() {\r\n  \tvar dateNew = new Date(this.twiitTimeStamp);\r\n  \tvar dateCon = dateNew.toLocaleString();\r\n    return dateCon;\r\n  },\r\n\r\n  'tweetMessage': function() {\r\n    return UserUtils.findNotifications(this.name);\r\n  },\r\n\r\n  'countNotifTwiit' : function(){\r\n    var numNotif =  UserUtils.findNumberNotif(this.name);\r\n    if(numNotif === 0){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  },\r\n\r\n  'saveIdInArr' : function(){\r\n    arrWithId.push(this._id);\r\n  },\r\n\r\n  'numFavPerTwiit' : function(){\r\n    return UserUtils.findNumberFavPerTwiit(this.twiitId);\r\n  },\r\n  'findNumComment' : function(){\r\n    //AQUI this._id ES EL _ID DE LA COLLECTION NOTIFICATIONS\r\n    //POR LO QUE HABRA QUE SACAR EL CAMPO twiitId\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n\r\n    var num = UserUtils.findNumComment(twiitId);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  },\r\n  'numComment': function(){\r\n    var num = UserUtils.findNumComment(UserUtils.findTwiitFromNotif(this._id));\r\n    return num;\r\n  }, \r\n  'idToFavBtn': function(){\r\n    return this._id;\r\n  },\r\n  'classFav': function(){\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n    var num = UserUtils.findNumberFavPerTwiit(twiitId);\r\n    if(num > 0){\r\n      return \"heartFav\";\r\n    } else return \"heartNoFav\";\r\n  },\r\n  'numFavorite': function(){\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n    var num = UserUtils.findNumberFavPerTwiit(twiitId);\r\n    if(num > 0){\r\n      return true;\r\n    } else return false;\r\n  },\r\n  'numFav': function(){\r\n    var twiitId = UserUtils.findTwiitFromNotif(this._id);\r\n    var num = UserUtils.findNumberFavPerTwiit(twiitId);\r\n    return num;\r\n  }\r\n});\r\n\r\nTemplate.twiitPageNew.events({\r\n  'click #btnDismissNotif': function() {\r\n    console.log(arrWithId);\r\n    for (var aux in arrWithId){\r\n      var id = arrWithId[aux];\r\n      Notifications.update(id, {$set: {read: true}});\r\n    }\r\n    window.location = \"/\";\r\n  },\r\n  'click #btnFav': function(){\r\n    var currentUser = Session.get('currentUser');\r\n    var idUser = Meteor.users.findOne({ username: currentUser })._id;\r\n\r\n    //BUSCAMOS A LOS USUARIOS QUE HAN DADO FAV AL TWIIT QUE SE HA PULSADO\r\n    var idAux = UserUtils.findTwiitFromNotif(this._id);\r\n    var userTapFav = UserUtils.findFavsForTwiit(idAux);\r\n    var arrAux = userTapFav.idUserTapFav;\r\n\r\n    //SI EL USUARIO YA LE HA DADO FAV A UN TWIIT, NO SE PERMITE DARLE MAS FAVS\r\n    if(arrAux.indexOf(idUser) === -1){\r\n      UserUtils.addFavToTwiit(idAux, idUser);\r\n\r\n      var notif = new Object();\r\n      notif._id = idAux;\r\n      notif.typeOfNotif = \"fav\";\r\n      notif.actorNotif = currentUser;\r\n      notif.recepNotif = UserUtils.findUserFromTwiit(idAux);\r\n\r\n      console.log(notif);\r\n\r\n      Meteor.call('createTwiitNotification', notif);\r\n\r\n      $(\"#\"+ this._id).addClass(\"heartFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartNoFav\");\r\n    } else {\r\n      //EN EL CASO DE QUE YA LE HAYA DADO A FAV Y QUIERA QUITAR EL FAV QUE LE HA DADO\r\n      //SE EJECUTARÁ ESTE OTRO MÉTODO QUE LO QUE HACE ES LO MISMO QUE addFavToTwiit PERO\r\n      //LA OPERACION INVERSA\r\n      UserUtils.removeFavToTwiit(idAux, idUser);\r\n      $(\"#\"+ this._id).addClass(\"heartNoFav\");\r\n      $(\"#\"+ this._id).removeClass(\"heartFav\");\r\n    }\r\n  },\r\n  'click #btnComm' : function(){\r\n    var numComment = UserUtils.findNumComment(UserUtils.findTwiitFromNotif(this._id));\r\n    //SI EL TWIIT TIENE POR LO MENOS 1 COMENTARIO, ENTONCES REDIRIGIMOS AL USUARIO A \r\n    //LA RUTA /Comments. SI NO, SE ABRE EL MODAL Y SE PUEDE HACER EL COMENTARIO\r\n    if(numComment === 0){\r\n        $(\"#dialog-NewTwiit\").modal();\r\n        Session.set('commentMode', true);\r\n        Session.set('idCurrentTwiit', UserUtils.findTwiitFromNotif(this._id));\r\n    }\r\n  }\r\n});","Template.userManagement.events({  \r\n  'click #signup': function() {\r\n    var user = {\r\n      username: $('#signup-nameProfile').val(),\r\n      password: $('#signup-password').val(),\r\n      profile: {\r\n        fullname: $('#signup-username').val()\r\n      }\r\n    };\r\n\r\n    Accounts.createUser(user, function (error) {\r\n      if(error) alert(error);\r\n    });\r\n\r\n    //Creamos el nuevo usuario en DataUser\r\n    var userData = new Object();\r\n    userData.userName = user.profile.fullname;\r\n    userData.userNameProfile = user.username;\r\n    userData.userImg = \"\";\r\n    userData.userDescription = \"\";\r\n    \r\n    Meteor.call('insertDataUser', userData);\r\n  },\r\n\r\n  'click #login': function() {\r\n    var username = $('#login-nameProfile').val();\r\n    var password = $('#login-password').val();\r\n\r\n    Meteor.loginWithPassword(username, password, function(error) {\r\n      if(error) alert(error);\r\n    });\r\n    loggingIn = true;\r\n  },\r\n\r\n  'click #recommendationsBtn': function() {  \r\n    Session.set('recommendations', true);\r\n  }\r\n});","Template.userProfile.onCreated(function(){\r\n\tcurrentUserName = this.data.name;\r\n});\r\n\r\nTemplate.userProfile.events({  \r\n\t'click #logout': function() {  \r\n    \tMeteor.logout();\r\n    \twindow.location = \"/\";\r\n  \t},\r\n  \t'click #editProfile': function(){\r\n  \t\twindow.location = \"/editProfile/\" + currentUserName;\r\n  \t},\r\n  \t'click .btnShowSN': function(event){\r\n\r\n  \t\tvar idSN = event.target.id;\r\n  \t\tif(idSN === \"Facebook\"){\r\n  \t\t\twindow.open(\"https://www.facebook.com/search/all/?q=\" + Session.get('dataUser').userFb);\r\n  \t\t} else if(idSN === \"Instagram\"){\r\n  \t\t\twindow.open(\"https://www.instagram.com/\" + Session.get('dataUser').userInsta + \"/\");\r\n  \t\t} else if(idSN === \"WhatsApp\"){\r\n  \t\t\t//EL CASO DE WHATSAPP ES MAS DIFERENTE. LO QUE HAREMOS SERÁ SOLICITAR AL USUARIO QUE SI QUIERE\r\n\t\t\t//AÑADIR EL NUMERO DE TELEFONO EN SU AGENDA (SOLO PARA DISPOSITIVOS MÓVILES)\r\n\t\t\t//EN EL CASO DE QUE EL USUARIO ACCEDA A LA APP POR DISPOSITIVOS NO MÓVILES, SE MOSTRARÁ UN MODAL\r\n\t\t\t//EN EL QUE INFORMARA AL USUARIO: ¿Quiere solicitar a {{currentUser.userName}} su numero de telefono?\r\n\t\t\t//SI EL USUARIO SELECCIONA QUE SI, SE MANDARA UNA SOLICITUD AL USUARIO DEL QUE SE QUIERE CONOCER\r\n\t\t\t//SU NUMERO DE MOVIL Y SI DIHCO USUARIO ACEPTA, SE LE REVELARA AL USUARIO.\r\n\t\t\tSession.set('userToSentPet', currentUserName);\r\n\t\t\tif(!Session.get('showProfileOtherUser')){\r\n\t\t\t\t//ESTE PROCESO NO ES INSTANTANEO YA QUE EL USUARIO TIENE QUE ACEPTAR LA PETICION\r\n\t\t\t\t$('#dialog-showSocialNetwork').modal('show');\r\n\t\t\t} else {\r\n\t\t\t\t//INICIALIZAMOS EL TOOLTIP\r\n\t\t\t\t$('[data-toggle=\"tooltip\"]').tooltip('show'); \r\n\t\t\t}\r\n  \t\t}\r\n  \t}\r\n});\r\n\r\nTemplate.userProfile.helpers({\r\n\t'dataUserFound': function(){\r\n\t\tMeteor.call('findUserData', currentUserName, function(err, res) {\r\n\t    \tSession.set('dataUser',res);\r\n\t  \t});\r\n\r\n\t  \tdataUser = Session.get('dataUser');\r\n\t  \treturn dataUser;\r\n\t},\r\n\t'userImgFound': function(){\r\n\t\tif(dataUser.userImg != \"\"){\r\n\t\t\tMeteor.call('findUserImg', dataUser.userImg, function(err, res) {\r\n\t\t\t\t$('#imgCurrentUser').attr(\"src\", res);\r\n\t\t  \t});\r\n\t\t} else {\r\n\t\t\tconsole.log(\"No Img Profile\");\r\n\t\t\t//$('#imgCurrentUser').attr(\"src\", \"/profileImgTest.png\");\r\n\t\t\treturn \"/profileImgTest.png\";\r\n\t\t}\r\n\t},\r\n\t'tweets': function(){\r\n\t  \tMeteor.call('tweetsPublish', currentUserName, function(err, res) {\r\n\t    \tSession.set('numTweets',res);\r\n\t  \t});\r\n\t  \treturn Session.get('numTweets');\r\n\t},\r\n  \t'following': function(){\r\n\t\tMeteor.call('usersFollowings', currentUserName, function(err, res) {\r\n      \t\tSession.set('numFollowings',res);\r\n    \t});\r\n    \treturn Session.get('numFollowings');\r\n  \t},\r\n  \t'followers': function(){\r\n\t    Meteor.call('usersFollowers', currentUserName, function(err, res) {\r\n\t      \tSession.set('numFollowers',res);\r\n\t    });\r\n    \treturn Session.get('numFollowers');\r\n  \t},\r\n  \t'existsSocialNetwork': function(){\r\n  \t\t\r\n  \t\tvar btnSocial = [];\r\n\r\n  \t\tif(dataUser.userFb){\r\n  \t\t\tvar newData = new Object();\r\n  \t\t\tnewData.color = \"primary\";\r\n  \t\t\tnewData.class = \"fa fa-facebook\";\r\n  \t\t\tnewData.id = \"Facebook\";\r\n  \t\t\tbtnSocial.push(newData);\r\n  \t\t}\r\n\r\n  \t\tif(dataUser.userInsta){\r\n  \t\t\tvar newData = new Object();\r\n  \t\t\tnewData.color = \"warning\";\r\n  \t\t\tnewData.class = \"fa fa-instagram\";\r\n  \t\t\tnewData.id = \"Instagram\";\r\n  \t\t\tbtnSocial.push(newData);\r\n  \t\t}\r\n\r\n  \t\tif(dataUser.userWhats){\r\n  \t\t\tvar newData = new Object();\r\n  \t\t\tnewData.color = \"success\";\r\n  \t\t\tnewData.class = \"fa fa-whatsapp\";\r\n  \t\t\tnewData.id = \"WhatsApp\";\r\n  \t\t\tbtnSocial.push(newData);\r\n  \t\t}\r\n\r\n  \t\treturn btnSocial;\r\n  \t},\r\n  \t'showProfileOtherUser' : function(){\r\n  \t\treturn Session.get('showProfileOtherUser');\r\n  \t},\r\n  \t'isWhatsapp' : function(){\r\n  \t\tif(this.id === \"WhatsApp\"){\r\n  \t\t\treturn true;\r\n  \t\t}\r\n  \t}\r\n});","Template.whatsAppNotif.onCreated(function() { \r\n  //console.log(\"Usuario: \"); \r\n  //console.log(Meteor.user().username);\r\n  Meteor.subscribe('whatsAppNotifications', Meteor.user().username);\r\n});\r\n\r\nTemplate.whatsAppNotif.helpers({\r\n  modeDisplay: function() {\r\n    var size = Session.get('sizeDisplay');\r\n    if(size > 768){\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n  },\r\n  whatsNotifCount: function(){\r\n    numNotif = Session.get('requestWhats').length;\r\n    return numNotif;\r\n  },\r\n  'infoStateCollapseNavBar': function() {\r\n    return Session.get('navBarCollapse');\r\n  }\r\n});\r\n\r\nTemplate.whatsAppNotif.events({\r\n  \r\n  'click #linkToWhatsNotif' : function(){\r\n    if(numNotif > 0){\r\n      window.location = \"/RequestWhatsApp/\" + Meteor.user().username;\r\n    }\r\n  }\r\n  \r\n});","Template.whatsAppRequestPage.helpers({  \r\n  'countNotifRequest' : function(){\r\n    arrWhatsAppReqNotif =  Session.get('requestWhats');\r\n    if(arrWhatsAppReqNotif){\r\n      countNumWhatsAppNotif = arrWhatsAppReqNotif.length;\r\n      if(countNumWhatsAppNotif === 0){\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    };\r\n  },\r\n  'countNotifResponse' : function(){\r\n    arrWhatsAppResNotif =  Session.get('responseWhats');\r\n    if(arrWhatsAppResNotif){\r\n      countNumWhatsAppNotif = arrWhatsAppResNotif.length;\r\n      if(countNumWhatsAppNotif === 0){\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    };\r\n  },\r\n  'whatsRequestNotif' : function(){\r\n    var arrAux = [];\r\n    arrWhatsAppReqNotif.forEach(function(item){\r\n      console.log(item);\r\n      var dataFound = UserUtils.findWhatsAppNotifications(item);\r\n      console.log(dataFound);\r\n      arrAux.push(dataFound);\r\n    });\r\n    console.log(arrAux);\r\n\r\n    return arrAux;\r\n  },\r\n  'whatsResponseNotif' : function(){\r\n    var arrAux = [];\r\n    arrWhatsAppResNotif.forEach(function(item){\r\n      console.log(item);\r\n      var dataFound = UserUtils.findWhatsAppNotifications(item);\r\n      console.log(dataFound);\r\n      arrAux.push(dataFound);\r\n    });\r\n    console.log(arrAux);\r\n\r\n    return arrAux;\r\n  }\r\n});\r\n\r\nTemplate.whatsAppRequestPage.events({\r\n  //SE PRODUCE CUANDO EL USUARIO ACEPTA LA SOLICITUD\r\n  'click #sentYes' : function() {\r\n    var idWhatsNotif = this._id;\r\n    //HAY QUE REALIZAR UNA NOTIFICACION AL USUARIO QUE HA SOLICITADO EL WHATSAPP\r\n    //INFORMANDOLE QUE SE HA ACEPTADO DICHA SOLICITUD\r\n    \r\n    var notif = new Object();\r\n      \r\n    notif.recepNotif = this.actorNotif; //EL USUARIO QUE VA A RECIBIR LA RESPUESTA DE LA PETICION\r\n    notif.actorNotif = this.recepNotif; //EL USUARIO QUE CONFIRMA LA PETICION\r\n    notif.timestamp = new Date();\r\n    notif.idNotifRequestWhatsApp = idWhatsNotif;\r\n    notif.typeOfNotif = \"responseWhatsAppNotif\";\r\n    notif.stateResponse = true;\r\n\r\n    Meteor.call('createResponseWhatsAppNotification', notif);\r\n    \r\n    countNumWhatsAppNotif--;\r\n  },\r\n  //SE PRODUCE CUANDO EL USUARIO RECHAZA LA SOLICITUD\r\n  'click #sentNo' : function(){\r\n    var idWhatsNotif = this._id;\r\n    //HAY QUE REALIZAR UNA NOTIFICACION AL USUARIO QUE HA SOLICITADO EL WHATSAPP\r\n    //INFORMANDOLE QUE SE HA RECHAZADO DICHA SOLICITUD\r\n    /*\r\n    var notif = new Object();\r\n      \r\n    notif.recepNotif = Session.get('userToSentPet'); //EL USUARIO QUE VA A RECIBIR LA PETICION\r\n    notif.actorNotif = Meteor.user().username; //EL USUARIO QUE REALIZA LA PETICION\r\n    notif.timestamp = new Date();\r\n    notif.idNotifRequestWhatsApp = idWhatsNotif;\r\n    notif.typeOfNotif = \"responseWhatsAppNotif\";\r\n    notif.stateResponse = false;\r\n\r\n    Meteor.call('createResponseWhatsAppNotification', notif);\r\n    */\r\n    //countNumWhatsAppNotif--;\r\n  },\r\n  //PULSEMOS EL BTN QUE PULSEMOS SE HARAN DOS COSAS:\r\n  //1) REDIRECCION A LA PAGINA PPAL SI SE HAN ACABADO LAS NOTIFICACIONES\r\n  //2) PONER LA NOTIFICACION A LEIDA\r\n  'click .btn' : function(){\r\n    var idNotifToClear = this._id;\r\n    \r\n    Notifications.update(idNotifToClear, {$set: {read: true}});\r\n    console.log(\"Clean!\");\r\n    if(countNumWhatsAppNotif === 0){\r\n      window.location = \"/\"; \r\n    }\r\n    \r\n  }\r\n});","import { Template } from 'meteor/templating';\r\nimport { ReactiveVar } from 'meteor/reactive-var';\r\n\r\nimport './main.html';","Twitts = new Meteor.Collection('twitts');\r\nRelationships = new Meteor.Collection('relationships');\r\nDataUser = new Meteor.Collection('dataUser');\r\nFavs = new Meteor.Collection('favs');\r\nNotifications = new Mongo.Collection('notifications');\r\nImages = new Mongo.Collection('images');","Router.configure({\r\n  loadingTemplate: 'loading',\r\n  notFoundTemplate: 'notFound',\r\n});\r\n\r\nRouter.route('/', {name: 'userManagement'});\r\n/*SE ACCEDE POR WINDOW.LOCATION*/\r\nRouter.route('/whoToFollow', {name: 'followUsers'});\r\nRouter.route('/Profile/:username', {\r\n\tname: 'userProfile',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.username;\r\n\r\n\t\tvar currentUser = Session.get('currentUser');\r\n\r\n\t\tMeteor.call('findUserData', user.name, function(err, res) {\r\n\t      Session.set('dataUserShowProfile',res);\r\n\t    });\r\n\r\n\t    dataUserShowProfile = Session.get('dataUserShowProfile');\r\n\r\n\t    if(dataUserShowProfile){\r\n\t    \tif(dataUserShowProfile.userNameProfile != currentUser){\r\n\t\t    \tSession.set('showProfileOtherUser', false);\r\n\t\t    } else {\r\n\t\t    \tSession.set('showProfileOtherUser', true);\r\n\t\t    }\r\n\t    }\r\n\t    \r\n\t\treturn user;\r\n\t}\r\n});\r\nRouter.route('/Notifications/:userName', {\r\n\tname: 'twiitPageNew',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.userName;\r\n\t\treturn user;\r\n\t}\r\n});\r\n\r\nRouter.route('/RequestWhatsApp/:userName', {\r\n\tname: 'whatsAppRequestPage',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.userName;\r\n\t\treturn user;\r\n\t}\r\n});\r\n\r\n//Router.route('/Comments', {name: 'twiitCommentPage'});\r\n/*SE ACCEDE POR PATHFOR*/\r\nRouter.route('/Comments/:_id', {\r\n\tname: 'twiitCommentPage',\r\n\tdata: function(){\r\n\t\tvar mode = Session.get('notificationsModeOn');\r\n\t\tvar idTwiit = new Object();\r\n\t\tidTwiit._id = this.params._id;\r\n\r\n\t\tif(mode){\r\n\t\t\tidTwiit.mode = mode;\r\n\t\t}\r\n\r\n\t\treturn idTwiit;\r\n\t}\r\n});\r\nRouter.route('/twiits/:_id', {\r\n  \tname: 'twiitPage',\r\n  \tdata: function() { \r\n  \t\treturn this.params;\r\n  \t}\r\n});\r\n\r\nRouter.route('/editProfile/:userName', {\r\n\tname: 'editProfile',\r\n\tdata: function(){\r\n\t\treturn this.params.userName;\t\r\n\t}\r\n});","UserUtils = function() {};    //no var in front\r\n\r\nUserUtils.findTweets = function(username) { \r\n  var currentTweets = Twitts.find({ user: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  console.log(\"Tweets: \");\r\n  console.log(currentTweets);\r\n\r\n  return currentTweets;\r\n};\t\r\n//SIGUIENDO\r\nUserUtils.findFollowings = function(username) { \r\n  var currentFollowings = Relationships.find({ follower: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  //console.log(\"Siguiendo: \");\r\n  //console.log(currentFollowings);\r\n\r\n  return currentFollowings;\r\n};\t\r\n//SEGUIDORES\r\nUserUtils.findFollowers = function(username) { \r\n  var currentFollowers = Relationships.find({ following: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  //console.log(\"Seguidores: \");\r\n  //console.log(currentFollowers);\r\n\r\n  return currentFollowers;\r\n};\t\r\n\r\nUserUtils.findNotifications = function(username){\r\n\treturn Notifications.find({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findOneNotification = function(username){\r\n  return Notifications.findOne({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findNumberNotif = function(username){\r\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, $or : [{typeOfNotif : 'twiit'}, {typeOfNotif : 'fav'}, {typeOfNotif : 'comment'}]}).count();\r\n};\r\n\r\nUserUtils.findWhatsAppNotifications = function(notifId){\r\n  return Notifications.findOne({_id: notifId});\r\n};\r\n\r\nUserUtils.findNumberFavPerTwiit = function(idTwiit){\r\n  var twiitNumFav = Twitts.findOne({_id: idTwiit}).numFav;\r\n  return twiitNumFav;\r\n};\r\n\r\nUserUtils.findFavsForTwiit = function(id){\r\n  return Favs.findOne({idTwiit : id});\r\n}\r\n\r\nUserUtils.addFavToTwiit = function(id, idUser){\r\n  var resultToUpdate = false;\r\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\r\n  var favObject = UserUtils.findFavsForTwiit(id);\r\n\r\n  if(!favObject){\r\n    //console.log(\"No tiene FAVS\");\r\n    \r\n  } else {\r\n    var arrAux = favObject.idUserTapFav;\r\n    var idFav = favObject._id;\r\n\r\n    arrAux.push(idUser);\r\n    var num = UserUtils.findNumberFavPerTwiit(id);\r\n    num++;\r\n\r\n    //AHORA HACEMOS LAS OPERACIONES DE UPDATE\r\n    res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\r\n    resT = Twitts.update(id, {$set: {numFav: num}});\r\n\r\n    //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\r\n    if(res && resT){\r\n      resultToUpdate = true;\r\n    }\r\n  }\r\n\r\n  return resultToUpdate;\r\n};\r\n\r\nUserUtils.removeFavToTwiit = function(id, idUser){\r\n  var resultToUpdate = false;\r\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\r\n  var favObject = UserUtils.findFavsForTwiit(id);\r\n  var arrAux = favObject.idUserTapFav;\r\n  var idFav = favObject._id;\r\n\r\n  //HAY QUE AVERIGUAR LA POSICION DEL idUser DENTRO DEL ARRAY DE LA BBDD\r\n  var posIdUser = arrAux.indexOf(idUser);\r\n  //AHORA ELIMINAMOS EL ELEMENTO ASOCIADO A ESA POSICION\r\n  delete arrAux[posIdUser];\r\n\r\n  var num = UserUtils.findNumberFavPerTwiit(id);\r\n  num--;\r\n\r\n  //AHORA HACEMOS LAS OPERACIONES DE UPDATE\r\n  res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\r\n  resT = Twitts.update(id, {$set: {numFav: num}});\r\n\r\n  //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\r\n  if(res && resT){\r\n    resultToUpdate = true;\r\n  }\r\n\r\n  return resultToUpdate;\r\n};\r\n\r\nUserUtils.findTwiitFromNotif = function(id){\r\n  var twiitId = Notifications.findOne(id).twiitId;\r\n  return twiitId;\r\n};\r\n\r\nUserUtils.findNumComment = function(idTweet){\r\n  return Twitts.findOne({_id : idTweet}).numComment;\r\n};\r\n\r\n//PARA MOSTRAR NOTIFICACIONES EN EL NAVEGADOR WEB\r\nUserUtils.createNotifToBrowser = function(typeNotif, userName){\r\n  if (Notification) {\r\n    if (Notification.permission !== \"granted\") {\r\n      Notification.requestPermission();\r\n    }\r\n    var title = \"TwiitClone\";\r\n    var bodyNotif = \"\";\r\n\r\n    if(typeNotif === \"fav\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha dado fav a un twiit tuyo\";\r\n    } else if(typeNotif === \"comment\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha comentado un twiit tuyo\";\r\n    } else if(typeNotif === \"twiit\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha publicado a un twiit nuevo\";\r\n    } else if(typeNotif === \"moreNotif\"){\r\n      bodyNotif = \"Tienes muchas Notificaciones\";\r\n    }\r\n\r\n    var extra = { body: bodyNotif };\r\n\r\n    var noti = new Notification(title, extra);\r\n\r\n    noti.onclick = function(){\r\n      // Al hacer click\r\n      window.location = \"/Notifications/\" + Meteor.user().username;\r\n    };\r\n\r\n    noti.onclose = {\r\n      // Al cerrar\r\n    };\r\n\r\n    setTimeout( function() { noti.close() }, 5000);\r\n  }\r\n};\r\n\r\nUserUtils.findUserFromTwiit = function(twiitId){\r\n  return Twitts.findOne({_id : twiitId}).user;\r\n};"]}
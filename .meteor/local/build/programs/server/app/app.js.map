{"version":3,"sources":["meteor://ðŸ’»app/lib/collections.js","meteor://ðŸ’»app/lib/router.js","meteor://ðŸ’»app/lib/userUtils.js","meteor://ðŸ’»app/server/chatsData.js","meteor://ðŸ’»app/server/followUsers.js","meteor://ðŸ’»app/server/notifications.js","meteor://ðŸ’»app/server/publications.js","meteor://ðŸ’»app/server/tweetBox.js","meteor://ðŸ’»app/server/userData.js","meteor://ðŸ’»app/server/userManagement.js","meteor://ðŸ’»app/server/main.js"],"names":["Twitts","Meteor","Collection","Relationships","DataUser","Favs","Notifications","Mongo","Images","ChatsMsg","Chats","Router","configure","loadingTemplate","notFoundTemplate","route","name","data","Session","set","user","Object","params","username","currentUser","get","call","err","res","dataUserShowProfile","userNameProfile","userName","mode","idTwiit","_id","showData","UserUtils","findTweets","find","sort","timestamp","findFollowings","currentFollowings","follower","fetch","map","following","findFollowers","currentFollowers","findNotifications","recepNotif","read","isOwnTwiit","twiitTimeStamp","findNotifForTypeNotif","type","typeOfNotif","findOneNotification","findOne","findNumberNotif","$or","count","findWhatsAppNotifications","notifId","findNumberFavPerTwiit","twiitNumFav","numFav","findFavsForTwiit","id","addFavToTwiit","idUser","resultToUpdate","favObject","arrAux","idUserTapFav","idFav","push","num","update","$set","resT","removeFavToTwiit","posIdUser","indexOf","findTwiitFromNotif","twiitId","findNumComment","idTweet","numComment","createNotifToBrowser","typeNotif","Notification","permission","requestPermission","title","bodyNotif","extra","body","noti","onclick","window","location","onclose","setTimeout","close","findUserFromTwiit","methods","console","log","chatsAvailable","userCreatedChat","userToChat","nameChat","msgFound","length","messageData","userToSentMsg","userRecepMsg","insert","userIdSentMsg","userNameSentMsg","userIdRecepMsg","contentMsg","contentMessage","messageTimestamp","Date","userNameToCheckChat","chatIsAvailable","userNameToCreateChat","nameUserRecepChat","remove","chats","currentContacts","forEach","elem","pos","users","fields","recUsers","$nin","limit","notif","twiit","actorNotif","isOwn","twiitMessage","message","timeStamp","stateResponse","idNotifRequestWhatsApp","publish","userId","$in","notifName","tweet","insertComment","commentType","twiitIdComment","fav","actorUser","recepUser","userData","userImg","userDescription","showWhatsTo","imgCode","newData","description","imgId","userFb","userInsta","userWhats","propertyToRem","$unset","code","userToRemove","idImgUser","aux","arrShowWhats","userToAdd","userToShow","showWhats","startup","_ensureIndex","unique","allow","disconnect","doc"],"mappings":"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","file":"/app.js","sourcesContent":["Twitts = new Meteor.Collection('twitts');\r\nRelationships = new Meteor.Collection('relationships');\r\nDataUser = new Meteor.Collection('dataUser');\r\nFavs = new Meteor.Collection('favs');\r\nNotifications = new Mongo.Collection('notifications');\r\nImages = new Mongo.Collection('images');\r\nChatsMsg = new Mongo.Collection('chatsMsg');\r\nChats = new Mongo.Collection('chats');","Router.configure({\r\n  loadingTemplate: 'loading',\r\n  notFoundTemplate: 'notFound',\r\n});\r\n\r\nRouter.route('/', {\r\n\tname: 'userManagement',\r\n\tdata: function(){\r\n\t\tSession.set('pathActualApp', '/');\r\n\t}\r\n});\r\n/*SE ACCEDE POR WINDOW.LOCATION*/\r\nRouter.route('/whoToFollow', {name: 'followUsers'});\r\nRouter.route('/Profile/:username', {\r\n\tname: 'userProfile',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.username;\r\n\r\n\t\tvar currentUser = Session.get('currentUser');\r\n\r\n\t\tMeteor.call('findUserData', user.name, function(err, res) {\r\n\t      Session.set('dataUserShowProfile',res);\r\n\t    });\r\n\r\n\t    dataUserShowProfile = Session.get('dataUserShowProfile');\r\n\r\n\t    if(dataUserShowProfile){\r\n\t    \tif(dataUserShowProfile.userNameProfile != currentUser){\r\n\t\t    \tSession.set('showProfileOtherUser', false);\r\n\t\t    } else {\r\n\t\t    \tSession.set('showProfileOtherUser', true);\r\n\t\t    }\r\n\t    }\r\n\t    \r\n\t    Session.set('pathActualApp', \"/Profile/\" + this.params.username);\r\n\r\n\t\treturn user;\r\n\t}\r\n});\r\nRouter.route('/Notifications/:userName', {\r\n\tname: 'twiitPageNew',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.userName;\r\n\t\tSession.set('pathActualApp', \"/Notifications/\" + this.params.username);\r\n\t\treturn user;\r\n\t}\r\n});\r\n\r\nRouter.route('/RequestWhatsApp/:userName', {\r\n\tname: 'whatsAppRequestPage',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.userName;\r\n\t\tSession.set('pathActualApp', \"/RequestWhatsApp/\" + this.params.username);\r\n\t\treturn user;\r\n\t}\r\n});\r\n\r\n//Router.route('/Comments', {name: 'twiitCommentPage'});\r\n/*SE ACCEDE POR PATHFOR*/\r\nRouter.route('/Comments/:_id', {\r\n\tname: 'twiitCommentPage',\r\n\tdata: function(){\r\n\t\tvar mode = Session.get('notificationsModeOn');\r\n\t\tvar idTwiit = new Object();\r\n\t\tidTwiit._id = this.params._id;\r\n\r\n\t\tif(mode){\r\n\t\t\tidTwiit.mode = mode;\r\n\t\t}\r\n\r\n\t\tSession.set('pathActualApp', \"/Comments/\" + this.params.username);\r\n\r\n\t\treturn idTwiit;\r\n\t}\r\n});\r\nRouter.route('/twiits/:_id', {\r\n  \tname: 'twiitPage',\r\n  \tdata: function() { \r\n  \t\treturn this.params;\r\n  \t}\r\n});\r\n\r\nRouter.route('/editProfile/:userName', {\r\n\tname: 'editProfile',\r\n\tdata: function(){\r\n\t\tSession.set('pathActualApp', \"/editProfile/\" + this.params.username);\r\n\t\treturn this.params.userName;\t\r\n\t}\r\n});\r\n\r\nRouter.route('/followAnts/:userName', {\r\n\tname: 'followAnts',\r\n\tdata: function(){\r\n\t\tvar showData = new Object();\r\n\t\tshowData.user = this.params.userName;\r\n\t\tshowData.mode = true;\r\n\t\tSession.set('pathActualApp', \"/followAnts/\" + this.params.username);\r\n\t\treturn showData;\r\n\t}\r\n});\r\n\r\nRouter.route('/videoTrans', {name: 'videoTrans'});\r\n\r\nRouter.route('/Chats/', {\r\n\tname: 'conversationsMenu',\r\n});\r\n\r\nRouter.route('/Conversation/:username', {\r\n\tname: 'showConver',\r\n\tdata: function(){\r\n\t\tvar user = new Object();\r\n\t\tuser.name = this.params.username;\r\n\r\n\t\treturn user;\r\n\t}\r\n});","UserUtils = function() {};    //no var in front\r\n\r\nUserUtils.findTweets = function(username) { \r\n  /*\r\n  var currentTweets = Twitts.find({ user: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data;\r\n  \t\t\t\t\t\t  });\r\n                */\r\n    return Twitts.find({user: username}, {sort: {timestamp: -1} });\r\n};\t\r\n//SIGUIENDO\r\nUserUtils.findFollowings = function(username) { \r\n  var currentFollowings = Relationships.find({ follower: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  //console.log(\"Siguiendo: \");\r\n  //console.log(currentFollowings);\r\n\r\n  return currentFollowings;\r\n};\t\r\n//SEGUIDORES\r\nUserUtils.findFollowers = function(username) { \r\n  var currentFollowers = Relationships.find({ following: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.follower;\r\n  \t\t\t\t\t\t  });\r\n  //console.log(\"Seguidores: \");\r\n  //console.log(currentFollowers);\r\n\r\n  return currentFollowers;\r\n};\t\r\n\r\nUserUtils.findNotifications = function(username){\r\n\treturn Notifications.find({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findNotifForTypeNotif = function(username, type){\r\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, typeOfNotif: type}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findOneNotification = function(username){\r\n  return Notifications.findOne({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\r\n}\r\n\r\nUserUtils.findNumberNotif = function(username){\r\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, $or : [{typeOfNotif : 'twiit'}, {typeOfNotif : 'fav'}, {typeOfNotif : 'comment'}]}).count();\r\n};\r\n\r\nUserUtils.findWhatsAppNotifications = function(notifId){\r\n  return Notifications.findOne({_id: notifId});\r\n};\r\n\r\nUserUtils.findNumberFavPerTwiit = function(idTwiit){\r\n  var twiitNumFav = Twitts.findOne({_id: idTwiit}).numFav;\r\n  return twiitNumFav;\r\n};\r\n\r\nUserUtils.findFavsForTwiit = function(id){\r\n  return Favs.findOne({idTwiit : id});\r\n}\r\n\r\nUserUtils.addFavToTwiit = function(id, idUser){\r\n  var resultToUpdate = false;\r\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\r\n  var favObject = UserUtils.findFavsForTwiit(id);\r\n\r\n  if(!favObject){\r\n    //console.log(\"No tiene FAVS\");\r\n    \r\n  } else {\r\n    var arrAux = favObject.idUserTapFav;\r\n    var idFav = favObject._id;\r\n\r\n    arrAux.push(idUser);\r\n    var num = UserUtils.findNumberFavPerTwiit(id);\r\n    num++;\r\n\r\n    //AHORA HACEMOS LAS OPERACIONES DE UPDATE\r\n    res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\r\n    resT = Twitts.update(id, {$set: {numFav: num}});\r\n\r\n    //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\r\n    if(res && resT){\r\n      resultToUpdate = true;\r\n    }\r\n  }\r\n\r\n  return resultToUpdate;\r\n};\r\n\r\nUserUtils.removeFavToTwiit = function(id, idUser){\r\n  var resultToUpdate = false;\r\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\r\n  var favObject = UserUtils.findFavsForTwiit(id);\r\n  var arrAux = favObject.idUserTapFav;\r\n  var idFav = favObject._id;\r\n\r\n  //HAY QUE AVERIGUAR LA POSICION DEL idUser DENTRO DEL ARRAY DE LA BBDD\r\n  var posIdUser = arrAux.indexOf(idUser);\r\n  //AHORA ELIMINAMOS EL ELEMENTO ASOCIADO A ESA POSICION\r\n  delete arrAux[posIdUser];\r\n\r\n  var num = UserUtils.findNumberFavPerTwiit(id);\r\n  num--;\r\n\r\n  //AHORA HACEMOS LAS OPERACIONES DE UPDATE\r\n  res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\r\n  resT = Twitts.update(id, {$set: {numFav: num}});\r\n\r\n  //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\r\n  if(res && resT){\r\n    resultToUpdate = true;\r\n  }\r\n\r\n  return resultToUpdate;\r\n};\r\n\r\nUserUtils.findTwiitFromNotif = function(id){\r\n  var twiitId = Notifications.findOne(id).twiitId;\r\n  return twiitId;\r\n};\r\n\r\nUserUtils.findNumComment = function(idTweet){\r\n  return Twitts.findOne({_id : idTweet}).numComment;\r\n};\r\n\r\n//PARA MOSTRAR NOTIFICACIONES EN EL NAVEGADOR WEB\r\nUserUtils.createNotifToBrowser = function(typeNotif, userName){\r\n  if (Notification) {\r\n    if (Notification.permission !== \"granted\") {\r\n      Notification.requestPermission();\r\n    }\r\n    var title = \"TwiitClone\";\r\n    var bodyNotif = \"\";\r\n\r\n    if(typeNotif === \"fav\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha dado fav a un twiit tuyo\";\r\n    } else if(typeNotif === \"comment\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha comentado un twiit tuyo\";\r\n    } else if(typeNotif === \"twiit\"){\r\n      bodyNotif = \"El usuario \" + userName + \" ha publicado a un twiit nuevo\";\r\n    } else if(typeNotif === \"moreNotif\"){\r\n      bodyNotif = \"Tienes muchas Notificaciones\";\r\n    }\r\n\r\n    var extra = { body: bodyNotif };\r\n\r\n    var noti = new Notification(title, extra);\r\n\r\n    noti.onclick = function(){\r\n      // Al hacer click\r\n      window.location = \"/Notifications/\" + Meteor.user().username;\r\n    };\r\n\r\n    noti.onclose = {\r\n      // Al cerrar\r\n    };\r\n\r\n    setTimeout( function() { noti.close() }, 5000);\r\n  }\r\n};\r\n\r\nUserUtils.findUserFromTwiit = function(twiitId){\r\n  return Twitts.findOne({_id : twiitId}).user;\r\n};","Meteor.methods({ \r\n\r\n  'findChatsAvailable' : function(){\r\n    console.log(\"Buscando chats\");\r\n    var chatsAvailable = Chats.find({}, {$or: [ { userCreatedChat : Meteor.user().username}, { userToChat : Meteor.user().username } ] }).fetch();;\r\n    return chatsAvailable;\r\n  },\r\n\r\n  'findChatFromUser': function(username) {\r\n    var nameChat = username + \"_\" + Meteor.user().username;\r\n    var msgFound = ChatsMsg.find({\"nameChat\" : nameChat}).fetch();\r\n    if(msgFound.length === 0){\r\n      console.log(msgFound);\r\n      nameChat = Meteor.user().username + \"_\" + username;\r\n      msgFound = ChatsMsg.find({\"nameChat\" : nameChat}).fetch();\r\n    }\r\n    return msgFound;\r\n  },\r\n\r\n  'insertMsgChat': function(messageData) {\r\n    var userToSentMsg = Meteor.call('findUserFromDB',messageData.userRecepMsg);\r\n\r\n    if (Meteor.user()) {\r\n      ChatsMsg.insert({\r\n        userIdSentMsg : Meteor.user()._id,\r\n        userNameSentMsg : Meteor.user().username,\r\n        userRecepMsg : messageData.userRecepMsg,\r\n        userIdRecepMsg : userToSentMsg._id,\r\n        nameChat : messageData.userRecepMsg + \"_\" + Meteor.user().username,\r\n        contentMsg : messageData.contentMessage,\r\n        messageTimestamp : new Date()\r\n      });\r\n    }\r\n  },\r\n\r\n  'insertMsg': function(messageData) {\r\n    var userToSentMsg = Meteor.call('findUserFromDB',messageData.userRecepMsg);\r\n\r\n    if (Meteor.user()) {\r\n      ChatsMsg.insert({\r\n        userIdSentMsg : Meteor.user()._id,\r\n        userNameSentMsg : Meteor.user().username,\r\n        userRecepMsg : messageData.userRecepMsg,\r\n        userIdRecepMsg : userToSentMsg._id,\r\n        nameChat : messageData.nameChat,\r\n        contentMsg : messageData.contentMessage,\r\n        messageTimestamp : new Date()\r\n      });\r\n    }\r\n  },\r\n\r\n  'checkChat' : function(userNameToCheckChat){\r\n    var chatIsAvailable = Chats.findOne({\"nameChat\" : userNameToCheckChat + \"_\" + Meteor.user().username});\r\n    console.log(chatIsAvailable);\r\n    if(chatIsAvailable){\r\n      return false;\r\n    } else {\r\n      return true;\r\n    }\r\n  },\r\n\r\n  'createChat' : function(userNameToCreateChat){\r\n    Chats.insert({\r\n      userCreatedChat : Meteor.user().username,\r\n      userToChat : userNameToCreateChat,\r\n      nameChat : userNameToCreateChat + \"_\" + Meteor.user().username\r\n    });\r\n  },\r\n\r\n  'removeChat': function(nameUserRecepChat){\r\n    ChatsMsg.remove({\"nameChat\" : nameUserRecepChat + \"_\" + Meteor.user().username});\r\n    Chats.remove({\"nameChat\" : nameUserRecepChat + \"_\" + Meteor.user().username});\r\n  },\r\n\r\n  'findLastMessage' : function(nameChat){\r\n    var chats = ChatsMsg.find({\"nameChat\" : nameChat}, {sort: {messageTimestamp: -1}}).fetch();\r\n    if(chats.length > 0){\r\n      return chats;\r\n    }\r\n  },\r\n\r\n  'findContactsAvailable' : function(){\r\n    /*OBTENEMOS LOS USUARIOS A LOS QUE SIGUE EL CURRENTUSER*/\r\n    var currentFollowings = UserUtils.findFollowings(Meteor.user().username);\r\n    var currentFollowers = UserUtils.findFollowers(Meteor.user().username);\r\n    var currentContacts = [];\r\n\r\n    currentFollowings.forEach(function(elem, pos){\r\n      if(currentFollowers.indexOf(elem) >= 0){\r\n        currentContacts.push(elem);\r\n      }\r\n    });\r\n\r\n    return currentContacts;\r\n  }\r\n}); ","Meteor.methods({ \r\n  'findUser': function(username) {\r\n    return Meteor.users.findOne({\r\n      username: username\r\n    }, {\r\n      fields: { 'username': 1 }\r\n    });\r\n  },\r\n\r\n  'followUser': function(username) {\r\n    Relationships.insert({\r\n      follower: Meteor.user().username,\r\n      following: username\r\n    });\r\n  },\r\n\r\n  'unfollowUser': function(username){\r\n    Relationships.remove({\r\n      follower: Meteor.user().username,\r\n      following: username\r\n    });\r\n  },\r\n\r\n  'recommendUsers': function() {\r\n\tif (Meteor.user()) {\r\n\t  var currentFollowings = UserUtils.findFollowings(Meteor.user().username);\r\n\r\n    console.log(\"currentFollowings\");\r\n    console.log(currentFollowings);\r\n\r\n\t  var recUsers = Meteor.users.find({\r\n\t    username: {\r\n\t      $nin: currentFollowings\r\n\t    }\r\n\t  }, {\r\n\t    fields: { 'username': 1 },\r\n\t    limit: 5\r\n\t  }).fetch();\r\n\r\n\t  return recUsers;\r\n\t}\r\n   }\r\n});","Meteor.methods({ \r\n  'createTwiitNotification' : function(notif) {\r\n    var twiit = Twitts.findOne(notif._id);\r\n    var typeNotif = notif.typeOfNotif;\r\n\r\n    if(notif.recepNotif === notif.actorNotif){\r\n      isOwn = true;\r\n    } else {\r\n      isOwn = false;\r\n    }\r\n    \r\n    Notifications.insert({\r\n      twiitMessage: twiit.message,\r\n      twiitId: twiit._id,\r\n      recepNotif: notif.recepNotif,\r\n      actorNotif: notif.actorNotif,\r\n      twiitTimeStamp: twiit.timestamp,\r\n      typeOfNotif: typeNotif, \r\n      read: false,\r\n      isOwnTwiit: isOwn\r\n    });\r\n    \r\n  },\r\n\r\n  'createWhatsAppNotification' : function(notif){\r\n\r\n    Notifications.insert({\r\n      recepNotif: notif.recepNotif,\r\n      actorNotif: notif.actorNotif,\r\n      timeStamp: notif.timestamp,\r\n      typeOfNotif: notif.typeOfNotif, \r\n      read: false,\r\n      isOwnTwiit: false\r\n    });\r\n\r\n  },\r\n\r\n  'createResponseWhatsAppNotification' : function(notif){\r\n\r\n    Notifications.insert({\r\n      recepNotif: notif.recepNotif,\r\n      actorNotif: notif.actorNotif,\r\n      timeStamp: notif.timestamp,\r\n      typeOfNotif: notif.typeOfNotif,\r\n      stateResponse: notif.stateResponse,\r\n      idNotifRequestWhatsApp: notif.idNotifRequestWhatsApp,\r\n      read: false,\r\n      isOwnTwiit: false\r\n    });\r\n\r\n  }\r\n});","Meteor.publish('twitts', function() {  \r\n  if (Meteor.userId) {\r\n    var username = Meteor.users.findOne({_id: this.userId}).username;\r\n    var currentFollowings = UserUtils.findFollowings(username);\r\n\r\n    return Twitts.find({user: { $in: currentFollowings }});\r\n  }\r\n});\r\n\r\nMeteor.publish('twittsProfile', function(username) {  \r\n  if (Meteor.userId) {\r\n    return Twitts.find();\r\n  }\r\n});\r\n\r\nMeteor.publish('twittsWithComment', function(idTweet) {  \r\n  if (Meteor.userId) {\r\n    return Twitts.find();\r\n  }\r\n});\r\n\r\nMeteor.publish('notifications', function() {\r\n  return Notifications.find();\r\n});\r\n\r\nMeteor.publish('allNotifications', function(notifId) {\r\n  return Notifications.find({_id : notifId}, {read: false});\r\n});\r\n\r\nMeteor.publish('whatsAppNotifications', function(notifName) {\r\n  return Notifications.find({recepNotif : notifName}, {read: false});\r\n});\r\n\r\nMeteor.publish('favs', function() {\r\n  return Favs.find();\r\n});\r\n\r\nMeteor.publish('dataUser', function() {\r\n  return DataUser.find();\r\n});\r\n\r\nMeteor.publish('images', function() {\r\n  return Images.find();\r\n});\r\n\r\nMeteor.publish('chatsMsg', function() {\r\n  if (Meteor.userId) {\r\n    return ChatsMsg.find({userIdRecepMsg : this.userId});\r\n  }\r\n});\r\n\r\nMeteor.publish('chats', function() {\r\n  if (Meteor.userId) {\r\n    return Chats.find();\r\n  }\r\n});\r\n\r\n/*\r\nMeteor.publishComposite('twitts', function(username) {  \r\n  return {\r\n    find: function() {\r\n      // Comprobar los usuarios a los que se estÃ¡ siguiendo\r\n      return Relationships.find({ follower: username });\r\n    },\r\n    children: [{\r\n      find: function(relationship) {\r\n        // Encontrar mensajes de los usuarios que se siguen\r\n        return Twitts.find({user: relationship.following});\r\n      }\r\n    }]\r\n  }\r\n});\r\n*/","Meteor.methods({ \r\n  'insertTweet': function(tweet) {\r\n    var insertComment = false;\r\n\r\n    twiit = new Object();\r\n    twiit.message = tweet.message;\r\n    twiit.user = Meteor.user().username;\r\n    twiit.timestamp = new Date();\r\n    twiit.numFav = 0;\r\n    twiit.numComment = 0;\r\n\r\n    //SE EJECUTA CUANDO SE QUIERE INSERTAR UN TWIIT DESDE UN COMENTARIO\r\n    if(tweet.type){\r\n      twiit.commentType = true;\r\n      twiit.twiitIdComment = tweet.twiitId;\r\n    } \r\n\r\n    fav = new Object();\r\n    fav.idTwiit = \"\";\r\n    fav.idUserTapFav = [];\r\n\r\n    if(tweet.type){\r\n      if (Meteor.user()) {\r\n        twiit._id = Twitts.insert({\r\n          message : twiit.message,\r\n          user : twiit.user,\r\n          timestamp : twiit.timestamp,\r\n          numFav : twiit.numFav,\r\n          numComment : twiit.numComment,\r\n          commentType : twiit.commentType,\r\n          twiitIdComment : twiit.twiitIdComment\r\n        });\r\n      }\r\n    } else {\r\n      if (Meteor.user()) {\r\n        twiit._id = Twitts.insert({\r\n          message : twiit.message,\r\n          user : twiit.user,\r\n          timestamp : twiit.timestamp,\r\n          numFav : twiit.numFav,\r\n          numComment : twiit.numComment\r\n        });\r\n      }\r\n    }\r\n\r\n    fav._id = Favs.insert({\r\n      idTwiit : twiit._id,\r\n      idUserTapFav : fav.idUserTapFav\r\n    });\r\n\r\n    var notif = new Object();\r\n    notif._id = twiit._id;\r\n    notif.typeOfNotif = tweet.typeOfNotif;\r\n    notif.actorNotif = tweet.actorUser;\r\n    notif.recepNotif = tweet.recepUser;\r\n    \r\n    //console.log(notif);\r\n\r\n  \tMeteor.call('createTwiitNotification', notif);\r\n\r\n    if(tweet.type){\r\n      Twitts.update({_id: twiit.twiitIdComment}, {$set: {numComment : tweet.numComment}});\r\n    }\r\n  }\r\n});","Meteor.methods({ \r\n  'findUserFromDB': function(username) {\r\n    //Meteor._sleepForMs(1000);\r\n    return Meteor.users.findOne({\"username\" : username});\r\n  },\r\n\r\n  'insertDataUser': function(userData) {\r\n\r\n    //BUSCAMOS AL USUARIO QUE SE HA CREADO ANTES PARA RECUPERAR SU _ID\r\n    Meteor.call('findUserFromDB', userData.userNameProfile, function(err, res){\r\n      userData.userId = res._id;\r\n    });\r\n\r\n    if (Meteor.user()) {\r\n      DataUser.insert({\r\n        userId : userData.userId,\r\n        userNameProfile : userData.userNameProfile,\r\n        userName : userData.userName,\r\n        userImg : userData.userImg,\r\n        userDescription : userData.userDescription,\r\n        showWhatsTo: []\r\n      });\r\n    }\r\n  },\r\n\r\n  'findUserData': function(userName){\r\n    return DataUser.findOne({userNameProfile : userName});\r\n  },\r\n\r\n  'findUserDataWithId': function(userId){\r\n    return DataUser.findOne({userId : userId});\r\n  },\r\n\r\n  'findUserImg': function(userImg){\r\n    return Images.findOne({_id : userImg}).imgCode;\r\n  },\r\n\r\n  'updUserData': function(newData){\r\n    DataUser.update({_id: newData.userId}, {$set: {userDescription : newData.description, userImg : newData.imgId}});\r\n  },\r\n\r\n  'updUserDataSocialNetworks': function(newData){\r\n    if((newData.userFb != null) && (newData.userInsta != null) && (newData.userWhats != null)){\r\n      DataUser.update({_id: newData.userId}, {$set: {userFb : newData.userFb, userWhats : newData.userWhats, userInsta : newData.userInsta}});\r\n    } else {\r\n      if(newData.userFb != null){\r\n        DataUser.update({_id: newData.userId}, {$set: {userFb : newData.userFb}});\r\n      }\r\n\r\n      if(newData.userInsta != null){\r\n        DataUser.update({_id: newData.userId}, {$set: {userInsta : newData.userInsta}});\r\n      }\r\n\r\n      if(newData.userWhats != null){\r\n        DataUser.update({_id: newData.userId}, {$set: {userWhats : newData.userWhats}});\r\n      }\r\n    }\r\n  },\r\n\r\n  'removeDataSocialNetworks': function(newData){\r\n    console.log(newData.userId + \" \" + newData.propertyToRem);\r\n\r\n    switch(newData.propertyToRem){\r\n        case \"WhatsApp\": {\r\n          DataUser.update({_id: newData.userId},  {$unset: { \"userWhats\" : 1 }});\r\n        };\r\n          break;\r\n        case \"Instagram\": {\r\n          DataUser.update({_id: newData.userId},  {$unset: { \"userInsta\" : 1 }});\r\n        };\r\n          break;\r\n        case \"Facebook\": {\r\n          DataUser.update({_id: newData.userId},  {$unset: { \"userFb\" : 1 }});\r\n        };\r\n          break;\r\n      }\r\n    \r\n    //ESTE COMANDO ES EL QUE SE UTILIZA EN MONGO\r\n    //db.dataUser.update({\"_id\": \"rQTzzDMfr4ZkiR7S8\"},  {\"$unset\":{\"userWhats\":1}});\r\n  },\r\n\r\n  'insertNewImage': function(code){\r\n    return Images.insert({\r\n      imgCode : code\r\n    });\r\n  },\r\n\r\n  'removeThisUser': function(userToRemove){\r\n    //HAY QUE ELIMINAR EL USUARIO DE dataUser Y DE users\r\n    var idImgUser = DataUser.findOne({userId: userToRemove.id}).userImg;\r\n\r\n    if(idImgUser){\r\n      Images.remove({_id: idImgUser});\r\n    }\r\n   \r\n    Notifications.remove({recepNotif: userToRemove.name});\r\n    Relationships.remove({follower: userToRemove.name});\r\n    Relationships.remove({following: userToRemove.name});\r\n\r\n    Favs.find({idUserTapFav: userToRemove.id}).fetch().map(function(data) {\r\n      if(data.idUserTapFav){\r\n        var aux = data.idUserTapFav;\r\n        var pos = aux.indexOf(userToRemove.id);\r\n        if(pos != -1){\r\n          UserUtils.removeFavToTwiit(data.idTwiit, userToRemove.id);\r\n        }\r\n      }\r\n    });\r\n\r\n    Twitts.remove({user: userToRemove.name});\r\n    Meteor.users.remove({_id: userToRemove.id});\r\n    DataUser.remove({userId: userToRemove.id});\r\n  }, \r\n\r\n  'updateArrayWhatsAppAuthorize': function(data){\r\n    var user = DataUser.findOne({userNameProfile: data.user});\r\n    var arrShowWhats = user.showWhatsTo;\r\n    console.log(\"Array: \");\r\n    console.log(arrShowWhats);\r\n\r\n    //BUSCAMOS EL USUARIO QUE VAMOS A AÃ‘ADIR AL ARRAY\r\n    var userToAdd = DataUser.findOne({userNameProfile: data.userToShow});\r\n    arrShowWhats.push(userToAdd.userId);\r\n\r\n    console.log(arrShowWhats);\r\n    console.log(user);\r\n\r\n    DataUser.update({userId: user.userId}, {$set: {showWhatsTo : arrShowWhats}});\r\n    \r\n  },\r\n\r\n  'updateShowWhatsTo' : function(data){\r\n    DataUser.update({userId: data.userId}, {$set: {showWhatsTo : data.showWhats}});\r\n  },\r\n\r\n});","Meteor.methods({ \r\n  /*\r\n  'tweetsPublish': function(username) {\r\n    console.log(\"Usuario a buscar: \" + username);\r\n    console.log(\"Resultado: \");\r\n    var resul =  UserUtils.findTweets(username);\r\n    return resul.length;\r\n  },\r\n  */\r\n  'usersFollowers': function(username) {\r\n    var currentFollowers = UserUtils.findFollowers(username);\r\n    return currentFollowers.length;\r\n  },\r\n\r\n  'usersFollowings': function(username) {\r\n\t  var currentFollowings = UserUtils.findFollowings(username);\r\n    \r\n    return currentFollowings.length;\r\n  },\r\n\r\n  'getFollowers': function(username) {\r\n    var currentFollowers = UserUtils.findFollowers(username);\r\n\r\n    return currentFollowers;\r\n  },\r\n\r\n  'getFollowings': function(username) {\r\n    var currentFollowings = UserUtils.findFollowings(username);\r\n\r\n    return currentFollowings;\r\n  }\r\n\r\n});","import { Meteor } from 'meteor/meteor';\r\n\r\nMeteor.startup(() => {\r\n  // code to run on server at startup\r\n  Relationships._ensureIndex({follower: 1, following: 1}, {unique: 1});\r\n  \r\n  Twitts.allow({\r\n  \tinsert: function(userId, disconnect) {\r\n  \t   \treturn true;\r\n  \t},\r\n  \tupdate: function(id, doc){\r\n  \t\treturn true;\r\n  \t}, \r\n    \r\n  });\r\n\r\n  Favs.allow({\r\n  \tinsert: function(userId, disconnect) {\r\n\t   \treturn true;\r\n\t},\r\n  \tupdate: function(userId, doc) {\r\n\t    return true;\r\n  \t}\r\n  });\r\n\r\n  Notifications.allow({\r\n  \tupdate: function(userId, doc) {\r\n\t    return true;\r\n  \t}\r\n  });\r\n\r\n  DataUser.allow({\r\n    insert: function(userId, disconnect){\r\n      return true;\r\n    }, \r\n    update: function(userId, doc) {\r\n      return true;\r\n    }\r\n\r\n  });\r\n\r\n  Images.allow({\r\n    insert: function(userId, disconnect){\r\n      return true;\r\n    }\r\n  });\r\n\r\n  Chats.allow({\r\n    insert: function(userId, disconnect){\r\n      return true;\r\n    }, \r\n    update: function(userId, doc) {\r\n      return true;\r\n    }\r\n\r\n  });\r\n});\r\n"]}
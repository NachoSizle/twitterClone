{"version":3,"sources":["meteor://ðŸ’»app/lib/collections/tweets.js","meteor://ðŸ’»app/lib/router.js","meteor://ðŸ’»app/lib/userUtils.js","meteor://ðŸ’»app/server/followUsers.js","meteor://ðŸ’»app/server/publications.js","meteor://ðŸ’»app/server/tweetBox.js","meteor://ðŸ’»app/server/userManagement.js","meteor://ðŸ’»app/server/main.js"],"names":[],"mappings":"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","file":"/app.js","sourcesContent":["Twitts = new Meteor.Collection('twitts');\r\nRelationships = new Meteor.Collection('relationships');","Router.route('/', {name: 'userManagement'});\r\nRouter.route('/whoToFollow', {name: 'followUsers'});","UserUtils = function() {};    //no var in front\r\n\r\nUserUtils.findTweets = function(username) { \r\n  var currentTweets = Twitts.find({ user: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  console.log(\"Tweets: \");\r\n  console.log(currentTweets);\r\n\r\n  return currentTweets;\r\n};\t\r\n\r\nUserUtils.findFollowings = function(username) { \r\n  var currentFollowings = Relationships.find({ follower: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  console.log(\"Siguiendo: \");\r\n  console.log(currentFollowings);\r\n\r\n  return currentFollowings;\r\n};\t\r\n\r\nUserUtils.findFollowers = function(username) { \r\n  var currentFollowers = Relationships.find({ following: username }).fetch().map(function(data) {\r\n    \t\t\t\t\t\t\t\treturn data.following;\r\n  \t\t\t\t\t\t  });\r\n  console.log(\"Seguidores: \");\r\n  console.log(currentFollowers);\r\n\r\n  return currentFollowers;\r\n};\t\r\n\r\n//FORZAMOS LA REACTIVIDAD\r\nUserUtils.observerProperties = function(){\r\n\tTwitts.find().observeChanges({\r\n    changed: function(){\r\n      console.log(\"Se han detectado cambios!\");\r\n    },\r\n    added: function(id, doc) {\r\n      console.log(doc);\r\n      return true;\r\n    }\r\n  })\r\n}","Meteor.methods({ \r\n  'findUser': function(username) {\r\n    return Meteor.users.findOne({\r\n      username: username\r\n    }, {\r\n      fields: { 'username': 1 }\r\n    });\r\n  },\r\n\r\n  'followUser': function(username) {\r\n    Relationships.insert({\r\n      follower: Meteor.user().username,\r\n      following: username\r\n    });\r\n  },\r\n\r\n  'recommendUsers': function() {\r\n\tif (Meteor.user()) {\r\n\t  var currentFollowings = UserUtils.findFollowings(Meteor.user().username);\r\n\r\n\t  var recUsers = Meteor.users.find({\r\n\t    username: {\r\n\t      $nin: currentFollowings\r\n\t    }\r\n\t  }, {\r\n\t    fields: { 'username': 1 },\r\n\t    limit: 5\r\n\t  }).fetch();\r\n\t  return recUsers;\r\n\t}\r\n   }\r\n});\r\n\r\n\r\n","Meteor.publish('twitts', function() {  \r\n  if (Meteor.userId) {\r\n    var username = Meteor.users.findOne({_id: this.userId}).username;\r\n    var currentFollowings = UserUtils.findFollowings(username);\r\n\r\n    return Twitts.find({user: { $in: currentFollowings }});\r\n  }\r\n});\r\n/*\r\nMeteor.publishComposite('twitts', function(username) {  \r\n  return {\r\n    find: function() {\r\n      // Comprobar los usuarios a los que se estÃ¡ siguiendo\r\n      return Relationships.find({ follower: username });\r\n    },\r\n    children: [{\r\n      find: function(relationship) {\r\n        // Encontrar mensajes de los usuarios que se siguen\r\n        return Twitts.find({user: relationship.following});\r\n      }\r\n    }]\r\n  }\r\n});\r\n*/","Meteor.methods({ \r\n  'insertTweet': function(tweet) {\r\n    if (Meteor.user()) {\r\n      Twitts.insert({\r\n        message: tweet,\r\n        user: Meteor.user().username,\r\n        timestamp: new Date()\r\n      });\r\n    }\r\n  }\r\n});","Meteor.methods({ \r\n  'tweetsPublish': function(username) {\r\n    console.log(\"Usuario a buscar: \" + username);\r\n    console.log(\"Resultado: \");\r\n    var resul =  UserUtils.findTweets(Meteor.user().username);\r\n    return resul.length;\r\n  },\r\n\r\n  'usersFollowers': function() {\r\n    var currentFollowers = UserUtils.findFollowers(Meteor.user().username);\r\n    return currentFollowers.length;\r\n  },\r\n\r\n  'usersFollowings': function() {\r\n\t  var currentFollowings = UserUtils.findFollowings(Meteor.user().username);\r\n    \r\n    return currentFollowings.length;\r\n  }\r\n});","import { Meteor } from 'meteor/meteor';\n\nMeteor.startup(() => {\n  // code to run on server at startup\n  Relationships._ensureIndex({follower: 1, following: 1}, {unique: 1});\n  \n  Twitts.allow({\n\tinsert: function(userId, disconnect) {\n\t   return true;\n\t}\n  });\n});\n"]}
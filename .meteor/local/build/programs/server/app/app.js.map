{"version":3,"sources":["meteor://ðŸ’»app/lib/collections.js","meteor://ðŸ’»app/lib/router.js","meteor://ðŸ’»app/lib/userUtils.js","meteor://ðŸ’»app/server/chatsData.js","meteor://ðŸ’»app/server/followUsers.js","meteor://ðŸ’»app/server/notifications.js","meteor://ðŸ’»app/server/publications.js","meteor://ðŸ’»app/server/tweetBox.js","meteor://ðŸ’»app/server/userData.js","meteor://ðŸ’»app/server/userFileManagement.js","meteor://ðŸ’»app/server/userManagement.js","meteor://ðŸ’»app/server/main.js"],"names":["FilesCollection","Twitts","Meteor","Collection","Relationships","DataUser","Favs","Notifications","Mongo","Images","ChatsMsg","Chats","Files","collectionName","allowClientCode","onBeforeUpload","file","console","log","size","test","extension","onAfterupload","Router","configure","loadingTemplate","notFoundTemplate","route","name","data","$","css","show","Session","set","user","Object","params","username","currentUser","get","call","err","res","dataUserShowProfile","userNameProfile","userName","mode","idTwiit","_id","Ã§","showData","hide","UserUtils","findTweets","find","sort","timestamp","findFollowings","currentFollowings","follower","fetch","map","following","findFollowers","currentFollowers","findNotifications","recepNotif","read","isOwnTwiit","twiitTimeStamp","findNotifForTypeNotif","type","typeOfNotif","findOneNotification","findOne","findNumberNotif","$or","count","findWhatsAppNotifications","notifId","findNumberFavPerTwiit","twiitNumFav","numFav","findFavsForTwiit","id","addFavToTwiit","idUser","resultToUpdate","favObject","arrAux","idUserTapFav","idFav","push","num","update","$set","resT","removeFavToTwiit","posIdUser","indexOf","findTwiitFromNotif","twiitId","findNumComment","idTweet","numComment","createNotifToBrowser","typeNotif","Notification","permission","requestPermission","title","bodyNotif","extra","body","noti","onclick","window","location","onclose","setTimeout","close","findUserFromTwiit","methods","chatsAvailable","userCreatedChat","userToChat","nameChat","msgFound","length","messageData","userToSentMsg","userRecepMsg","insert","userIdSentMsg","userNameSentMsg","userIdRecepMsg","contentMsg","contentMessage","messageTimestamp","Date","userNameToCheckChat","chatIsAvailable","userNameToCreateChat","nameUserRecepChat","remove","users","split","chats","currentContacts","forEach","elem","pos","fields","recUsers","$nin","limit","notif","twiit","actorNotif","isOwn","twiitMessage","message","timeStamp","stateResponse","idNotifRequestWhatsApp","publish","userId","$in","notifName","cursor","isServer","denyClient","startup","load","fileName","tweet","insertComment","commentType","twiitIdComment","fav","actorUser","recepUser","userData","userImg","userDescription","showWhatsTo","imgCode","newData","description","imgId","userFb","userInsta","userWhats","propertyToRem","$unset","code","userToRemove","idImgUser","aux","arrShowWhats","userToAdd","userToShow","showWhats","idFileToRem","filesFound","fileFound","idFile","_ensureIndex","unique","allow","disconnect","doc"],"mappings":"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","file":"/app.js","sourcesContent":["import { FilesCollection } from 'meteor/ostrio:files';\n\nTwitts = new Meteor.Collection('twitts');\nRelationships = new Meteor.Collection('relationships');\nDataUser = new Meteor.Collection('dataUser');\nFavs = new Meteor.Collection('favs');\nNotifications = new Mongo.Collection('notifications');\nImages = new Mongo.Collection('images');\nChatsMsg = new Mongo.Collection('chatsMsg');\nChats = new Mongo.Collection('chats');\nFiles = new FilesCollection({\n  collectionName: 'Files',\n  allowClientCode: false, // Disallow remove files from Client\n  onBeforeUpload: function (file) {\n    console.log('onBeforeUpload');\n    // Allow upload files under 10MB, and only in png/jpg/jpeg formats\n    if (file.size <= 10485760 && /png|jpg|jpeg|mp4/i.test(file.extension)) {\n      return true;\n    } else {\n      return 'Please upload image, with size equal or less than 10MB';\n    }\n  },\n  onAfterupload: function(file){\n    console.log('onAfterupload');\n    console.log(file);\n  }\n});\n","Router.configure({\n  loadingTemplate: 'loading',\n  notFoundTemplate: 'notFound',\n});\n\nRouter.route('/', {\n\tname: 'userManagement',\n\tdata: function(){\n    $('#selectFileLbl').css('margin-bottom', '0px');\n    $('#selectFileLbl').show();\n\t\tSession.set('pathActualApp', '/');\n\t}\n});\n/*SE ACCEDE POR WINDOW.LOCATION*/\nRouter.route('/whoToFollow', {\n  name: 'followUsers',\n  data: function(){\n    $('#selectFileLbl').css('margin-bottom', '0px');\n    $('#selectFileLbl').show();\n  }\n});\nRouter.route('/Profile/:username', {\n\tname: 'userProfile',\n\tdata: function(){\n    $('#selectFileLbl').css('margin-bottom', '0px');\n    $('#selectFileLbl').show();\n\n\t\tvar user = new Object();\n\t\tuser.name = this.params.username;\n\n\t\tvar currentUser = Session.get('currentUser');\n\n\t\tMeteor.call('findUserData', user.name, function(err, res) {\n\t      Session.set('dataUserShowProfile',res);\n\t    });\n\n\t    dataUserShowProfile = Session.get('dataUserShowProfile');\n\n\t    if(dataUserShowProfile){\n\t    \tif(dataUserShowProfile.userNameProfile != currentUser){\n\t\t    \tSession.set('showProfileOtherUser', false);\n\t\t    } else {\n\t\t    \tSession.set('showProfileOtherUser', true);\n\t\t    }\n\t    }\n\n\t    Session.set('pathActualApp', \"/Profile/\" + this.params.username);\n\n\t\treturn user;\n\t}\n});\nRouter.route('/Notifications/:userName', {\n\tname: 'twiitPageNew',\n\tdata: function(){\n    $('#selectFileLbl').css('margin-bottom', '0px');\n    $('#selectFileLbl').show();\n\n\t\tvar user = new Object();\n\t\tuser.name = this.params.userName;\n\t\tSession.set('pathActualApp', \"/Notifications/\" + this.params.username);\n\t\treturn user;\n\t}\n});\n\nRouter.route('/RequestWhatsApp/:userName', {\n\tname: 'whatsAppRequestPage',\n\tdata: function(){\n    $('#selectFileLbl').css('margin-bottom', '0px');\n    $('#selectFileLbl').show();\n\n\t\tvar user = new Object();\n\t\tuser.name = this.params.userName;\n\t\tSession.set('pathActualApp', \"/RequestWhatsApp/\" + this.params.username);\n\t\treturn user;\n\t}\n});\n\n//Router.route('/Comments', {name: 'twiitCommentPage'});\n/*SE ACCEDE POR PATHFOR*/\nRouter.route('/Comments/:_id', {\n\tname: 'twiitCommentPage',\n\tdata: function(){\n    $('#selectFileLbl').css('margin-bottom', '0px');\n    $('#selectFileLbl').show();\n\n\t\tvar mode = Session.get('notificationsModeOn');\n\t\tvar idTwiit = new Object();\n\t\tidTwiit._id = this.params._id;\n\n\t\tif(mode){\n\t\t\tidTwiit.mode = mode;\n\t\t}\n\n\t\tSession.set('pathActualApp', \"/Comments/\" + this.params.username);\n\n\t\treturn idTwiit;\n\t}\n});\nRouter.route('/twiits/:_id', {\n  \tname: 'twiitPage',\n  \tdata: function() {\n      $('#selectFileLbl').css('margin-bottom', '0px');\n      $('#selectFileLbl').show();\n  \t\treturn this.params;\n  \t}\n});\n\nRouter.route('/editProfile/:userName', {\n\tname: 'editProfile',\n\tdata: function(){Ã§\n    $('#selectFileLbl').show();\n    $('#selectFileLbl').css('margin-bottom', '0px');\n\n\t\tSession.set('pathActualApp', \"/editProfile/\" + this.params.username);\n\t\treturn this.params.userName;\n\t}\n});\n\nRouter.route('/followAnts/:userName', {\n\tname: 'followAnts',\n\tdata: function(){\n    $('#selectFileLbl').show();\n    $('#selectFileLbl').css('margin-bottom', '0px');\n\n\t\tvar showData = new Object();\n\t\tshowData.user = this.params.userName;\n\t\tshowData.mode = true;\n\t\tSession.set('pathActualApp', \"/followAnts/\" + this.params.username);\n\t\treturn showData;\n\t}\n});\n\nRouter.route('/videoTrans', {\n  name: 'videoTrans'\n});\nRouter.route('/ShowFiles', {\n  name: 'showUploadFiles',\n  data : function(){\n    $('#selectFileLbl').show();\n    $('#selectFileLbl').css('margin-bottom', '0px');\n  }\n});\n\n\nRouter.route('/Chats/', {\n\tname: 'conversationsMenu',\n  data : function(){\n    $('#selectFileLbl').hide();\n    $('#selectFileLbl').css('margin-bottom', '50px');\n  }\n});\n\nRouter.route('/Conversation/:username', {\n\tname: 'showConver',\n\tdata: function(){\n    $('#selectFileLbl').hide();\n\n\t\tvar user = new Object();\n\t\tuser.name = this.params.username;\n\n\t\treturn user;\n\t}\n});\n","UserUtils = function() {};    //no var in front\n\nUserUtils.findTweets = function(username) { \n  /*\n  var currentTweets = Twitts.find({ user: username }).fetch().map(function(data) {\n    \t\t\t\t\t\t\t\treturn data;\n  \t\t\t\t\t\t  });\n                */\n    return Twitts.find({user: username}, {sort: {timestamp: -1} });\n};\t\n//SIGUIENDO\nUserUtils.findFollowings = function(username) { \n  var currentFollowings = Relationships.find({ follower: username }).fetch().map(function(data) {\n    \t\t\t\t\t\t\t\treturn data.following;\n  \t\t\t\t\t\t  });\n  //console.log(\"Siguiendo: \");\n  //console.log(currentFollowings);\n\n  return currentFollowings;\n};\t\n//SEGUIDORES\nUserUtils.findFollowers = function(username) { \n  var currentFollowers = Relationships.find({ following: username }).fetch().map(function(data) {\n    \t\t\t\t\t\t\t\treturn data.follower;\n  \t\t\t\t\t\t  });\n  //console.log(\"Seguidores: \");\n  //console.log(currentFollowers);\n\n  return currentFollowers;\n};\t\n\nUserUtils.findNotifications = function(username){\n\treturn Notifications.find({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\n}\n\nUserUtils.findNotifForTypeNotif = function(username, type){\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, typeOfNotif: type}, {sort: {twiitTimeStamp: -1}});\n}\n\nUserUtils.findOneNotification = function(username){\n  return Notifications.findOne({recepNotif: username, read: false, isOwnTwiit: false}, {sort: {twiitTimeStamp: -1}});\n}\n\nUserUtils.findNumberNotif = function(username){\n  return Notifications.find({recepNotif: username, read: false, isOwnTwiit: false, $or : [{typeOfNotif : 'twiit'}, {typeOfNotif : 'fav'}, {typeOfNotif : 'comment'}]}).count();\n};\n\nUserUtils.findWhatsAppNotifications = function(notifId){\n  return Notifications.findOne({_id: notifId});\n};\n\nUserUtils.findNumberFavPerTwiit = function(idTwiit){\n  var twiitNumFav = Twitts.findOne({_id: idTwiit}).numFav;\n  return twiitNumFav;\n};\n\nUserUtils.findFavsForTwiit = function(id){\n  return Favs.findOne({idTwiit : id});\n}\n\nUserUtils.addFavToTwiit = function(id, idUser){\n  var resultToUpdate = false;\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\n  var favObject = UserUtils.findFavsForTwiit(id);\n\n  if(!favObject){\n    //console.log(\"No tiene FAVS\");\n    \n  } else {\n    var arrAux = favObject.idUserTapFav;\n    var idFav = favObject._id;\n\n    arrAux.push(idUser);\n    var num = UserUtils.findNumberFavPerTwiit(id);\n    num++;\n\n    //AHORA HACEMOS LAS OPERACIONES DE UPDATE\n    res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\n    resT = Twitts.update(id, {$set: {numFav: num}});\n\n    //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\n    if(res && resT){\n      resultToUpdate = true;\n    }\n  }\n\n  return resultToUpdate;\n};\n\nUserUtils.removeFavToTwiit = function(id, idUser){\n  var resultToUpdate = false;\n  //RECUPERAMOS EL ARRAY QUE USAREMOS PARA ALMACENAR TODOS LOS ID DE LOS USUARIOS QUE DEN FAV AL TWIIT\n  var favObject = UserUtils.findFavsForTwiit(id);\n  var arrAux = favObject.idUserTapFav;\n  var idFav = favObject._id;\n\n  //HAY QUE AVERIGUAR LA POSICION DEL idUser DENTRO DEL ARRAY DE LA BBDD\n  var posIdUser = arrAux.indexOf(idUser);\n  //AHORA ELIMINAMOS EL ELEMENTO ASOCIADO A ESA POSICION\n  delete arrAux[posIdUser];\n\n  var num = UserUtils.findNumberFavPerTwiit(id);\n  num--;\n\n  //AHORA HACEMOS LAS OPERACIONES DE UPDATE\n  res = Favs.update(idFav, {$set: {idUserTapFav: arrAux}});\n  resT = Twitts.update(id, {$set: {numFav: num}});\n\n  //COMPROBAMOS EL RESULTADO DE LA OPERACION DE UPDATE\n  if(res && resT){\n    resultToUpdate = true;\n  }\n\n  return resultToUpdate;\n};\n\nUserUtils.findTwiitFromNotif = function(id){\n  var twiitId = Notifications.findOne(id).twiitId;\n  return twiitId;\n};\n\nUserUtils.findNumComment = function(idTweet){\n  return Twitts.findOne({_id : idTweet}).numComment;\n};\n\n//PARA MOSTRAR NOTIFICACIONES EN EL NAVEGADOR WEB\nUserUtils.createNotifToBrowser = function(typeNotif, userName){\n  if (Notification) {\n    if (Notification.permission !== \"granted\") {\n      Notification.requestPermission();\n    }\n    var title = \"TwiitClone\";\n    var bodyNotif = \"\";\n\n    if(typeNotif === \"fav\"){\n      bodyNotif = \"El usuario \" + userName + \" ha dado fav a un twiit tuyo\";\n    } else if(typeNotif === \"comment\"){\n      bodyNotif = \"El usuario \" + userName + \" ha comentado un twiit tuyo\";\n    } else if(typeNotif === \"twiit\"){\n      bodyNotif = \"El usuario \" + userName + \" ha publicado a un twiit nuevo\";\n    } else if(typeNotif === \"moreNotif\"){\n      bodyNotif = \"Tienes muchas Notificaciones\";\n    }\n\n    var extra = { body: bodyNotif };\n\n    var noti = new Notification(title, extra);\n\n    noti.onclick = function(){\n      // Al hacer click\n      window.location = \"/Notifications/\" + Meteor.user().username;\n    };\n\n    noti.onclose = {\n      // Al cerrar\n    };\n\n    setTimeout( function() { noti.close() }, 5000);\n  }\n};\n\nUserUtils.findUserFromTwiit = function(twiitId){\n  return Twitts.findOne({_id : twiitId}).user;\n};","Meteor.methods({ \n\n  'findChatsAvailable' : function(){\n    console.log(\"Buscando chats\");\n    var chatsAvailable = Chats.find({}, {$or: [ { userCreatedChat : Meteor.user().username}, { userToChat : Meteor.user().username } ] }).fetch();;\n    return chatsAvailable;\n  },\n\n  'findChatFromUser': function(username) {\n    var nameChat = username + \"_\" + Meteor.user().username;\n    var msgFound = ChatsMsg.find({\"nameChat\" : nameChat}).fetch();\n    if(msgFound.length === 0){\n      console.log(msgFound);\n      nameChat = Meteor.user().username + \"_\" + username;\n      msgFound = ChatsMsg.find({\"nameChat\" : nameChat}).fetch();\n    }\n    return msgFound;\n  },\n\n  'insertMsgChat': function(messageData) {\n    var userToSentMsg = Meteor.call('findUserFromDB',messageData.userRecepMsg);\n\n    if (Meteor.user()) {\n      ChatsMsg.insert({\n        userIdSentMsg : Meteor.user()._id,\n        userNameSentMsg : Meteor.user().username,\n        userRecepMsg : messageData.userRecepMsg,\n        userIdRecepMsg : userToSentMsg._id,\n        nameChat : messageData.userRecepMsg + \"_\" + Meteor.user().username,\n        contentMsg : messageData.contentMessage,\n        messageTimestamp : new Date()\n      });\n    }\n  },\n\n  'insertMsg': function(messageData) {\n    var userToSentMsg = Meteor.call('findUserFromDB',messageData.userRecepMsg);\n\n    if (Meteor.user()) {\n      ChatsMsg.insert({\n        userIdSentMsg : Meteor.user()._id,\n        userNameSentMsg : Meteor.user().username,\n        userRecepMsg : messageData.userRecepMsg,\n        userIdRecepMsg : userToSentMsg._id,\n        nameChat : messageData.nameChat,\n        contentMsg : messageData.contentMessage,\n        messageTimestamp : new Date()\n      });\n    }\n  },\n\n  'checkChat' : function(userNameToCheckChat){\n    var chatIsAvailable = Chats.findOne({\"nameChat\" : userNameToCheckChat + \"_\" + Meteor.user().username});\n    console.log(chatIsAvailable);\n    if(chatIsAvailable){\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  'createChat' : function(userNameToCreateChat){\n    Chats.insert({\n      userCreatedChat : Meteor.user().username,\n      userToChat : userNameToCreateChat,\n      nameChat : userNameToCreateChat + \"_\" + Meteor.user().username\n    });\n  },\n\n  'removeChat': function(nameUserRecepChat){\n    ChatsMsg.remove({\"nameChat\" : nameUserRecepChat + \"_\" + Meteor.user().username});\n    Chats.remove({\"nameChat\" : nameUserRecepChat + \"_\" + Meteor.user().username});\n  },\n\n  'findLastMessage' : function(nameChat){\n    var users = nameChat.split('_');\n    var chats = ChatsMsg.findOne({\"nameChat\" : nameChat}, {sort: {messageTimestamp: -1}});\n\n    if(!chats){\n      chats = ChatsMsg.findOne({\"userNameSentMsg\" : users[1], \"userRecepMsg\" : users[0]}, {sort: {messageTimestamp: -1}});\n    } \n\n    console.log(chats);\n\n    if(chats){\n      return chats;\n    }\n  },\n\n  'findContactsAvailable' : function(){\n    /*OBTENEMOS LOS USUARIOS A LOS QUE SIGUE EL CURRENTUSER*/\n    var currentFollowings = UserUtils.findFollowings(Meteor.user().username);\n    var currentFollowers = UserUtils.findFollowers(Meteor.user().username);\n    var currentContacts = [];\n\n    currentFollowings.forEach(function(elem, pos){\n      if(currentFollowers.indexOf(elem) >= 0){\n        currentContacts.push(elem);\n      }\n    });\n\n    return currentContacts;\n  }\n}); ","Meteor.methods({ \n  'findUser': function(username) {\n    return Meteor.users.findOne({\n      username: username\n    }, {\n      fields: { 'username': 1 }\n    });\n  },\n\n  'followUser': function(username) {\n    Relationships.insert({\n      follower: Meteor.user().username,\n      following: username\n    });\n  },\n\n  'unfollowUser': function(username){\n    Relationships.remove({\n      follower: Meteor.user().username,\n      following: username\n    });\n  },\n\n  'recommendUsers': function() {\n\tif (Meteor.user()) {\n\t  var currentFollowings = UserUtils.findFollowings(Meteor.user().username);\n\n    console.log(\"currentFollowings\");\n    console.log(currentFollowings);\n\n\t  var recUsers = Meteor.users.find({\n\t    username: {\n\t      $nin: currentFollowings\n\t    }\n\t  }, {\n\t    fields: { 'username': 1 },\n\t    limit: 5\n\t  }).fetch();\n\n\t  return recUsers;\n\t}\n   }\n});","Meteor.methods({ \n  'createTwiitNotification' : function(notif) {\n    var twiit = Twitts.findOne(notif._id);\n    var typeNotif = notif.typeOfNotif;\n\n    if(notif.recepNotif === notif.actorNotif){\n      isOwn = true;\n    } else {\n      isOwn = false;\n    }\n    \n    Notifications.insert({\n      twiitMessage: twiit.message,\n      twiitId: twiit._id,\n      recepNotif: notif.recepNotif,\n      actorNotif: notif.actorNotif,\n      twiitTimeStamp: twiit.timestamp,\n      typeOfNotif: typeNotif, \n      read: false,\n      isOwnTwiit: isOwn\n    });\n    \n  },\n\n  'createWhatsAppNotification' : function(notif){\n\n    Notifications.insert({\n      recepNotif: notif.recepNotif,\n      actorNotif: notif.actorNotif,\n      timeStamp: notif.timestamp,\n      typeOfNotif: notif.typeOfNotif, \n      read: false,\n      isOwnTwiit: false\n    });\n\n  },\n\n  'createResponseWhatsAppNotification' : function(notif){\n\n    Notifications.insert({\n      recepNotif: notif.recepNotif,\n      actorNotif: notif.actorNotif,\n      timeStamp: notif.timestamp,\n      typeOfNotif: notif.typeOfNotif,\n      stateResponse: notif.stateResponse,\n      idNotifRequestWhatsApp: notif.idNotifRequestWhatsApp,\n      read: false,\n      isOwnTwiit: false\n    });\n\n  }\n});","Meteor.publish('twitts', function() {\n  if (Meteor.userId) {\n    var username = Meteor.users.findOne({_id: this.userId}).username;\n    var currentFollowings = UserUtils.findFollowings(username);\n\n    return Twitts.find({user: { $in: currentFollowings }});\n  }\n});\n\nMeteor.publish('twittsProfile', function(username) {\n  if (Meteor.userId) {\n    return Twitts.find();\n  }\n});\n\nMeteor.publish('twittsWithComment', function(idTweet) {\n  if (Meteor.userId) {\n    return Twitts.find();\n  }\n});\n\nMeteor.publish('notifications', function() {\n  return Notifications.find();\n});\n\nMeteor.publish('allNotifications', function(notifId) {\n  return Notifications.find({_id : notifId}, {read: false});\n});\n\nMeteor.publish('whatsAppNotifications', function(notifName) {\n  return Notifications.find({recepNotif : notifName}, {read: false});\n});\n\nMeteor.publish('favs', function() {\n  return Favs.find();\n});\n\nMeteor.publish('dataUser', function() {\n  return DataUser.find();\n});\n\nMeteor.publish('images', function() {\n  return Images.find();\n});\n\nMeteor.publish('chatsMsg', function() {\n  if (Meteor.userId) {\n    return ChatsMsg.find({userIdRecepMsg : this.userId});\n  }\n});\n\nMeteor.publish('chats', function() {\n  if (Meteor.userId) {\n    return Chats.find();\n  }\n});\n\nMeteor.publish('files', function () {\n  return Files.find().cursor;\n});\n\nif (Meteor.isServer) {\n  Files.denyClient();\n\n  Meteor.startup(() => {\n    if (!Files.findOne()) {\n      Files.load('https://raw.githubusercontent.com/VeliovGroup/Meteor-Files/master/logo.png', {\n        fileName: 'logo.png'\n      });\n    }\n  });\n}\n\n/*\nMeteor.publishComposite('twitts', function(username) {\n  return {\n    find: function() {\n      // Comprobar los usuarios a los que se estÃ¡ siguiendo\n      return Relationships.find({ follower: username });\n    },\n    children: [{\n      find: function(relationship) {\n        // Encontrar mensajes de los usuarios que se siguen\n        return Twitts.find({user: relationship.following});\n      }\n    }]\n  }\n});\n*/\n","Meteor.methods({ \n  'insertTweet': function(tweet) {\n    var insertComment = false;\n\n    twiit = new Object();\n    twiit.message = tweet.message;\n    twiit.user = Meteor.user().username;\n    twiit.timestamp = new Date();\n    twiit.numFav = 0;\n    twiit.numComment = 0;\n\n    //SE EJECUTA CUANDO SE QUIERE INSERTAR UN TWIIT DESDE UN COMENTARIO\n    if(tweet.type){\n      twiit.commentType = true;\n      twiit.twiitIdComment = tweet.twiitId;\n    } \n\n    fav = new Object();\n    fav.idTwiit = \"\";\n    fav.idUserTapFav = [];\n\n    if(tweet.type){\n      if (Meteor.user()) {\n        twiit._id = Twitts.insert({\n          message : twiit.message,\n          user : twiit.user,\n          timestamp : twiit.timestamp,\n          numFav : twiit.numFav,\n          numComment : twiit.numComment,\n          commentType : twiit.commentType,\n          twiitIdComment : twiit.twiitIdComment\n        });\n      }\n    } else {\n      if (Meteor.user()) {\n        twiit._id = Twitts.insert({\n          message : twiit.message,\n          user : twiit.user,\n          timestamp : twiit.timestamp,\n          numFav : twiit.numFav,\n          numComment : twiit.numComment\n        });\n      }\n    }\n\n    fav._id = Favs.insert({\n      idTwiit : twiit._id,\n      idUserTapFav : fav.idUserTapFav\n    });\n\n    var notif = new Object();\n    notif._id = twiit._id;\n    notif.typeOfNotif = tweet.typeOfNotif;\n    notif.actorNotif = tweet.actorUser;\n    notif.recepNotif = tweet.recepUser;\n    \n    //console.log(notif);\n\n  \tMeteor.call('createTwiitNotification', notif);\n\n    if(tweet.type){\n      Twitts.update({_id: twiit.twiitIdComment}, {$set: {numComment : tweet.numComment}});\n    }\n  }\n});","Meteor.methods({ \n  'findUserFromDB': function(username) {\n    //Meteor._sleepForMs(1000);\n    return Meteor.users.findOne({\"username\" : username});\n  },\n\n  'insertDataUser': function(userData) {\n\n    //BUSCAMOS AL USUARIO QUE SE HA CREADO ANTES PARA RECUPERAR SU _ID\n    Meteor.call('findUserFromDB', userData.userNameProfile, function(err, res){\n      userData.userId = res._id;\n    });\n\n    if (Meteor.user()) {\n      DataUser.insert({\n        userId : userData.userId,\n        userNameProfile : userData.userNameProfile,\n        userName : userData.userName,\n        userImg : userData.userImg,\n        userDescription : userData.userDescription,\n        showWhatsTo: []\n      });\n    }\n  },\n\n  'findUserData': function(userName){\n    return DataUser.findOne({userNameProfile : userName});\n  },\n\n  'findUserDataWithId': function(userId){\n    return DataUser.findOne({userId : userId});\n  },\n\n  'findUserImg': function(userImg){\n    return Images.findOne({_id : userImg}).imgCode;\n  },\n\n  'updUserData': function(newData){\n    DataUser.update({_id: newData.userId}, {$set: {userDescription : newData.description, userImg : newData.imgId}});\n  },\n\n  'updUserDataSocialNetworks': function(newData){\n    if((newData.userFb != null) && (newData.userInsta != null) && (newData.userWhats != null)){\n      DataUser.update({_id: newData.userId}, {$set: {userFb : newData.userFb, userWhats : newData.userWhats, userInsta : newData.userInsta}});\n    } else {\n      if(newData.userFb != null){\n        DataUser.update({_id: newData.userId}, {$set: {userFb : newData.userFb}});\n      }\n\n      if(newData.userInsta != null){\n        DataUser.update({_id: newData.userId}, {$set: {userInsta : newData.userInsta}});\n      }\n\n      if(newData.userWhats != null){\n        DataUser.update({_id: newData.userId}, {$set: {userWhats : newData.userWhats}});\n      }\n    }\n  },\n\n  'removeDataSocialNetworks': function(newData){\n    console.log(newData.userId + \" \" + newData.propertyToRem);\n\n    switch(newData.propertyToRem){\n        case \"WhatsApp\": {\n          DataUser.update({_id: newData.userId},  {$unset: { \"userWhats\" : 1 }});\n        };\n          break;\n        case \"Instagram\": {\n          DataUser.update({_id: newData.userId},  {$unset: { \"userInsta\" : 1 }});\n        };\n          break;\n        case \"Facebook\": {\n          DataUser.update({_id: newData.userId},  {$unset: { \"userFb\" : 1 }});\n        };\n          break;\n      }\n    \n    //ESTE COMANDO ES EL QUE SE UTILIZA EN MONGO\n    //db.dataUser.update({\"_id\": \"rQTzzDMfr4ZkiR7S8\"},  {\"$unset\":{\"userWhats\":1}});\n  },\n\n  'insertNewImage': function(code){\n    return Images.insert({\n      imgCode : code\n    });\n  },\n\n  'removeThisUser': function(userToRemove){\n    //HAY QUE ELIMINAR EL USUARIO DE dataUser Y DE users\n    var idImgUser = DataUser.findOne({userId: userToRemove.id}).userImg;\n\n    if(idImgUser){\n      Images.remove({_id: idImgUser});\n    }\n   \n    Notifications.remove({recepNotif: userToRemove.name});\n    Relationships.remove({follower: userToRemove.name});\n    Relationships.remove({following: userToRemove.name});\n\n    Favs.find({idUserTapFav: userToRemove.id}).fetch().map(function(data) {\n      if(data.idUserTapFav){\n        var aux = data.idUserTapFav;\n        var pos = aux.indexOf(userToRemove.id);\n        if(pos != -1){\n          UserUtils.removeFavToTwiit(data.idTwiit, userToRemove.id);\n        }\n      }\n    });\n\n    Twitts.remove({user: userToRemove.name});\n    Meteor.users.remove({_id: userToRemove.id});\n    DataUser.remove({userId: userToRemove.id});\n  }, \n\n  'updateArrayWhatsAppAuthorize': function(data){\n    var user = DataUser.findOne({userNameProfile: data.user});\n    var arrShowWhats = user.showWhatsTo;\n    console.log(\"Array: \");\n    console.log(arrShowWhats);\n\n    //BUSCAMOS EL USUARIO QUE VAMOS A AÃ‘ADIR AL ARRAY\n    var userToAdd = DataUser.findOne({userNameProfile: data.userToShow});\n    arrShowWhats.push(userToAdd.userId);\n\n    console.log(arrShowWhats);\n    console.log(user);\n\n    DataUser.update({userId: user.userId}, {$set: {showWhatsTo : arrShowWhats}});\n    \n  },\n\n  'updateShowWhatsTo' : function(data){\n    DataUser.update({userId: data.userId}, {$set: {showWhatsTo : data.showWhats}});\n  },\n\n});","Meteor.methods({\n  'removeThisFile': function(idFileToRem) {\n    console.log(idFileToRem);\n    if(Meteor.isServer){\n      //var fileFound = Files.find({_id: idFileToRem}).fetch();\n      Files.remove({_id : idFileToRem});\n    }\n  },\n\n  'searchFiles' : function(){\n    if(Meteor.isServer){\n      console.log('Searching files..');\n      var filesFound = Files.find().fetch();\n      console.log(filesFound);\n      return filesFound;\n    }\n  },\n\n  'searchOneFile' : function(){\n    if(Meteor.isServer){\n      console.log('Search one file..');\n      var fileFound = Files.findOne().fetch();\n      return fileFound;\n    }\n  },\n\n  'searchThisFile' : function(idFile){\n    if(Meteor.isServer){\n      console.log('Search file ' + idFile);\n      var fileFound = Files.findOne({_id : idFile}).fetch();\n      return fileFound;\n    }\n  }\n});\n","Meteor.methods({ \n  /*\n  'tweetsPublish': function(username) {\n    console.log(\"Usuario a buscar: \" + username);\n    console.log(\"Resultado: \");\n    var resul =  UserUtils.findTweets(username);\n    return resul.length;\n  },\n  */\n  'usersFollowers': function(username) {\n    var currentFollowers = UserUtils.findFollowers(username);\n    return currentFollowers.length;\n  },\n\n  'usersFollowings': function(username) {\n\t  var currentFollowings = UserUtils.findFollowings(username);\n    \n    return currentFollowings.length;\n  },\n\n  'getFollowers': function(username) {\n    var currentFollowers = UserUtils.findFollowers(username);\n\n    return currentFollowers;\n  },\n\n  'getFollowings': function(username) {\n    var currentFollowings = UserUtils.findFollowings(username);\n\n    return currentFollowings;\n  }\n\n});","import { Meteor } from 'meteor/meteor';\n\nMeteor.startup(() => {\n  // code to run on server at startup\n  Relationships._ensureIndex({follower: 1, following: 1}, {unique: 1});\n\n  Twitts.allow({\n  \tinsert: function(userId, disconnect) {\n  \t   \treturn true;\n  \t},\n  \tupdate: function(id, doc){\n  \t\treturn true;\n  \t},\n\n  });\n\n  Favs.allow({\n  \tinsert: function(userId, disconnect) {\n\t   \treturn true;\n\t},\n  \tupdate: function(userId, doc) {\n\t    return true;\n  \t}\n  });\n\n  Notifications.allow({\n  \tupdate: function(userId, doc) {\n\t    return true;\n  \t}\n  });\n\n  DataUser.allow({\n    insert: function(userId, disconnect){\n      return true;\n    },\n    update: function(userId, doc) {\n      return true;\n    }\n\n  });\n\n  Images.allow({\n    insert: function(userId, disconnect){\n      return true;\n    }\n  });\n\n  Chats.allow({\n    insert: function(userId, disconnect){\n      return true;\n    },\n    update: function(userId, doc) {\n      return true;\n    }\n\n  });\n\n  Files.allow({\n    insert: function(){\n      return true;\n    },\n    update: function() {\n      return true;\n    },\n    remove: function(){\n      console.log(\"Deleting\");\n      return true;\n    }\n  });\n\n});\n"]}